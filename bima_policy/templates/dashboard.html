{%extends 'base.html'%}
{%load static%}
{%block content%}


<main class="app-main">
   <style>

   </style>


   <div class="wrapper">

      <!-- Dashboard -->

      <div class="page" id="dashboard">
         <!-- .page-inner -->
         <div class="page-inner text-blue116">
            <!-- .page-title-bar -->
            <header class="page-title-bar">
               <!-- page title stuff goes here -->
               <div class="row">
                  <div class="col-md-5 col-sm-12">
                     <h1 class="page-title "> Dashboard </h1>
                  </div>
               </div>
            </header>
            <!-- .page-section -->
            <div class="page-section">
               <div class="section-block">
                  <!-- metric row -->
                  <div class="metric-row">
                     <div class="col-lg-12">
                        <div class="metric-row metric-flush">
                           <!-- metric column -->
                           <div class="col">
                              <!-- .metric -->
                              <a href="{%url 'bima_policy:staff' %}" class="metric metric-bordered align-items-center">
                                 <h2 class="metric-label text-blue116">Staff </h2>
                                 <p class="metric-value h3">
                                    <sub><span class="icofont icofont-users-alt-5"></span></sub>
                                    <span id="staffcount" class="value">
                                       {{staffcount}} </span>
                                 </p>
                              </a> <!-- /.metric -->
                           </div><!-- /metric column -->
                           <div class="col">
                              <a href="{%url 'bima_policy:agent' %}" class="metric metric-bordered align-items-center">
                                 <h2 class="metric-label text-blue116">Agent </h2>
                                 <p class="metric-value h3">
                                    <sub><span class="icofont icofont-users-alt-1"></span></sub>
                                    <span id="agentcount" class="value">{{agentcount}}</span>
                                 </p>
                              </a> <!-- /.metric -->
                           </div><!-- /metric column -->
                           <div class="col">
                              <!-- .metric -->
                              <a href="{%url 'bima_policy:service_p' %}"
                                 class="metric metric-bordered align-items-center">
                                 <h2 class="metric-label text-blue116">Service Providers </h2>
                                 <p class="metric-value h3">
                                    <sub><span class="icofont icofont-business-man"></span></sub>
                                    <span id="spcount" class="value">{{spcount}}</span>
                                 </p>
                              </a> <!-- /.metric -->
                           </div><!-- /metric column -->
                           <div class="col">
                              <!-- .metric -->
                              <a href="{%url 'bima_policy:policy_entry' %}"
                                 class="metric metric-bordered align-items-center">
                                 <h2 class="metric-label text-blue116">Total Policies </h2>
                                 <p class="metric-value h3">
                                    <sub><span class="icofont icofont icofont-ebook"></span></sub>
                                    <span id="policycount" class="value">
                                       {{totalpolicy}} </span>
                                 </p>
                              </a> <!-- /.metric -->
                           </div><!-- /metric column -->
                        </div>
                     </div><!-- metric column -->
                  </div><!-- /metric row -->
               </div>
               <!-- .section-block -->
               <div class="section-block">
                  <div class="row">
                     <div class="col-xl-9">
                        <div class="row">
                           <div class="col-xl-6">
                              (01-Jan-2023 to 01-Jan-2024)
                           </div>
                           <div class="col-xl-6">
                              <div class="text-right mb-2">
                                 <div class="dropdown">
                                    <form method="post">
                                       <button class="btn btn-secondary" data-toggle="dropdown" aria-haspopup="true"
                                          aria-expanded="false"><span>This
                                             Year</span> <i class="fa fa-fw fa-caret-down"></i></button>
                                       <!-- .dropdown-menu -->
                                       <button class="btn btn-info">Go</button>
                                       <!-- .dropdown-menu -->
                                       <div class="dropdown-menu dropdown-menu-right dropdown-menu-md stop-propagation">
                                          <div class="dropdown-arrow"></div>
                                          <!-- .custom-control -->
                                          <div class="custom-control custom-radio">
                                             <input type="radio" class="custom-control-input" id="dpYear"
                                                name="dpFilter" value="This Year" checked=""> <label
                                                class="custom-control-label d-flex justify-content-between"
                                                for="dpYear"><span>This Year</span> <span
                                                   class="text-muted">2023</span></label>
                                          </div><!-- /.custom-control -->
                                          <!-- .custom-control -->
                                          <div class="custom-control custom-radio">
                                             <input type="radio" class="custom-control-input" id="dpCustom"
                                                name="dpFilter" value="Custom">
                                             <label class="custom-control-label" for="dpCustom">Custom</label>
                                             <div class="custom-control-hint my-1">
                                                <!-- datepicker:range -->
                                                <input type="text" name="custom_date" value=""
                                                   class="form-control flatpickr-input" data-toggle="flatpickr"
                                                   data-mode="range" data-date-format="d-m-Y" readonly="readonly">
                                                <!-- /datepicker:range -->
                                             </div>
                                          </div><!-- /.custom-control -->
                                       </div><!-- /.dropdown-menu -->
                                    </form>
                                 </div><!-- /.dropdown -->
                              </div>
                           </div>
                        </div>

                        <div class="row">

                           <div class="card card-body">
                              <div class="card-header p-0 mb-3 pb-2 text-white-ff">Policies</div>
                              <!-- legend -->
                              <ul class="list-inline small ">
                                 <li class="list-inline-item">
                                    <i class="fa fa-fw fa-circle text-green"></i> OK Policies
                                 </li>
                                 <li class="list-inline-item">
                                    <i class="fa fa-fw fa-circle text-red"></i> Cancelled Policies
                                 </li>
                              </ul><!-- /legend -->

                              <div>
                                 <canvas id="totalPolicy"></canvas>
                              </div>
                           </div><!-- /.card -->
                        </div>
                        <div class="row">
                           <div class="card card-body">
                              <div class="card-header p-0 mb-3 pb-2">Commission</div>
                              <div class="chartjs" style="height: 300px">
                                 <div class="chartjs-size-monitor">
                                    <div class="chartjs-size-monitor-expand">
                                       <div class=""></div>
                                    </div>
                                    <div class="chartjs-size-monitor-shrink">
                                       <div class=""></div>
                                    </div>
                                 </div>
                                 <canvas id="canvas-total-earning" width="771" height="300"
                                    style="display: block; width: 771px; height: 300px;"
                                    class="chartjs-render-monitor"></canvas>
                              </div>
                           </div><!-- /.card -->
                        </div>
                     </div>
                     <div class="col-xl-3">
                        <div class="row">
                           <div class="col-xl-12">
                              <div class="card card-fluid">
                                 <!-- .card-header -->
                                 <div class="card-header"> Subscription</div><!-- /.card-header -->
                                 <!-- .card-body -->
                                 <div class="card-body ">
                                    <h2 class="metric-label">Expire On</h2>
                                    <p class="metric-value h3">
                                       <sub><i class="icofont icofont-ui-calendar" style="color: #346CB0"></i></sub>
                                       <span class="value" style="color: #346CB0;">Never</span>
                                    </p>
                                    <p class="pt-3">
                                       <small class="text-muted " style="color: rgb(110, 17, 244);">
                                          (Life-time Activation)</small>
                                    </p>
                                 </div><!-- /.card-body -->
                              </div><!-- /.card -->
                           </div>
                           <div class="col-xl-12">
                              <div class="card">
                                 <div class="card-header"> Storage Overview</div>
                                 <div class="card-body">
                                    <div class="card bg-light">
                                       <div class="card-body">
                                          <span><i class="fa fa-hdd " aria-hidden="true"></i>
                                             Storage Usage</span>
                                          <div title="0%" class="progress progress-lg mb-1">
                                             <div class="progress-bar bg-primary" role="progressbar" style="width: 0%;"
                                                aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"> 0% </div>
                                          </div>
                                          <p class="">3 GB free of 3 GB
                                          </p>
                                       </div>
                                    </div>
                                    <dl class="d-flex justify-content-between mb-0">
                                       <dt class="text-left">
                                          <div class="tile">
                                             <i class="icofont-file-alt text-blue116"></i>
                                          </div>
                                          <span class="mr-2">New Policy</span>
                                       </dt>
                                       <dd class="text-right">
                                          0 MB </dd>
                                    </dl>
                                    <hr>
                                    <dl class="d-flex justify-content-between">
                                       <dt class="text-left">
                                          <div class="tile">
                                             <i class="icofont-file-alt text-blue116"></i>
                                          </div>
                                          <span class="mr-2">Previous Policy</span>
                                       </dt>
                                       <dd class="text-right">
                                          0 MB </dd>
                                    </dl>
                                    <hr>
                                    <dl class="d-flex justify-content-between">
                                       <dt class="text-left">
                                          <div class="tile">
                                             <i class="icofont-file-alt text-blue116"></i>
                                          </div>
                                          <span class="mr-2">RC<small> (Registration
                                                Certificate)</small></span>
                                       </dt>
                                       <dd class="text-right">
                                          0 MB </dd>
                                    </dl>
                                    <hr>
                                    <dl class="d-flex justify-content-between">
                                       <dt class="text-left">
                                          <div class="tile">
                                             <i class="icofont-file-alt text-blue116"></i>
                                          </div>
                                          <span class="mr-2">Agent Documents</span>
                                       </dt>
                                       <dd class="text-right">
                                          0 MB </dd>
                                    </dl>
                                    <hr>
                                    <dl class="d-flex justify-content-between">
                                       <dt class="text-left">
                                          <div class="tile">
                                             <i class="icofont-file-alt text-blue116"></i>
                                          </div>
                                          <span class="mr-2">Payment Screenshots</span>
                                       </dt>
                                       <dd class="text-right">
                                          0 MB </dd>
                                    </dl>
                                 </div>

                              </div>
                           </div>
                        </div>
                     </div>
                  </div>
               </div><!-- /.section-block -->
            </div><!-- /.page-section -->
         </div><!-- /.page-inner -->
      </div>

      <!-- Policy entry list -->

      <div class="page" id="entrylist" hidden>

         <div class="page-inner text-blue116">

            <header class="page-title-bar">
               <!-- page title stuff goes here -->
               <div class="row">
                  <div class="col">
                     <h1 id="page_heading" class="page-title" style="display: inline-block;"> Policy List </h1>
                     <a onclick="addNewSomething()" href="#" class="btn btn-secondary btn-sm float-right mr-2"><i
                           class="fa fa-plus"></i> Add
                        New</a>
                  </div>
               </div>
            </header>

            <!-- .card -->
            <div class="card card-fluid">
               <!-- .card-header -->
               <div class="card-header">
                  <form id="frminslist" autocomplete="off">
                     <div class="row">
                        <div class="col-md-2 col-sm-12">
                           <select class="custom-select" name="period" id="select-period">
                              <option value="today">Today</option>
                              <option value="yesterday">Yesterday</option>
                              <option value="this_month">This Month</option>
                              <option value="last_month">Last Month</option>
                              <option value="current_year">Current Year</option>
                              <option value="custom">Custom</option>
                           </select>
                        </div>

                        <div class="col-md-2 col-sm-12">
                           <div class="form-group">
                              <input type="text" id="frmDate" data-alt-format="Y-m-d" data-date-format="d/m/Y"
                                 data-toggle="flatpickr" placeholder="DD-MM-YYYY" class="form-control flatpickr-input"
                                 disabled="" readonly="readonly">
                           </div>
                        </div>
                        <div class="col-md-2 col-sm-12">
                           <div class="form-group">
                              <input type="text" id="toDate" data-alt-format="Y-m-d" data-date-format="d/m/Y"
                                 data-toggle="flatpickr" placeholder="DD-MM-YYYY"
                                 class="form-control datepicker flatpickr-input" disabled="" readonly="readonly">
                           </div>
                        </div>

                        <div class="col-md-3 col-sm-12" hidden>
                           <select name="agents" data-parsley-required-message=""
                              class="custom-select select2 select2-hidden-accessible" id="agents"
                              data-parsley-required="true" tabindex="-1" aria-hidden="true">
                              <option value=""> All Agents</option>
                              <!-- {%for value in datag%}
                              <option value={{value.full_name}}>{{value.full_name}}</option>
                              {%endfor%} -->
                           </select>
                        </div>

                        <div class="col-md-6 ">
                           <div class="form-group">
                              <button onclick="entry_filter()" type="button" id="filterlist" class="btn btn-secondary "
                                 title="Filter"><i class="fa fa-search" aria-hidden="true"></i> </button>

                              <button type="button" id="btnreset" class="btn btn-secondary" title="Refresh"
                                 onclick="resertDocument()"><i class="icofont icofont-refresh" aria-hidden="true"></i>
                              </button>

                              <button onclick="addToFilterList()" type="button" id="btnlock" class="btn btn-secondary "
                                 title="Freeze"><i class="fa fa-snowflake" aria-hidden="true"></i> </button>

                              <button type="button" onclick="ExportToExcel('xlsx')" id="download_inslist"
                                 class="btn btn-secondary " title="Download"><i class="fa fa-download"
                                    aria-hidden="true"></i> </button>

                              <!-- data-toggle="modal" data-target=""  -->
                              <button type="button" id="bulk_remove" onclick="clearFilterList()"
                                 class="btn btn-secondary" title="Clear filters"><i class="icofont icofont-trash"
                                    aria-hidden="true"></i> </button>

                              <a id="linkShowFilterDiv" href="#" class="no-wrap pl-0 morefilter" title="More Filter"
                                 onclick="showMoreFilters()"><small>More
                                    Filter</small></a>


                              <div class="modal fade" id="mdlcolsetting"
                                 onmouseenter="document.getElementById('inp_search').focus()" style="height: 400px">

                                 <div class="modal-dialog" role="document">

                                    <div class="modal-content">
                                       <div class="modal-header">
                                          <h5 id="rtoModalLabel" class="modal-title"> Delete Policy</h5>
                                       </div>
                                       <div class="modal-body ">
                                          <div class="form-row">
                                             <div class="col-md-12 mb-4">
                                                <div class=""><label>Are You Sure? You want to delete the
                                                      Record(s)..<input hidden id="inp_search" type="text" value=""
                                                         class="form-control" name="agent"
                                                         style="text-transform: uppercase;"
                                                         title="Search POS using Name, mobile no, email, pan/aadhar number">
                                                   </label></div>
                                             </div>

                                          </div>

                                          <div class="modal-footer">
                                             <button id="btnExit" type="button" class="btn btn-secondary w-100p"
                                                data-dismiss="modal">Cancel</button>

                                             <button type="button" id="posUpdate" onclick="bulk_policy_remove()"
                                                class="btn btn-primary w-100p " style="background: red;">Delete</button>

                                          </div>
                                       </div>

                                    </div>

                                 </div>
                                 <!-- <body onload="setFocus()">
                                             
                                          </body> -->

                              </div>
                           </div>
                        </div>
                        <div class="col-md-2 ">

                           <!-- <input id="payout_switch" type="checkbox" value="No Payouts">
                           <label for="">No Payouts</label> -->

                        </div>
                        {% if is_user %}
                        <div class="col-md-1" style="text-align: right;" hidden>
                           <style>
                              .switch {
                                 position: relative;
                                 display: inline-block;
                                 width: 60px;
                                 height: 34px;
                              }

                              .switch input {
                                 opacity: 0;
                                 width: 0;
                                 height: 0;
                              }

                              .slider {
                                 position: absolute;
                                 cursor: pointer;
                                 top: 0;
                                 left: 0;
                                 right: 0;
                                 bottom: 0;
                                 background-color: #ccc;
                                 -webkit-transition: .4s;
                                 transition: .4s;
                              }

                              .slider:before {
                                 position: absolute;
                                 content: "";
                                 height: 26px;
                                 width: 26px;
                                 left: 4px;
                                 bottom: 4px;
                                 background-color: white;
                                 -webkit-transition: .4s;
                                 transition: .4s;
                              }

                              input:checked+.slider {
                                 background-color: #2196F3;
                              }

                              input:focus+.slider {
                                 box-shadow: 0 0 1px #2196F3;
                              }

                              input:checked+.slider:before {
                                 -webkit-transform: translateX(26px);
                                 -ms-transform: translateX(26px);
                                 transform: translateX(26px);
                              }

                              /* Rounded sliders */
                              .slider.round {
                                 border-radius: 34px;
                              }

                              .slider.round:before {
                                 border-radius: 50%;
                              }
                           </style>

                           <label class="switch">
                              <input id="payout_switch" type="checkbox">
                              <span class="slider round"></span>
                           </label>
                        </div>
                        {% endif %}
                     </div>
                     <div id="morefilters" class="row" hidden>
                        <div class="form-row">
                           <input id="ps1" name="ps1" type="checkbox" value="No Payouts" class="checkbox mr-2"
                              style="margin-bottom: auto; margin-top: 4px;">
                           <label for="ps1">Payout-less Policies</label>
                        </div>

                        <div class="col-md-4 mb-4">

                           <input type="text" id="search-select_vc" class="form-control" placeholder="Select any field">
                           <select id="filter_type" name="filter_type" data-parsley-required-message="" multiple
                              data-parsley-required="true" class="custom-select " required onchange="add_filter_type()">
                              <option value="pos">POSPS</option>
                              <option value="insurance_company">Insurers</option>
                              <option value="vehicle_catagory">Vehicle Catagory</option>
                              <option value="vehicle_makeby">Vehicle Makeby</option>
                              <option value="vehicle_model">Vehicle Model</option>
                              <option value="vehicle_fuel_type">Fuel Type</option>
                              <option value="cubic_capacity">Cubic Capacity</option>
                              <option value="seating_capacity">Seating Capacity</option>
                              <option value="coverage_type">Coverage Type</option>
                              <option value="gvw">GVW</option>
                              <option value="policy_type">Policy Type</option>
                              <option value="addon">Addon</option>
                              <option value="ncb">NCB</option>
                              <option value="cpa">CPA</option>

                           </select>
                           <!-- <input type="text" id="search-select_vc" class="form-control"> -->

                           <button id="select-all_vc" hidden>Select All</button>
                           <button id="deselect-all_vc" hidden>Deselect All</button>

                           <script>
                              const select_vc = document.getElementById("vehicle_catagory");
                              const selectAllButton_vc = document.getElementById("select-all_vc");
                              const deselectAllButton_vc = document.getElementById("deselect-all_vc");
                              const searchInput_vc = document.getElementById("search-select_vc");

                              selectAllButton_vc.addEventListener("click", () => {
                                 Array.from(select.options).forEach(option => option.selected = true);
                              });

                              deselectAllButton_vc.addEventListener("click", () => {
                                 Array.from(select.options).forEach(option => option.selected = false);
                              });

                              searchInput_vc.addEventListener("input", () => {
                                 const searchValue = searchInput_vc.value.toLowerCase();
                                 Array.from(select_vc.options).forEach(option => {
                                    const optionText = option.textContent.toLowerCase();
                                    option.style.display = optionText.includes(searchValue) ? "" : "none";
                                 });
                              });

                           </script>

                           <script>

                              function add_filter_type() {

                                 filter_type_value = document.getElementById('filter_type').value
                                 filter_content = document.getElementById('filter_content')

                                 fuel_col = ['PETROL', 'DIESEL', 'CNG', 'ELECTRIC']
                                 cc_col = ['75CC-150CC', '150CC-350CC', 'ABOVE 350CC', 'BELOW 1000CC', '1000CC-1500CC', 'ABOVE 1500CC']
                                 ct_col = ['1 YEAR PACKAGE', '1+2 YEAR PACKAGE', '1+4 YEAR PACKAGE', '3 YEAR TP', '5 YEAR TP', 'TP ONLY', 'OD ONLY']
                                 sc_col = ['BELOW 5', '5-7', '7-12', '12-18', 'ABOVE 18']
                                 gvw_col = ['BELOW 2000', '2000-2500', '2500-3500', '3500-7000', '7000-7500', '7500-12000', '12000-25000', '25000-40000', 'ABOVE 40000']
                                 policy_type_col = ['FRESH', 'RENEWAL', 'ROLLOVER', 'ENDORSEMENT']
                                 addon_col = ['YES', 'NO']
                                 ncb_col = ['YES', 'NO']
                                 cpa_col = ['YES', 'NO']

                                 if (filter_type_value == 'pos') {

                                    filter_content.innerHTML = ''

                                    add_select_all_option()

                                    element = document.getElementById('filter_content')

                                    var filter_data = JSON.parse(localStorage.getItem('filter_data'));
                                    if (filter_data != null) {
                                       agents = filter_data.agents
                                       agents.forEach(item => {
                                          var newoption = document.createElement("option");
                                          newoption.value = item
                                          newoption.innerHTML = item
                                          element.options.add(newoption);
                                       })
                                    }
                                 }

                                 else if (filter_type_value == 'insurance_company') {

                                    filter_content.innerHTML = ''

                                    add_select_all_option()

                                    element = document.getElementById('filter_content')

                                    var filter_data = JSON.parse(localStorage.getItem('filter_data'));
                                    if (filter_data != null) {
                                       insurers = filter_data.insurers
                                       insurers.forEach(item => {
                                          var newoption = document.createElement("option");
                                          newoption.value = item
                                          newoption.innerHTML = item
                                          element.options.add(newoption);
                                       })
                                    }

                                 }

                                 else if (filter_type_value == 'vehicle_catagory') {

                                    filter_content.innerHTML = ''

                                    add_select_all_option()

                                    element = document.getElementById('filter_content')

                                    var filter_data = JSON.parse(localStorage.getItem('filter_data'));
                                    if (filter_data != null) {
                                       vcats = filter_data.vcats
                                       vcats.forEach(item => {
                                          var newoption = document.createElement("option");
                                          newoption.value = item
                                          newoption.innerHTML = item
                                          element.options.add(newoption);
                                       })
                                    }

                                 }

                                 else if (filter_type_value == 'vehicle_makeby') {

                                    filter_content.innerHTML = ''

                                    add_select_all_option()

                                    element = document.getElementById('filter_content')

                                    var filter_data = JSON.parse(localStorage.getItem('filter_data'));
                                    if (filter_data != null) {
                                       vmakes = filter_data.vmakes
                                       vmakes.forEach(item => {
                                          var newoption = document.createElement("option");
                                          newoption.value = item.make
                                          newoption.innerHTML = item.make
                                          element.options.add(newoption);
                                       })
                                    }
                                 }

                                 else if (filter_type_value == 'vehicle_model') {

                                    filter_content.innerHTML = ''

                                    add_select_all_option()

                                    element = document.getElementById('filter_content')

                                    var filter_data = JSON.parse(localStorage.getItem('filter_data'));
                                    if (filter_data != null) {
                                       vmodels = filter_data.vmodels
                                       vmodels.forEach(item => {
                                          var newoption = document.createElement("option");
                                          newoption.value = item.model
                                          newoption.innerHTML = item.model
                                          element.options.add(newoption);
                                       })
                                    }
                                 }

                                 else if (filter_type_value == 'vehicle_fuel_type') {
                                    add_items(fuel_col, filter_content)
                                 }
                                 else if (filter_type_value == 'cubic_capacity') {
                                    add_items(cc_col, filter_content)
                                 }
                                 else if (filter_type_value == 'coverage_type') {
                                    add_items(ct_col, filter_content)
                                 }
                                 else if (filter_type_value == 'seating_capacity') {
                                    add_items(sc_col, filter_content)
                                 }
                                 else if (filter_type_value == 'gvw') {
                                    add_items(gvw_col, filter_content)
                                 }
                                 else if (filter_type_value == 'policy_type') {
                                    add_items(policy_type_col, filter_content)
                                 }
                                 else if (filter_type_value == 'addon') {
                                    add_items(addon_col, filter_content)
                                 }
                                 else if (filter_type_value == 'ncb') {
                                    add_items(ncb_col, filter_content)
                                 }
                                 else if (filter_type_value == 'cpa') {
                                    add_items(cpa_col, filter_content)
                                 }
                              }

                           </script>

                        </div>


                        <div id="divFilterContent" class="col-md-5">
                           <!-- <label for="my-select">Vehicle Make:</label> -->
                           <input type="text" id="search-select" class="form-control" placeholder="Search..">
                           <select id="filter_content" name="filter_content" class="form-control" multiple
                              onclick="filterFetchList()">
                              <option id="op_select_all" value="" onclick="select_all_Items('filter_content')">
                              </option>

                           </select>
                           <!-- <input type="text" id="search-select" class="form-control"> -->

                           <button id="select-all" hidden>Select All</button>
                           <button id="deselect-all" hidden>Deselect All</button>

                           <script>
                              const select = document.getElementById("filter_content");
                              const selectAllButton = document.getElementById("select-all");
                              const deselectAllButton = document.getElementById("deselect-all");
                              const searchInput = document.getElementById("search-select");

                              selectAllButton.addEventListener("click", () => {
                                 Array.from(select.options).forEach(option => option.selected = true);
                              });

                              deselectAllButton.addEventListener("click", () => {
                                 Array.from(select.options).forEach(option => option.selected = false);
                              });

                              searchInput.addEventListener("input", () => {
                                 const searchValue = searchInput.value.toLowerCase();
                                 Array.from(select.options).forEach(option => {
                                    const optionText = option.textContent.toLowerCase();
                                    option.style.display = optionText.includes(searchValue) ? "" : "none";
                                 });
                              });

                           </script>
                           <script>

                              function add_select_all_option() {

                                 filter_content = document.getElementById('filter_content')
                                 filter_content.innerHTML = ''

                                 var newoption = document.createElement("option");
                                 newoption.value = ''
                                 newoption.innerHTML = '--select all--'

                                 // newoption.onclick = function() { alert('Hello'); };
                                 newoption.onclick = function () {
                                    for (i = 1; i <= filter_content.options.length - 1; i++) {
                                       filter_content.options[i].selected = true
                                    }
                                    filter_content.options[filter_content.options.length - filter_content.options.length].selected = false

                                 };

                                 filter_content.options.add(newoption);
                              }

                              function add_items(data, element) {

                                 add_select_all_option()

                                 data.forEach(item => {
                                    var newoption = document.createElement("option");
                                    newoption.value = item
                                    newoption.innerHTML = item
                                    element.options.add(newoption);
                                 });

                                 // select_all_Items(element.id)
                              }

                              function select_all_Items(name) {

                                 var item = document.getElementById(name)

                                 try {
                                    if (item.value == '') {
                                       for (i = 1; i <= item.length - 1; i++) {
                                          item.options[i].selected = true
                                       }
                                    }
                                 } catch (error) {

                                 }

                                 item.options[item.options.length - item.options.length].selected = false
                              }

                           </script>
                        </div>

                     </div>
                  </form>
               </div>
               <!-- /.card-header -->
               <!-- .card-body -->
               <div class="card-body">

                  <div class="">
                     <div id="tblInsurance_wrapper" class="dataTables_wrapper dt-bootstrap4 no-footer no-scroll">
                        <div class="form-row  mb-3">
                           <div class="col-md-6">
                              <div class="dataTables_length" id="tblInsurance_length">
                                 <label>
                                    Show
                                    <select id="select_length" name="tblInsurance_length" onchange="showNextRows(true)"
                                       aria-controls="tblInsurance" class="custom-select">
                                       <option value="3">3</option>
                                       <option value="5">5</option>
                                       <option value="10">10</option>
                                       <option value="25">25</option>
                                       <option value="50">50</option>
                                       <option value="100">100</option>
                                       <option value="0" selected>all</option>
                                    </select>
                                    entries
                                 </label>
                              </div>


                           </div>

                           <div class="col-md-6">
                              <div id="tblInsurance_filter" class="dataTables_filter"><label>Search:<input value=""
                                       type="search" id="myInput" oninput="delayedSearch()"
                                       onkeypress="searchTableOnEnterKey(event)" class="form-control" placeholder=""
                                       aria-controls="tblInsurance"></label></div>
                           </div>
                        </div>
                     </div>
                  </div>

                  <div class="table-responsive">
                     <div class="dataTables_scroll">
                        <div class="dataTables_scrollHead" style="position: relative; border: 0px; width: 100%;">
                           <div class="dataTables_scrollHeadInner"
                              style="box-sizing: content-box; width: auto; padding-right: 0px;">
                              <table class="table table-striped1 table-hover no-wrap table-bordered no-footer dataTable"
                                 aria-describedby="tblInsurance_info" role="grid"
                                 style="margin-left: 0px; width: 5774.97px;">

                              </table>
                           </div>
                        </div>
                        <div class="dataTables_scrollBody" style="position: relative;  width: 100%;">
                           <table id="tblInsurance"
                              class="table table-striped1 table-hover no-wrap table-bordered no-footer dataTable"
                              aria-describedby="tblInsurance_info" role="grid">

                              <thead style="border-bottom: inset;">
                                 <tr role="row" id="tbdy_head">
                                    <th class=" text-center sorting thShow" tabindex="0" aria-controls="tblInsurance"
                                       rowspan="1" colspan="1" style="width: 83.2344px;"
                                       aria-label="Sr.No.: activate to sort column ascending">Sr.No.</th>
                                    <!-- <th id="thCheck" class="text-center sorting_disabled sorting" tabindex="0"
                                       aria-controls="tblInsurance" rowspan="1" colspan="1" style="width: 30px;"
                                       aria-label="">
                                       <input type="checkbox" class="checkbox" id="chkblkrm"
                                          onchange="selectAllPolicy()" />
                                    </th> -->

                                    <!-- <th class="sorting">PolicyID</th> -->
                                    <th class="sorting thShow">Proposal No.</th>
                                    <th class="sorting text-center">Policy No. </th>
                                    <th class="sorting thShow">Customer Name</th>
                                    <th class="sorting  thShow">Insurer Name</th>
                                    <th class="sorting">Service Provider</th>
                                    <th class="sorting">Broker Code</th>
                                    <th class="sorting">Product Name</th>
                                    <th class="sorting">Registration No.</th>
                                    <th class="sorting">RTO State</th>
                                    <th class="sorting">RTO City</th>
                                    <th class="sorting">Vehicle Makeby </th>
                                    <th class="sorting">Vehicle Model </th>
                                    <th class="sorting thShow">Vehicle Catagory </th>
                                    <th class="sorting">Vehicle Fuel Type</th>
                                    <th class="sorting">Manufacture Year </th>
                                    <th class="sorting">Addon</th>
                                    <th class="sorting">NCB</th>
                                    <th class="sorting">Cubic Capacity</th>
                                    <th class="sorting">GVW</th>
                                    <th class="sorting">Seating Capacity</th>
                                    <th class="sorting">Coverage Type</th>
                                    <th class="sorting">Policy Type</th>
                                    <th class="sorting">CPA</th>
                                    <th class="sorting">Risk Start Date</th>
                                    <th class="sorting">Risk End Date</th>
                                    <th class="sorting">Issue Date</th>
                                    <th class="sorting">Insured Age</th>
                                    <th class="sorting">Policy Term</th>
                                    <th class="sorting">BQP</th>
                                    <th class="sorting">POS</th>
                                    <th class="sorting">Employee</th>
                                    <th class="sorting">Remark</th>
                                    <th class="sorting thShow">OD Premium</th>
                                    <th class="sorting thShow">TP / Terrorism</th>
                                    <th class="sorting thShow">NET Premium</th>
                                    <th class="sorting thShow">GST 18%</th>
                                    <th class="sorting thShow">GST 12%</th>
                                    <th class="sorting thShow">Total</th>
                                    <th class="sorting">Payment Mode</th>

                                    <th class="sorting thShow">Agent OD Reward %</th>
                                    <th class="sorting thShow">Agent OD Amount</th>
                                    <th class="sorting thShow">Agent TP Reward %</th>
                                    <th class="sorting thShow">Agent TP Amount</th>
                                    {% if is_user %}
                                    <th class="sorting thShow">Self OD Reward %</th>
                                    <th class="sorting thShow">Self OD Amount</th>
                                    <th class="sorting thShow">Self TP Reward %</th>
                                    <th class="sorting thShow">Self TP Amount</th>
                                    {% endif %}
                                    <th class="sorting">Proposal</th>
                                    <th class="sorting">Mandate</th>
                                    <th class="sorting">Policy</th>
                                    <th class="sorting">Previous Policy</th>
                                    <th class="sorting">Pan Card</th>
                                    <th class="sorting">Aadhar Card</th>
                                    <th class="sorting">Vehicle RC</th>
                                    <th class="sorting">Inspection Report</th>
                                    <th class="sorting">Action</th>
                                 </tr>
                              </thead>

                              <tbody id="tbdy">

                                 <!-- {% for value in data %}                              -->
                                 <tr role="row" class="policy-row odd" onclick="SelectRow(this)" id="tr1">

                                    <td class="text-center">{{forloop.counter}}</td>
                                    <!-- <td class="text-center"><input type="checkbox" value="2479" class="checkbox"
                                          id="chkblkrm{{forloop.counter}}" /></td> -->

                                    <!-- <td>{{value.policyid}}</td> -->
                                    <td>{{value.proposal_no}}</td>
                                    <td>
                                       <a href="" class="tile tile-img" target="_blank"><i
                                             class="far fa-file-pdf text-danger mt-1"></i></a>
                                       <a href="/bima_policy/policy/policy_entrydata/{{value.policyid}}"
                                          class="">{{value.policy_no}}</a>
                                    </td>
                                    <td>{{value.customer_name}}</td>
                                    <td>{{value.insurance_company}}</td>
                                    <td>{{value.sp_name}}</td>
                                    <td>{{value.sp_brokercode}}</td>
                                    <td>{{value.product_name}}</td>
                                    <td>{{value.registration_no}}</td>
                                    <td>{{value.rto_state}}</td>
                                    <td>{{value.rto_city}}</td>
                                    <td>{{value.vehicle_makeby}}</td>
                                    <td>{{value.vehicle_model}}</td>
                                    <td>{{value.vehicle_catagory}}</td>
                                    <td>{{value.vehicle_fuel_type}}</td>

                                    {% if value.mfg_year%}
                                    <td>{{value.mfg_year}}</td>
                                    {% else %}
                                    <td></td>
                                    {% endif %}

                                    <td>{{value.addon}}</td>
                                    <td>{{value.ncb}}</td>
                                    <td>{{value.cubic_capacity}}</td>
                                    <td>{{value.gvw}}</td>

                                    <!-- Note: Space added because Excel converts 5-7 or 7-12 as date formate -->
                                    <td>&nbsp;{{value.seating_capacity}}</td>

                                    <td>{{value.coverage_type}}</td>
                                    <td>{{value.policy_type}}</td>
                                    <td>{{value.cpa}}</td>
                                    <td>{{value.risk_start_date}}</td>
                                    <td>{{value.risk_end_date}}</td>
                                    <td>{{value.issue_date}}</td>

                                    {% if value.insured_age%}
                                    <td>{{value.insured_age}}</td>
                                    {% else %}
                                    <td></td>
                                    {% endif %}

                                    <td>{{value.policy_term}}</td>
                                    <td>{{value.bqp}}</td>
                                    <td>{{value.pos}}</td>
                                    <td>{{value.employee}}</td>
                                    <td>{{value.remark}}</td>
                                    <!-- OD  -->

                                    <td>{{value.OD_premium}}</td>

                                    <td>{{value.TP_terrorism}}</td>
                                    <td>{{value.net}}</td>

                                    <td>{{value.gst_amount}}</td>

                                    {% if value.gst_gcv_amount %}
                                    <td>{{ value.gst_gcv_amount }}</td>
                                    {% else %}
                                    <td></td>
                                    {% endif %}

                                    <td>{{value.total}}</td>

                                    <td>{{value.payment_mode}}</td>

                                    {% if value.agent_od_reward%}
                                    <td>{{value.agent_od_reward}}</td>
                                    {% else %}
                                    <td></td>
                                    {% endif %}

                                    {% if value.agent_od_amount%}
                                    <td>{{value.agent_od_amount}}</td>
                                    {% else %}
                                    <td></td>
                                    {% endif %}

                                    {% if value.agent_tp_reward%}
                                    <td>{{value.agent_tp_reward}}</td>
                                    {% else %}
                                    <td></td>
                                    {% endif %}

                                    {% if value.agent_tp_amount%}
                                    <td>{{value.agent_tp_amount}}</td>
                                    {% else %}
                                    <td></td>
                                    {% endif %}

                                    {% if is_user %}

                                    {% if value.self_od_reward%}
                                    <td>{{value.self_od_reward}}</td>
                                    {% else %}
                                    <td></td>
                                    {% endif %}

                                    {% if value.self_od_amount%}
                                    <td>{{value.self_od_amount}}</td>
                                    {% else %}
                                    <td></td>
                                    {% endif %}

                                    {% if value.self_tp_reward%}
                                    <td>{{value.self_tp_reward}}</td>
                                    {% else %}
                                    <td></td>
                                    {% endif %}

                                    {% if value.self_tp_amount%}
                                    <td>{{value.self_tp_amount}}</td>
                                    {% else %}
                                    <td></td>
                                    {% endif %}

                                    {% endif %}

                                    <td> <a href="#" class="text-black"
                                          onclick="downloadFile('{{value.proposal}}')">{{value.proposal}}</a> </td>
                                    <td> <a href="#" onclick="downloadFile('{{value.mandate}}')">{{value.mandate}}</a>
                                    </td>
                                    <td> <a href="#" onclick="downloadFile('{{value.policy}}')">{{value.policy}}</a>
                                    </td>
                                    <td> <a href="#"
                                          onclick="downloadFile('{{value.previous_policy}}')">{{value.previous_policy}}</a>
                                    </td>
                                    <td> <a href="#" onclick="downloadFile('{{value.pan_card}}')">{{value.pan_card}}</a>
                                    </td>
                                    <td> <a href="#"
                                          onclick="downloadFile('{{value.aadhar_card}}')">{{value.aadhar_card}}</a>
                                    </td>
                                    <td> <a href="#"
                                          onclick="downloadFile('{{value.vehicle_rc}}')">{{value.vehicle_rc}}</a>
                                    </td>
                                    <td> <a href="#"
                                          onclick="downloadFile('{{value.inspection_report}}')">{{value.inspection_report}}</a>
                                    </td>

                                    <!-- <td> <a href="/media/{{value.proposal}}">{{value.proposal}}</a> </td> -->
                                    <!-- <td> <a href="/media/{{value.mandate}}">{{value.mandate}}</a> </td> -->
                                    <!-- <td> <a href="/media/{{value.policy}}">{{value.policy}}</a> </td>
                                    <td> <a href="/media/{{value.previous_policy}}">{{value.previous_policy}}</a>
                                    </td>
                                    <td> <a href="/media/{{value.pan_card}}">{{value.pan_card}}</a> </td>
                                    <td> <a href="/media/{{value.aadhar_card}}">{{value.aadhar_card}}</a> </td>
                                    <td> <a href="/media/{{value.vehicle_rc}}">{{value.vehicle_rc}}</a> </td>
                                    <td> <a href="/media/{{value.inspection_report}}">{{value.inspection_report}}</a>  </td> -->

                                    <td class="text-center">
                                       <form method="POST">
                                          {% csrf_token %}
                                          <a href="/bima_policy/policy/policy_entrydata/{{value.policyid}}"
                                             class="mr-1 mt-1 btn btn-sm btn-icon btn-secondary" name="Edit">
                                             <i class="fa fa-pencil-alt mt-2"></i>
                                             <!-- href="/bima_policy/policy/policy_entrydata/{{value.policyid}}" -->
                                          </a>
                                          <a href="/bima_policy/deleted_policy/{{value.policyid}}" name="Remove"
                                             class="mr-1 mt-1 btn btn-sm btn-icon btn-secondary text-danger">
                                             <i class="far fa-trash-alt mt-2"></i>

                                             <!-- href="/bima_policy/policy/{{value.policyid}}/delete" -->

                                          </a>
                                    </td>
                                 </tr>
                                 <!-- {% endfor %} -->

                              </tbody>

                           </table>


                        </div>
                     </div>
                  </div>

                  <button id="nextButton" class="btn mt-3" onclick="showNextRows(false)"
                     style="float: right; background-color: #346CB0; color: white;">Next</button>

                  <button id="pevButton" class="btn btn-secondary mt-3" hidden
                     style="float: right; background-color: #346CB0; color: #FFFFFF; ">Back</button>

               </div>
               <!-- /.page-inner -->
            </div>
            <!-- /.page -->
         </div>

      </div>


      <div class="page " id="motor_entry" hidden>
         <div class="page-inner">
            <div class="ajax-progressBar">
               <div class="postProgress"></div>
            </div>

            <header class="page-title-bar">
               <!-- <h3 id="notification">files </h3> -->

               <!-- <div class="d-flex justify-content-between align-items-center">
                  <nav aria-label="breadcrumb">
                     <ol class="breadcrumb">
                        <li class="breadcrumb-item active">
                           <a href="list"><i class="breadcrumb-icon fa fa-angle-left mr-2"></i>Back</a>
                        </li>
                     </ol>
                  </nav>
               </div> -->
               <div class="row text-center text-sm-left">
                  <div class="col">
                     <h1 id="policy_title" class="page-title"> Motor Policy
                        <small class="text-muted"> All * marks Fields are
                           mandatory.
                        </small>
                     </h1>
                  </div>
               </div>
            </header>

            <div class="page-section">
               <div class="section-block">

                  <div class="row">
                     <div class="col-lg-9 col-md-9 col-sm-12">
                        <div class="card">
                           <div class="card-body">
                              <fieldset>
                                 <legend>Policy Details</legend>

                                 <div class="form-row">

                                    <div class="col-md-3 mb-4">
                                       <label>Vehicle Catagory <abbr title="" class="text-danger">*</abbr></label>
                                       <select name="vehicle_catagory" id="vehicle_catagory" class="custom-select "
                                          required onclick="setCategoryOnChange()">

                                       </select>
                                    </div>

                                    <div class="col-md-3 mb-4">
                                       <label for="proposal_no">Proposal No. <abbr title=""
                                             class="text-danger">*</abbr></label><input type="text" value=""
                                          class="form-control" name="proposal_no" id="proposal_no"
                                          style="text-transform: uppercase;" required>
                                    </div>
                                    <div class="col-md-3 mb-4">
                                       <label for="policy_no">Policy No. <abbr title=""
                                             class="text-danger">*</abbr></label><input type="text" value=""
                                          class="form-control" name="policy_no" id="policy_no"
                                          style="text-transform: uppercase;" required>
                                    </div>

                                    <div class="col-md-3 mb-4">
                                       <label for="customer_name">Insured Name <abbr title=""
                                             class="text-danger">*</abbr></label><input type="text" value=""
                                          class="form-control" id="customer_name" name="customer_name"
                                          style="text-transform: uppercase;" required>
                                    </div>
                                    <div class="col-md-3 mb-4">
                                       <label>Insurer Name<abbr title="" class="text-danger">*</abbr></label>
                                       <select name="insurance_company" class="custom-select" id="insurance_company"
                                          required>

                                       </select>
                                    </div>
                                    <div class="col-md-3 mb-4">
                                       <label>Serving Office <abbr title="" class="text-danger">*</abbr></label>
                                       <select name="sp_name" class="custom-select" id="sp_name" required>

                                       </select>
                                    </div>
                                    <div class="col-md-3 mb-4">
                                       <label>Office Code <abbr title="" class="text-danger">*</abbr></label>
                                       <select name="sp_brokercode" class="custom-select" id="sp_brokercode" required>
                                          <option value="" hidden> -- Select Office Code -- </option>
                                          {%for value in broker_codes%}
                                          <option value="{{value}}">{{value}}</option>
                                          {%endfor%}
                                       </select>

                                    </div>
                                    <div class="col-md-3 mb-4">
                                       <label for="registration_no">Registration No. <abbr title=""
                                             class="text-danger">*</abbr></label>
                                       <div class="input-group input-group-alt">
                                          <input type="text" oninput="myFunction()" class="form-control" value=""
                                             placeholder="Minimum 8 Characters" id="registration_no"
                                             name="registration_no" maxlength="14" required
                                             style="text-transform: uppercase;">
                                          <div class="input-group-append">
                                             <span class="input-group-text" id="demo" placeholder="xxxx"></span>
                                          </div>
                                       </div>
                                    </div>

                                    <div class="col-md-3 mb-4">
                                       <label>RTO State<abbr title="" class="text-danger">*</abbr></label>
                                       <select name="rto_state" class="custom-select" id="rto_state" required>
                                          <option value="" >-- Select State --</option>
                                          <option value="Andama And Nicobar Island">Andama And Nicobar Island
                                          </option>
                                          <option value="Andhra Pradesh">Andhra Pradesh</option>
                                          <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                                          <option value="Assam">Assam</option>
                                          <option value="Bihar">Bihar</option>
                                          <option value="Chandigarh">Chandigarh</option>
                                          <option value="Chattisgarh">Chattisgarh</option>
                                          <option value="Daman And Diu">Daman And Diu</option>
                                          <option value="Delhi">Delhi</option>
                                          <option value="Goa">Goa</option>
                                          <option value="Gujrat">Gujrat</option>
                                          <option value="Haryana">Haryana</option>
                                          <option value="Himachal Pradesh">Himachal Pradesh</option>
                                          <option value="Jammu And Kashmir">Jammu And Kashmir</option>
                                          <option value="Jharkhand">Jharkhand</option>
                                          <option value="Karnataka">Karnataka</option>
                                          <option value="Kerala">Kerala</option>
                                          <option value="Lakshadweep">Lakshadweep</option>
                                          <option value="Leh">Leh</option>
                                          <option value="Madhya Pradesh">Madhya Pradesh</option>
                                          <option value="Maharashtra">Maharashtra</option>
                                          <option value="Manipur">Manipur</option>
                                          <option value="Meghalaya">Meghalaya</option>
                                          <option value="Mizoram">Mizoram</option>
                                          <option value="Nagaland">Nagaland</option>
                                          <option value="NCR">NCR</option>
                                          <option value="Odisha">Odisha</option>
                                          <option value="Puducherry">Puducherry</option>
                                          <option value="Punjab">Punjab</option>
                                          <option value="Rajasthan">Rajasthan</option>
                                          <option value="Sikkim">Sikkim</option>
                                          <option value="Tamil Nadu">Tamil Nadu</option>
                                          <option value="Telangana">Telangana</option>
                                          <option value="Tripura">Tripura</option>
                                          <option value="Uttar Pradesh">Uttar Pradesh</option>
                                          <option value="Uttrakhand">Uttrakhand</option>
                                          <option value="West Bengal">West Bengal</option>
                                       </select>
                                    </div>

                                    <div class="col-md-3 mb-4">
                                       <label for="rto_city">RTO City <abbr title=""
                                             class="text-danger">*</abbr></label><input type="text" value=""
                                          class="form-control" id="rto_city" name="rto_city"
                                          style="text-transform: uppercase;" required>
                                    </div>


                                    <div class="col-md-3 mb-4">
                                       <label>Vehicle Make <abbr title="" class="text-danger">*</abbr></label>
                                       <select name="vmake" class="custom-select  " id="vmake" aria-hidden="true"
                                          required>
                                       </select>
                                    </div>


                                    <div class="col-md-3 mb-4">
                                       <label>Vehicle Model <abbr title="" class="text-danger">*</abbr></label>
                                       <select name="vmodel" class="custom-select  " id="vmodel" aria-hidden="true"
                                          required>


                                       </select>
                                    </div>


                                    <div class="col-md-3 mb-4">
                                       <label>Vehicle Fuel Type <abbr title="" class="text-danger">*</abbr></label>
                                       <select id="vehicle_fuel_type" name="vehicle_fuel_type" class="custom-select"
                                          required>
                                          <option value="">-- Select Fuel Type --</option>
                                          <option value="PETROL">PETROL</option>
                                          <option value="DIESEL">DIESEL</option>
                                          <option value="CNG">CNG</option>
                                          <option value="ELECTRIC">ELECTRIC</option>
                                       </select>
                                    </div>
                                    <div class="col-md-3 mb-4">
                                       <label for="mfg_year">Manufacture Year <abbr title=""
                                             class="text-danger">*</abbr></label>
                                       <select id="mfg_year" name="mfg_year" class="custom-select" required>
                                          <option value="" >-- Select Year --</option>
                                          <option value="2025">2025</option>
                                          <option value="2024">2024</option>
                                          <option value="2023">2023</option>
                                          <option value="2022">2022</option>
                                          <option value="2021">2021</option>
                                          <option value="2020">2020</option>
                                          <option value="2019">2019</option>
                                          <option value="2018">2018</option>
                                          <option value="2017">2017</option>
                                          <option value="2016">2016</option>
                                          <option value="2015">2015</option>
                                          <option value="2014">2014</option>
                                          <option value="2013">2013</option>
                                          <option value="2012">2012</option>
                                          <option value="2011">2011</option>
                                          <option value="2010">2010</option>
                                          <option value="2009">2009</option>
                                          <option value="2008">2008</option>
                                          <option value="2007">2007</option>
                                          <option value="2006">2006</option>
                                          <option value="2005">2005</option>
                                          <option value="2004">2004</option>
                                          <option value="2003">2003</option>
                                          <option value="2002">2002</option>
                                          <option value="2001">2001</option>
                                       </select>
                                    </div>
                                    <div class="col-md-3 mb-4">
                                       <label>Addon <abbr title="" class="text-danger">*</abbr></label>
                                       <select id="addon" name="addon" class="custom-select" required>
                                          <option value="" hidden>-- Select Addon --</option>
                                          <option value="YES">YES</option>
                                          <option value="NO">NO</option>
                                       </select>
                                    </div>
                                    <div class="col-md-3 mb-4">
                                       <label>NCB <abbr title="" class="text-danger">*</abbr></label>
                                       <select id="ncb" name="ncb" class="custom-select" required>
                                          <option value="" hidden>-- Select NCB --</option>
                                          <option value="YES">YES</option>
                                          <option value="NO">NO</option>
                                       </select>
                                    </div>
                                    <div class="col-md-3 mb-4" id="cubic_div" hidden>
                                       <label>Cubic Capacity<abbr class="text-danger">*</abbr></label>
                                       <select id="cubic_capacity" name="cubic_capacity" class="custom-select">

                                       </select>
                                    </div>

                                    <div class="col-md-3 mb-4" id="coverage_div" hidden>
                                       <label>Coverage Type <abbr class="text-danger">*</abbr></label>
                                       <select id="coverage_type" name="coverage_type" class="custom-select" required>
                                          <!-- <option value="" hidden>-- Select Coverage --</option> -->

                                       </select>
                                    </div>

                                    <div class="col-md-3 mb-4" id="seating_div" hidden>
                                       <label>Seating Capacity<abbr class="text-danger">*</abbr></label>
                                       <select id="seating_capacity" name="seating_capacity" type="input"
                                          class="custom-select" required>
                                          <option value="">-- Select seating --</option>

                                          <option value="BELOW 5">BELOW 5</option>
                                          <option value="5-7">5-7</option>
                                          <option value="7-12">7-12</option>
                                          <option value="12-18">12-18</option>
                                          <option value="ABOVE 18">ABOVE 18</option>
                                       </select>
                                    </div>


                                    <div class="col-md-3 mb-4" id="seating_capacityDiv1" hidden>
                                       <label for="seating_capacity1">Seating Capacity <abbr
                                             class="text-danger">*</abbr></label><input type="text" value=""
                                          class="form-control col-lg-6 maskNumField" name="seating_capacity1"
                                          id="seating_capacity1" maxlength="2" required oninput="addSeatingCapacity()">
                                    </div>

                                    <div class="col-md-3 mb-4" id="gvw_div" hidden>
                                       <label>GVW<abbr class="text-danger">*</abbr></label>
                                       <select id="gvw" name="gvw" class="custom-select" required>
                                          <option value=""> -- Select GVW -- </option>
                                          <option value="BELOW 2000">BELOW 2000</option>
                                          <option value="2000-2500">2000-2500</option>
                                          <option value="2500-3500">2500-3500</option>
                                          <option value="3500-7000">3500-7000</option>
                                          <option value="7000-7500">7000-7500</option>
                                          <option value="7500-12000">7500-12000</option>
                                          <option value="12000-25000">12000-25000</option>
                                          <option value="25000-40000">25000-40000</option>
                                          <option value="ABOVE 40000">ABOVE 40000</option>
                                       </select>
                                    </div>


                                    <div class="col-md-3 mb-4">
                                       <label>Policy Type <abbr title="" class="text-danger">*</abbr></label>
                                       <select id="policy_type" name="policy_type" class="custom-select" required>
                                          <option value="">-- Select Policy Type --</option>
                                          <option value="FRESH">FRESH</option>
                                          <option value="RENEWAL">RENEWAL</option>
                                          <option value="ROLLOVER">ROLLOVER</option>
                                          <option value="ENDORSEMENT">ENDORSEMENT</option>
                                       </select>
                                    </div>

                                    <div class="col-md-3 mb-4">
                                       <label>CPA <abbr title="" class="text-danger">*</abbr></label>
                                       <select id="cpa" name="cpa" class="custom-select" required>
                                          <option value="">-- Select CPA --</option>
                                          <option value="YES">YES</option>
                                          <option value="NO">NO</option>
                                       </select>
                                    </div>

                                    <div class="col-md-3 mb-4">
                                       <label for="flatpickr-wrap">Risk Start Date <abbr title=""
                                             class="text-danger">*</abbr></label>
                                       <div class="input-group input-group-alt flatpickr" data-toggle="risk_flatpickr"
                                          data-wrap="true" data-alt-input="true" data-alt-format="F j, Y"
                                          data-alt-input-class="form-control" data-date-format="Y-m-d">

                                          <input id="risk_start_date" name="risk_start_date" type="date"
                                             class="form-control flatpickr-input" placeholder="Choose date..." value=""
                                             required data-input="">
                                       </div>
                                    </div>
                                    <div class="col-md-3 mb-4">
                                       <label for="flatpickr-wrap">Risk End Date <abbr title="Required"
                                             class="text-danger">*</abbr></label>
                                       <div class="input-group input-group-alt flatpickr" data-toggle="risk_flatpickr"
                                          data-wrap="true" data-alt-input="true" data-alt-format="F j, Y"
                                          data-alt-input-class="form-control" data-date-format="Y-m-d">

                                          <input id="risk_end_date" name="risk_end_date" type="date"
                                             class="form-control flatpickr-input" placeholder="Choose date..." value=""
                                             name="" required data-input="">
                                       </div>
                                    </div>
                                    <div class="col-md-3 mb-4">
                                       <label for="flatpickr-wrap">Issued Date <abbr title=""
                                             class="text-danger">*</abbr></label>
                                       <div class="input-group input-group-alt flatpickr" data-toggle="issue_flatpickr"
                                          data-wrap="true" data-alt-input="true" ata-alt-format="F j, Y"
                                          data-alt-input-class="form-control" data-date-format="Y-m-d">

                                          <input id="issue_date" name="issue_date" type="date"
                                             class="form-control flatpickr-input" placeholder="Choose date..." value=""
                                             required data-input="">
                                       </div>
                                    </div>

                                    <div class="col-md-3 mb-4">
                                       <label for="insured_age">Insured Age <abbr title=""
                                             class="text-danger">*</abbr></label>
                                       <input id="insured_age" name="insured_age" type="text" value="0"
                                          class="form-control" required>
                                    </div>
                                    <div class="col-md-3 mb-4">
                                       <label>Policy Term <abbr title="" class="text-danger">*</abbr></label>
                                       <select id="policy_term" name="policy_term" class="custom-select" required>
                                          <option value="">-- Select Term --</option>
                                          <option value="1">1</option>
                                          <option value="2">2</option>
                                          <option value="3">3</option>
                                          <option value="4">4</option>
                                          <option value="5">5</option>
                                       </select>
                                    </div>

                                    <div class="col-md-3 mb-4" onkeypress="document.getElementById('pos').click();">
                                       <label for="pos">POS <abbr title="" class="text-danger">*</abbr></label>
                                       <input id="pos" name="pos" type="text" value="" data-toggle="modal"
                                          data-target="#mdlPOS" class="form-control" style="text-transform: uppercase;"
                                          required readonly>
                                    </div>

                                    <div class="col-md-3 mb-4">
                                       <label>BQP <abbr title="" class="text-danger">*</abbr></label>
                                       <select id="bqp" name="bqp" class="custom-select" required>
                                          <option value="">-- Select BQP --</option>
                                          <option value="SATVEER SINGH"> SATVEER SINGH </option>

                                       </select>
                                    </div>

                                    <div class="col-md-3 mb-4">
                                       <label for="employee">Employee <abbr title=""
                                             class="text-danger">*</abbr></label>
                                       <input id="employee" name="employee" type="text" value="" class="form-control"
                                          style="text-transform: uppercase;  background-color: lightgray;" readonly
                                          disabled required>
                                    </div>


                                    <div class="col-md-3 mb-4">
                                       <label>Proposal <small>(Only<strong> PDF &amp; Image
                                             </strong>File)</small> </label>
                                       <div class="custom-file">
                                          <input type="file" name="proposal" accept=".pdf,image/" id="proposal"
                                             class="custom-file-input">
                                          <label id="lbl_proposal" name="lbl_proposal" class="custom-file-label"
                                             for="proposal">Choose
                                             file</label>
                                       </div>
                                       <a id="a_proposal" href="#" onclick="downloadFile(`${this.innerText}`)" > </a>

                                    </div>

                                    <div class="col-md-3 mb-4">
                                       <label>Mandate <small>(Only<strong> PDF &amp; Image
                                             </strong>File)</small> </label>
                                       <div class="custom-file">
                                          <input type="file" name="mandate" accept=".pdf,image/" id="mandate"
                                             class="custom-file-input">
                                          <label id="lbl_mandate" name="lbl_mandate" class="custom-file-label"
                                             for="mandate">Choose
                                             file</label>
                                       </div>
                                       <a id="a_mandate" href="#" onclick="downloadFile(`${this.innerText}`)" > </a>
                                    </div>

                                    <div class="col-md-3 mb-4">
                                       <label>Policy <small>(Only<strong> PDF &amp; Image
                                             </strong>File)</small> </label>
                                       <div class="custom-file">
                                          <input type="file" name="policy" accept=".pdf,image/" id="policy"
                                             class="custom-file-input" required>
                                          <label id="lbl_policy" name="lbl_policy" class="custom-file-label"
                                             for="policy">Choose
                                             file</label>
                                       </div>
                                       <a id="a_policy" href="#" onclick="downloadFile(`${this.innerText}`)" > </a>
                                    </div>

                                    <div class="col-md-3 mb-4">
                                       <label>Prev. Policy <small>(Only<strong> PDF &amp; Image
                                             </strong>)</small> </label>
                                       <div class="custom-file">
                                          <input type="file" name="previous_policy" accept=".pdf,image/"
                                             id="previous_policy" class="custom-file-input">
                                          <label id="lbl_previous_policy" name="lbl_previous_policy"
                                             class="custom-file-label" for="previous_policy">Choose file</label>
                                       </div>
                                       <a id="a_previous_policy" href="#" onclick="downloadFile(`${this.innerText}`)" > </a>

                                    </div>

                                    <div class="col-md-3 mb-4">
                                       <label>Pan Card <small>(Only<strong> PDF &amp; Image
                                             </strong>)</small> </label>
                                       <div class="custom-file">
                                          <input type="file" name="pan_card" accept=".pdf,image/" id="pan_card"
                                             class="custom-file-input">
                                          <label id="lbl_pan_card" name="lbl_pan_card" class="custom-file-label"
                                             for="pan_card">Choose
                                             file</label>
                                       </div>
                                       <a id="a_pan_card" href="#" onclick="downloadFile(`${this.innerText}`)" > </a>

                                    </div>

                                    <div class="col-md-3 mb-4">
                                       <label>Aadhar Card / GST<small>(Only<strong> PDF &amp; Image
                                             </strong>)</small> </label>
                                       <div class="custom-file">
                                          <input type="file" name="aadhar_card" accept=".pdf,image/" id="aadhar_card"
                                             class="custom-file-input">
                                          <label id="lbl_aadhar_card" name="lbl_aadhar_card" class="custom-file-label"
                                             for="aadhar_card">Choose file</label>
                                       </div>
                                       <a id="a_aadhar_card" href="#" onclick="downloadFile(`${this.innerText}`)" > </a>

                                    </div>

                                    <div class="col-md-4 mb-4">
                                       <label> Vehicle RC / Invoice<small>(Only<strong> PDF &amp; Image
                                             </strong>File)</small> </label>
                                       <div class="custom-file">
                                          <input type="file" name="vehicle_rc" accept=".pdf,image/" id="vehicle_rc"
                                             class="custom-file-input">
                                          <label id="lbl_vehicle_rc" name="lbl_vehicle_rc" class="custom-file-label"
                                             for="vehicle_rc">Choose
                                             file</label>
                                       </div>
                                       <a id="a_vehicle_rc" href="#" onclick="downloadFile(`${this.innerText}`)" > </a>

                                    </div>

                                    <div class="col-md-4 mb-4">
                                       <label>Inspection Report <small>(Only<strong> PDF &amp; Image
                                             </strong>)</small> </label>
                                       <div class="custom-file">
                                          <input type="file" name="inspection_report" accept=".pdf,image/"
                                             id="inspection_report" class="custom-file-input">
                                          <label id="lbl_inspection_report" name="lbl_inspection_report"
                                             class="custom-file-label" for="inspection_report">Choose file</label>
                                       </div>
                                       <a id="a_inspection_report" href="#" onclick="downloadFile(`${this.innerText}`)" > </a>

                                    </div>

                                    <div class="col-md-4 mb-4">
                                       <label for="remark">Remarks <abbr title="" class="text-danger">*</abbr></label>
                                       <input id="remark" name="remark" type="text" value="" maxlength="255"
                                          class="form-control" style="text-transform: uppercase;">
                                    </div>

                                 </div>

                              </fieldset>
                              <p class="mb-4"></p>
                           </div>
                           <!-- /.card-body -->
                        </div>
                        <!-- /.card -->
                     </div>


                     <div class="col-lg-3 col-md-3 col-sm-12">

                        <div class="card">

                           <div class="card-body">
                              <!-- .card-body -->
                              <h4 class="card-title mb-3"> Premium Details </h4>
                              <!-- grid row -->
                              <div class="row mb-2">
                                 <label class="col-lg-5" for="od">OD Premium <abbr title=""
                                       class="text-danger">*</abbr></label>
                                 <input id="od" name="od" type="text" oninput="calculateValue()" value=""
                                    class="form-control col-lg-6 " maxlength="10" required>
                              </div>
                              <div class="row mb-2">
                                 <label class="col-lg-5" for="tp">TP/Terrorism<abbr title=""
                                       class="text-danger">*</abbr></label>
                                 <input id="tpt" name="tpt" type="text" oninput="calculateValue()" value=""
                                    class="form-control col-lg-6 " " maxlength=" 10" required>
                              </div>
                              <div class="row mb-2">
                                 <label class="col-lg-5">Net Premium</label><input type="text" name="net" value=""
                                    class="form-control col-lg-6  bg-light" id="net" maxlength="10" readonly="" required
                                    tabindex="-1">
                              </div>

                              <div class="row mb-2">
                                 <label class="col-lg-5" for="gst">GST 18%<abbr title=""
                                       class="text-danger">*</abbr></label><input type="text" value=""
                                    class="form-control col-lg-6 bg-light" name="gst" id="gst" maxlength="10" required
                                    readonly tabindex="-1">
                              </div>

                              <div class="row mb-2" id="gsttDiv" hidden>
                                 <label class="col-lg-5" for="gstt">GST 12%<abbr title=""
                                       class="text-danger">*</abbr></label><input type="text" value=""
                                    class="form-control col-lg-6 bg-light" name="gstt" id="gstt" maxlength="10" readonly
                                    tabindex="-1">
                              </div>
                              <div class="row mb-2">
                                 <label class="col-lg-5">Total=(Net+GST) </label><input type="text" name="total"
                                    value="" class="form-control  col-lg-6 bg-light" id="totalnet" readonly=""
                                    maxlength="10" required tabindex="-1">
                              </div>


                              <div class="row mb-2">
                                 <label class="col-lg-5 pr-0 ">Payment <br> Mode</label>
                                 <select id="payment_mode" class="custom-select col-lg-6" required>
                                    <option value=""> -- Select Payment Mode -- </option>
                                    <option value="ONLINE" selected>ONLINE</option>
                                    <option value="CHEQUE"> CHEQUE</option>
                                    <option value="CASH">CASH</option>
                                 </select>
                              </div>

                           </div>


                        </div>

                     </div>

                  </div>

                  <!-- POSP modal dialog -->
                  <div class="modal fade" id="mdlPOS">
                     <div class="modal-dialog">
                        <div class="modal-content">
                           <div class="modal-header">
                              <h5 class="modal-title"> POSP </h5>
                           </div>
                           <div class="modal-body ">
                              <div class="form-row">

                                 <div class="col-md-12 mb-4">
                                    <label>SELECT POSP <abbr title="" class="text-danger">*</abbr></label>
                                    <select name="posps" class="custom-select select2 " id="posps" onclick="addPos()"
                                       onchange="get_POS_from_Modal()" aria-hidden="true" required>
                                    </select>
                                 </div>


                                 <!-- <div class="col-md-12 col-sm-12 mb-2">
                                       <select id="agents" class="custom-select " tabindex="-1" onclick="addPos()"
                                          aria-hidden="true" onchange="get_POS_from_Modal()">


                                       </select>
                                    </div> -->


                                 <div class="col-md-12 col-sm-12">
                                    <input id="inp_agent" type="text" value="" class="form-control" name="inp_agent"
                                       disabled style="text-transform: uppercase;"
                                       title="POS should be automatically fetched">
                                 </div>
                              </div>

                              <button class="mt-4 btn btn-primary" style="margin-bottom: -60px;"
                                 onclick="add_new_agent()">Add New
                                 POS</button>

                              <div class="modal-footer">
                                 <button id="btnExit" type="button" class="btn btn-secondary w-100p"
                                    data-dismiss="modal">Close</button>
                              </div>
                           </div>

                        </div>

                     </div>

                  </div>


               </div>
               <hr>

               <!-- submit data -->
               <div class="form-row">
                  <div class="col-md-12 col-sm-12" style="background-color: #346CB0; ">
                     <div id="payoutSection" class="card card-inverse " style="background-color: #346CB0;">
                        <!-- .card -->
                        <div class="card-header p-2">
                           <h4 class="card-title mb-1">Payouts</h4>
                        </div>
                        <div class="card-body" style="background-color: #346CB0; ">
                           <p><span class="icofont icofont-hand-right ml-1"></span> The Payout will be shown as
                              per the Policy Details</p>
                           <p><span class="icofont icofont-hand-right ml-1"></span> You can add manual Payout
                              after the Policy saved</p>
                           <div class="text-center">

                              <a href="#">
                                 <button id="btnGenerate_Policy" name="btnGenerate_Policy"
                                    style="background-color: #FFFFFF; color: #346CB0; font-weight: bold;" type="button"
                                    class="btn w-100p" onclick="sendPolicyData()">GENERATE
                                 </button>
                              </a>

                           </div>
                        </div>
                     </div>
                  </div>
               </div>

            </div>

         </div>
      </div>

      <div class="page " id="non_motor_entry" hidden>
         <div class="page-inner">
            <div class="ajax-progressBar">
               <div class="postProgress"></div>
            </div>


            <header class="page-title-bar">
               <!-- <h3 id="notification">files </h3> -->

               <!-- <div class="d-flex justify-content-between align-items-center">
                  <nav aria-label="breadcrumb">
                     <ol class="breadcrumb">
                        <li class="breadcrumb-item active"> -->
               <!-- <a href="list"><i class="breadcrumb-icon fa fa-angle-left mr-2"></i>Back</a> -->
               <!-- </li>
                     </ol>
                  </nav>
               </div> -->
               <div class="row text-center text-sm-left">
                  <div class="col">
                     <h1 id="policy_title_non_motor" class="page-title"> Non Motor Policy
                        <small class="text-muted"> All * marks Fields are
                           mandatory.
                        </small>
                     </h1>
                  </div>
               </div>
            </header>

            <div class="page-section">
               <div class="section-block">

                  <div class="row">
                     <div class="col-lg-9 col-md-9 col-sm-12">
                        <div class="card">
                           <div class="card-body">
                              <fieldset>
                                 <legend>Policy Details</legend>

                                 <div class="form-row">

                                    <div class="col-md-3 mb-4">
                                       <label>Product Name <abbr title="" class="text-danger">*</abbr></label>
                                       <select id="product_name" name="product_name" class="custom-select" required>
                                          <!-- <option value="" >-- Select Product --</option> -->

                                       </select>
                                    </div>

                                    <div class="col-md-3 mb-4">
                                       <label>Policy Type <abbr title="" class="text-danger">*</abbr></label>
                                       <select name="policy_type2" id="policy_type2" class="custom-select" required>
                                          <option value="">-- Select Case Type --</option>
                                          <option value="FRESH">FRESH</option>
                                          <option value="RENEWAL">RENEWAL</option>
                                          <option value="ROLLOVER">ROLLOVER</option>
                                          <option value="ENDORSEMENT">ENDORSEMENT</option>
                                       </select>
                                    </div>


                                    <div class="col-md-3 mb-4">
                                       <label for="proposal_no">Proposal No. <abbr title=""
                                             class="text-danger">*</abbr></label><input type="text" value=""
                                          class="form-control" name="proposal_no2" id="proposal_no2"
                                          style="text-transform: uppercase;" required>
                                    </div>

                                    <div class="col-md-3 mb-4">
                                       <label for="policy_no">Policy No. <abbr title=""
                                             class="text-danger">*</abbr></label><input type="text" value=""
                                          class="form-control" name="policy_no2" id="policy_no2"
                                          style="text-transform: uppercase;" required>
                                    </div>

                                    <div class="col-md-3 mb-4">
                                       <label for="customer_name">Insured Name <abbr title=""
                                             class="text-danger">*</abbr></label><input type="text" value=""
                                          class="form-control" name="customer_name2" id="customer_name2"
                                          style="text-transform: uppercase;" required>
                                    </div>

                                    <div class="col-md-3 mb-4">
                                       <label>Insurer Name<abbr title="" class="text-danger">*</abbr></label>
                                       <select name="insurer_name" class="custom-select" id="insurer_name" required>

                                       </select>
                                    </div>

                                    <div class="col-md-3 mb-4">
                                       <label>Serving Office <abbr title="" class="text-danger">*</abbr></label>
                                       <select name="sps_name" class="custom-select" id="sps_name" required>

                                       </select>
                                    </div>
                                    <div class="col-md-3 mb-4">
                                       <label>Office Code <abbr title="" class="text-danger">*</abbr></label>
                                       <select name="sp_code" class="custom-select" id="sp_code" required>

                                       </select>

                                    </div>

                                    <div class="col-md-3 mb-4">
                                       <label for="flatpickr-wrap">Risk Start Date <abbr title=""
                                             class="text-danger">*</abbr></label>
                                       <div class="input-group input-group-alt flatpickr" data-toggle="risk_flatpickr"
                                          data-wrap="true" data-alt-input="true" data-alt-format="F j, Y"
                                          data-alt-input-class="form-control" data-date-format="Y-m-d">
                                          <input type="date" class="form-control flatpickr-input"
                                             placeholder="Choose date..." value="" id="risk_start_date2"
                                             name="risk_start_date2" required data-input="">
                                       </div>
                                    </div>
                                    <div class="col-md-3 mb-4">
                                       <label for="flatpickr-wrap">Risk End Date <abbr title="Required"
                                             class="text-danger">*</abbr></label>
                                       <div class="input-group input-group-alt flatpickr" data-toggle="risk_flatpickr"
                                          data-wrap="true" data-alt-input="true" data-alt-format="F j, Y"
                                          data-alt-input-class="form-control" data-date-format="Y-m-d">
                                          <input type="date" class="form-control flatpickr-input"
                                             placeholder="Choose date..." value="" id="risk_end_date2"
                                             name="risk_end_date2" required data-input="">
                                       </div>
                                    </div>
                                    <div class="col-md-3 mb-4">
                                       <label for="flatpickr-wrap">Issued Date <abbr title=""
                                             class="text-danger">*</abbr></label>
                                       <div class="input-group input-group-alt flatpickr" data-toggle="issue_flatpickr"
                                          data-wrap="true" data-alt-input="true" ata-alt-format="F j, Y"
                                          data-alt-input-class="form-control" data-date-format="Y-m-d">
                                          <input type="date" class="form-control flatpickr-input"
                                             placeholder="Choose date..." value="" id="issue_date2" name="issue_date2"
                                             required data-input="">
                                       </div>
                                    </div>

                                    <div class="col-md-3 mb-4">
                                       <label>Policy Term <abbr title="" class="text-danger">*</abbr></label>
                                       <select id="policy_term2" name="policy_term2" class="custom-select" required>
                                          <option value="">-- Select Term --</option>
                                          <option value="1">1</option>
                                          <option value="5">5</option>
                                          <option value="10">10</option>

                                       </select>
                                    </div>

                                    <div class="col-md-3 mb-4" onkeypress="document.getElementById('pos').click();">
                                       <label for="pos">POS <abbr title="" class="text-danger">*</abbr></label><input
                                          id="pos_product" type="text" value="" data-toggle="modal"
                                          data-target="#mdlPOSP" class="form-control" name="pos_product"
                                          style="text-transform: uppercase;" required readonly>
                                    </div>

                                    <div class="col-md-3 mb-4">
                                       <label>BQP <abbr title="" class="text-danger">*</abbr></label>
                                       <select id="bqp2" name="bqp2" class="custom-select" required>
                                          <option value="">-- Select BQP --</option>
                                          <option value="SATVEER SINGH" selected> SATVEER SINGH </option>
                                       </select>
                                    </div>

                                    <div class="col-md-3 mb-4">
                                       <label for="employee">Employee <abbr title=""
                                             class="text-danger">*</abbr></label><input type="text" value=""
                                          class="form-control" name="product_employee" id="product_employee"
                                          style="text-transform: uppercase;  background-color: lightgray;" disabled
                                          required>
                                    </div>


                                    <div class="col-md-3 mb-4">
                                       <label>Proposal <small>(Only<strong> PDF &amp; Image
                                             </strong>File)</small> </label>
                                       <div class="custom-file">
                                          <input type="file" name="proposal2" accept=".pdf,image/" id="proposal2"
                                             class="custom-file-input">
                                          <label id="lbl_proposal2" name="lbl_proposal2" class="custom-file-label"
                                             for="proposal">Choose
                                             file</label>
                                       </div>
                                       <a id="a_proposal2" href="#" onclick="downloadFile(`${this.innerText}`)" > </a>
                                    </div>

                                    <div class="col-md-3 mb-4">
                                       <label>Mandate <small>(Only<strong> PDF &amp; Image
                                             </strong>File)</small> </label>
                                       <div class="custom-file">
                                          <input type="file" name="mandate2" accept=".pdf,image/" id="mandate2"
                                             class="custom-file-input">
                                          <label id="lbl_mandate2" name="lbl_mandate2" class="custom-file-label"
                                             for="mandate">Choose
                                             file</label>
                                       </div>
                                       <a id="a_mandate2" href="#" onclick="downloadFile(`${this.innerText}`)" > </a>
                                    </div>

                                    <div class="col-md-3 mb-4">
                                       <label>Policy <small>(Only<strong> PDF &amp; Image
                                             </strong>File)</small> </label>
                                       <div class="custom-file">
                                          <input type="file" name="policy2" accept=".pdf,image/" id="policy2"
                                             class="custom-file-input" required>
                                          <label id="lbl_policy2" name="lbl_policy2" class="custom-file-label"
                                             for="policy">Choose
                                             file</label>
                                       </div>
                                       <a id="a_policy2" href="#" onclick="downloadFile(`${this.innerText}`)" > </a>
                                    </div>

                                    <div class="col-md-3 mb-4">
                                       <label>Prev. Policy <small>(Only<strong> PDF &amp; Image
                                             </strong>)</small> </label>
                                       <div class="custom-file">
                                          <input type="file" name="previous_policy2" accept=".pdf,image/"
                                             id="previous_policy2" class="custom-file-input">
                                          <label id="lbl_previous_policy2" name="lbl_previous_policy2"
                                             class="custom-file-label" for="previous_policy">Choose file</label>
                                       </div>
                                       <a id="a_previous_policy2" href="#" onclick="downloadFile(`${this.innerText}`)" > </a>
                                    </div>

                                    <div class="col-md-3 mb-4">
                                       <label>Pan Card <small>(Only<strong> PDF &amp; Image
                                             </strong>)</small> </label>
                                       <div class="custom-file">
                                          <input type="file" name="pan_card2" accept=".pdf,image/" id="pan_card2"
                                             class="custom-file-input">
                                          <label id="lbl_pan_card2" name="lbl_pan_card2" class="custom-file-label"
                                             for="pan_card">Choose
                                             file</label>
                                       </div>
                                       <a id="a_pan_card2" href="#" onclick="downloadFile(`${this.innerText}`)" > </a>
                                    </div>

                                    <div class="col-md-3 mb-4">
                                       <label>Aadhar Card / GST<small>(Only<strong> PDF &amp; Image
                                             </strong>)</small> </label>
                                       <div class="custom-file">
                                          <input type="file" name="aadhar_card2" accept=".pdf,image/" id="aadhar_card2"
                                             class="custom-file-input">
                                          <label id="lbl_aadhar_card2" name="lbl_aadhar_card2" class="custom-file-label"
                                             for="aadhar_card">Choose file</label>
                                       </div>
                                       <a id="a_aadhar_card2" href="#" onclick="downloadFile(`${this.innerText}`)" > </a>
                                    </div>

                                    <div class="col-md-4 mb-4">
                                       <label>Brochure <small>(Only<strong> PDF &amp; Image
                                             </strong>)</small> </label>
                                       <div class="custom-file">
                                          <input type="file" name="inspection_report2" accept=".pdf,image/"
                                             id="inspection_report2" class="custom-file-input">
                                          <label id="lbl_inspection_report2" name="lbl_inspection_report2"
                                             class="custom-file-label" for="vehicle_rc">Choose file</label>
                                       </div>
                                       <a id="a_inspection_report2" href="#" onclick="downloadFile(`${this.innerText}`)" > </a>
                                    </div>

                                    <div class="col-md-4 mb-4">
                                       <label for="remark">Remarks <abbr title=""
                                             class="text-danger">*</abbr></label><input type="text" value=""
                                          maxlength="255" class="form-control" name="remark2" id="remark2"
                                          style="text-transform: uppercase;">
                                    </div>

                                 </div>

                              </fieldset>
                              <p class="mb-4"></p>
                           </div>
                           <!-- /.card-body -->
                        </div>
                        <!-- /.card -->
                     </div>


                     <div class="col-lg-3 col-md-3 col-sm-12">

                        <div class="card">

                           <div class="card-body">
                              <!-- .card-body -->
                              <h4 class="card-title mb-3"> Premium Details </h4>
                              <!-- grid row -->
                              <div class="row mb-2">
                                 <label class="col-lg-5" for="od">OD Premium <abbr title=""
                                       class="text-danger">*</abbr></label><input type="text"
                                    oninput="calculateValue2()" value="" class="form-control col-lg-6 "
                                    name="od_product" id="od_product" maxlength="10" required>
                              </div>
                              <div class="row mb-2">
                                 <label class="col-lg-5" for="tp">TP/Terrorism<abbr title=""
                                       class="text-danger">*</abbr></label><input type="text"
                                    oninput="calculateValue2()" value="" class="form-control col-lg-6 "
                                    name="tpt_product" id="tpt_product" maxlength="10" required>
                              </div>
                              <div class="row mb-2">
                                 <label class="col-lg-5">Net Premium</label><input type="text" name="net_product"
                                    value="" class="form-control col-lg-6  bg-light" id="net_product" maxlength="10"
                                    readonly="" required tabindex="-1">
                              </div>

                              <div class="row mb-2">
                                 <label class="col-lg-5" for="gst">GST 18%<abbr title=""
                                       class="text-danger">*</abbr></label><input type="text" value=""
                                    class="form-control col-lg-6 bg-light" name="gst_product" id="gst_product"
                                    maxlength="10" required readonly tabindex="-1">
                              </div>

                              <div class="row mb-2">
                                 <label class="col-lg-5">Total=(Net+GST) </label><input type="text" name="total_product"
                                    value="" class="form-control  col-lg-6 bg-light" id="total_product" readonly=""
                                    maxlength="10" required tabindex="-1">
                              </div>


                              <div class="row mb-2">
                                 <label class="col-lg-5 pr-0 ">Payment <br> Mode</label>
                                 <select class="custom-select col-lg-6" id="payment_mode2" name="payment_mode2"
                                    required>
                                    <option value=""> -- Select Mode -- </option>
                                    <option value="ONLINE" selected>ONLINE</option>
                                    <option value="CHEQUE"> CHEQUE</option>
                                    <option value="CASH">CASH</option>
                                 </select>
                              </div>

                           </div>


                        </div>


                     </div>

                  </div>

                  <div class="modal fade" id="mdlPOSP">
                     <div class="modal-dialog">
                        <div class="modal-content">
                           <div class="modal-header">
                              <h5 class="modal-title"> POSP </h5>
                           </div>
                           <div class="modal-body ">
                              <div class="form-row">

                                 <div class="col-md-12 mb-4">
                                    <label>SELECT POSP <abbr title="" class="text-danger">*</abbr></label>
                                    <select name="posps_product" class="custom-select select2 " id="posps_product"
                                       onclick="addPosToProduct()" onchange="get_POS_from_Modal_product()"
                                       aria-hidden="true" required>
                                    </select>
                                 </div>


                                 <!-- <div class="col-md-12 col-sm-12 mb-2">
                                       <select id="agents" class="custom-select " tabindex="-1" onclick="addPos()"
                                          aria-hidden="true" onchange="get_POS_from_Modal()">


                                       </select>
                                    </div> -->


                                 <div class="col-md-12 col-sm-12">
                                    <input id="inp_agent_product" type="text" value="" class="form-control"
                                       name="inp_agent_product" disabled style="text-transform: uppercase;"
                                       title="POS should be automatically fetched">
                                 </div>
                              </div>

                              <button class="mt-4 btn btn-primary" style="margin-bottom: -60px;"
                                 onclick="add_new_agent()">Add New
                                 POS</button>

                              <div class="modal-footer">
                                 <button id="btnExit" type="button" class="btn btn-secondary w-100p"
                                    data-dismiss="modal">Close</button>
                              </div>
                           </div>

                        </div>

                     </div>

                  </div>


               </div>
               <hr>

               <!-- submit data -->
               <div class="form-row">
                  <div class="col-md-12 col-sm-12" style="background-color: #346CB0; ">
                     <div id="payoutSection" class="card card-inverse " style="background-color: #346CB0;">
                        <!-- .card -->
                        <div class="card-header p-2">
                           <h4 class="card-title mb-1">Payouts</h4>
                        </div>
                        <div class="card-body" style="background-color: #346CB0; ">
                           <p><span class="icofont icofont-hand-right ml-1"></span> The Payout will be shown as
                              per the Policy Details</p>
                           <p><span class="icofont icofont-hand-right ml-1"></span> You can add manual Payout
                              after the Policy saved</p>
                           <div class="text-center">

                              <a href="#">
                                 <button id="btnGenerate_Policy_nonmotor" name="btnGenerate_Policy"
                                    style="background-color: #FFFFFF; color: #346CB0; font-weight: bold;" type="button"
                                    class="btn w-100p" onclick="sendPolicyDataNonMotor()">GENERATE
                                 </button>
                              </a>

                           </div>
                        </div>
                     </div>
                  </div>
               </div>

            </div>

         </div>
      </div>

      <div class="page " id="new_posp" hidden>
         <!-- .page -->
         <div class="page-inner">
            <!-- .page-inner -->
            <header class="page-title-bar">
               <!-- .page-title-bar -->
               <div class="d-flex justify-content-between align-items-center">
                  <!-- .d-flex -->
                  <!-- .breadcrumb -->

                  <!-- /.breadcrumb -->
               </div>
               <!-- /.d-flex -->
               <!-- grid row -->
               <div class="row text-center text-sm-left">
                  <!-- grid column -->
                  <div class="col">
                     <h1 id="posp_title" class="page-title"> POSP Form <small class="text-muted"> All * marks Fields are
                           mandatory.
                        </small>
                     </h1>
                  </div>

                  <!-- /grid column -->
               </div>
               <!-- /grid row -->
            </header>
            <!-- .page-section -->
            <div class="page-section">
               <!-- .section-block -->
               <div class="section-block">

                  <div class="row">
                     <div class="col-lg-12 col-md-12 col-sm-12">
                        <div class="card">
                           <!-- .card -->
                           <div class="card-body">
                              <!-- .card-body -->
                              <!-- .content -->
                              <div class="ajax-progressBar">
                                 <div class="postProgress"></div>
                              </div>
                              <fieldset>
                                 <!-- fieldset -->
                                 <legend class="mb-2">POSP Information</legend>
                                 <div class="form-row">

                                    <div class="col-md-2 mb-2">
                                       <label>POSP Code<abbr title=" " class="text-danger">*</abbr></label>
                                       <input id="posp_code" type="text" class="form-control" name="posp_code"
                                          data-parsley-="true" required style="text-transform: uppercase;">
                                    </div>
                                    <div class="col-md-2 mb-2">
                                       <label>Registration Code<abbr title=" " class="text-danger">*</abbr></label>
                                       <input id="registration_code" type="text" class="form-control"
                                          name="registration_code" data-parsley-="true" required
                                          style="text-transform: uppercase;">
                                    </div>
                                    <div class="col-md-2 mb-2">
                                       <label>Full Name<abbr title=" " class="text-danger">*</abbr></label>
                                       <input id="full_name" type="text" name="full_name"
                                          data-parsley-pattern="^(?:[A-Za-z]+[- ])*[A-Za-z]+$"
                                          style="text-transform: uppercase;" data-parsley-="true" class="form-control"
                                          required>
                                    </div>
                                    <div class="col-md-2 mb-2">
                                       <label>Gender<abbr title=" " class="text-danger">*</abbr></label>
                                       <select id="gender" name="gender" id="gender" data-parsley- -message=""
                                          class="custom-select" required data-parsley-="true" aria-hidden="true">
                                          <option value=""> -- select Gender -- </option>
                                          <option value="MALE"> MALE </option>
                                          <option value="FEMALE"> FEMALE </option>
                                          <option value="OTHER"> OTHER </option>
                                       </select>
                                    </div>
                                    <div class="col-md-2 mb-2">
                                       <label>Mobile No<abbr title=" " class="text-danger">*</abbr></label>
                                       <input id="mob_no" type="text" class="form-control maskNumField"
                                          data-mask-as-number-maxlength="10" required data-parsley-="true"
                                          data-parsley-minlength="10" data-parsley-maxlength="10"
                                          data-parsley-pattern="^[0-9]+$" name="mob_no" maxlength="10">
                                    </div>
                                    <div class="col-md-2 mb-2">
                                       <label>Email Id<abbr title=" " class="text-danger">*</abbr></label>
                                       <input id="email_id" type="text" class="form-control" name="email_id"
                                          data-parsley-type="email" required style="text-transform: lowercase;"
                                          data-parsley-="true" value="">
                                    </div>

                                    <div class="col-md-2 mb-2">
                                       <label>Address<abbr title=" " class="text-danger">*</abbr></label>
                                       <input id="address" type="text" class="form-control" name="address"
                                          data-parsley-="true" required style="text-transform: uppercase;">
                                    </div>

                                    <div class="col-md-2 mb-4">
                                       <label>RTO State<abbr title="" class="text-danger">*</abbr></label>
                                       <select id="state" name="state" class="custom-select" id="state" required>
                                          <option value="">-- Select State --</option>
                                          <option value="Andama And Nicobar Island">Andama And Nicobar Island
                                          </option>
                                          <option value="Andhra Pradesh">Andhra Pradesh</option>
                                          <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                                          <option value="Assam">Assam</option>
                                          <option value="Bihar">Bihar</option>
                                          <option value="Chandigarh">Chandigarh</option>
                                          <option value="Chattisgarh">Chattisgarh</option>
                                          <option value="Daman And Diu">Daman And Diu</option>
                                          <option value="Delhi">Delhi</option>
                                          <option value="Goa">Goa</option>
                                          <option value="Gujrat">Gujrat</option>
                                          <option value="Haryana">Haryana</option>
                                          <option value="Himachal Pradesh">Himachal Pradesh</option>
                                          <option value="Jammu And Kashmir">Jammu And Kashmir</option>
                                          <option value="Jharkhand">Jharkhand</option>
                                          <option value="Karnataka">Karnataka</option>
                                          <option value="Kerala">Kerala</option>
                                          <option value="Lakshadweep">Lakshadweep</option>
                                          <option value="Leh">Leh</option>
                                          <option value="Madhya Pradesh">Madhya Pradesh</option>
                                          <option value="Maharashtra">Maharashtra</option>
                                          <option value="Manipur">Manipur</option>
                                          <option value="Meghalaya">Meghalaya</option>
                                          <option value="Mizoram">Mizoram</option>
                                          <option value="Nagaland">Nagaland</option>
                                          <option value="NCR">NCR</option>
                                          <option value="Odisha">Odisha</option>
                                          <option value="Puducherry">Puducherry</option>
                                          <option value="Punjab">Punjab</option>
                                          <option value="Rajasthan">Rajasthan</option>
                                          <option value="Sikkim">Sikkim</option>
                                          <option value="Tamil Nadu">Tamil Nadu</option>
                                          <option value="Telangana">Telangana</option>
                                          <option value="Tripura">Tripura</option>
                                          <option value="Uttar Pradesh">Uttar Pradesh</option>
                                          <option value="Uttrakhand">Uttrakhand</option>
                                          <option value="West Bengal">West Bengal</option>
                                       </select>
                                    </div>

                                    <div class="col-md-2 mb-2">
                                       <label>City<abbr title=" " class="text-danger">*</abbr></label>
                                       <input id="city" type="text" class="form-control" name="city"
                                          data-parsley-="true" required style="text-transform: uppercase;">
                                    </div>
                                    <div class="col-md-2 mb-2">
                                       <label>Pincode<abbr title=" " class="text-danger">*</abbr></label>
                                       <input id="pincode" type="text" class="form-control maskNumField"
                                          data-mask-as-number-maxlength="6" required data-parsley-="true"
                                          data-parsley-minlength="6" data-parsley-maxlength="6"
                                          data-parsley-pattern="^[0-9]+$" name="pincode" maxlength="6">
                                    </div>
                                    <div class="col-md-2 mb-2">
                                       <label>Rural / Urban<abbr class="text-danger">*</abbr></label>
                                       <select id="rural_urban" name="rural_urban" class="custom-select"
                                          id="rural_urban" required>
                                          <option value=""> -- Select Rural -- </option>
                                          <option value="RURAL">Rural</option>
                                          <option value="URBAN">Urban</option>
                                       </select>
                                    </div>

                                    <div class="col-md-2 mb-2">
                                       <label>Agent Slab<abbr title=" " class="text-danger">*</abbr></label>
                                       <select id="slab" name="slab" class="custom-select " required aria-hidden="true">
                                          <option value="">Choose...</option>
                                          <option value="slab 1" selected>slab 1</option>

                                       </select>
                                    </div>

                                    <div class="col-md-2 mb-2">
                                       <label>GSTIN<abbr title=" " class="text-danger">*</abbr></label>
                                       <input id="GSTIN" type="text" class="form-control maskNumField"
                                          data-mask-as-number-maxlength="15" data-parsley-="true"
                                          data-parsley-minlength="15" data-parsley-maxlength="15"
                                          data-parsley-pattern="^[0-9]+$" name="GSTIN" maxlength="15">
                                    </div>

                                    <div class="col-md-2 mb-2">
                                       <label>Account No:</label>
                                       <input type="text" class="form-control" id="account_no" name="account_no"
                                          required style="text-transform: uppercase;">
                                    </div>
                                    <div class="col-md-2 mb-2">
                                       <label>IFSC Code:</label>
                                       <input type="text" class="form-control" id="ifsc_code" name="ifsc_code" required
                                          style="text-transform: uppercase;">
                                    </div>
                                    <div class="col-md-2 mb-2">
                                       <label>Bank Name:</label>
                                       <input type="text" class="form-control" id="bank_name" name="bank_name" required
                                          style="text-transform: uppercase;">
                                    </div>

                                    <div class="col-md-3 mb-4">
                                       <label>Basic Qualification <small>(Only<strong> PDF &amp; Image
                                             </strong>File)</small> </label>
                                       <div class="custom-file">
                                          <input type="file" id="basic_qualification" name="basic_qualification"
                                             accept=".pdf,image/" class="custom-file-input">
                                          <label id="lbl_basic_qualification" class="custom-file-label"
                                             for="basic_qualification">Choose
                                             file</label>
                                       </div>
                                       <a id="a_basic_qualification"  href="#"  onclick="downloadFile(`${this.innerText}`)"  > </a>

                                    </div>
                                    <div class="col-md-3 mb-4">
                                       <label>Aadhar Card <small>(Only<strong> PDF &amp; Image
                                             </strong>File)</small> </label>
                                       <div class="custom-file">
                                          <input required type="file" name="aadhar_card_pos" accept=".pdf,image/"
                                             id="aadhar_card_pos" class="custom-file-input">
                                          <label id="lbl_aadhar_card_pos" class="custom-file-label"
                                             for="aadhar_card">Choose file</label>
                                       </div>
                                       <a id="a_aadhar_card_pos" href="#"  onclick="downloadFile(`${this.innerText}`)"  > </a>

                                    </div>

                                    <div class="col-md-3 mb-4">
                                       <label>Pan Card <small>(Only<strong> PDF &amp; Image
                                             </strong>File)</small> </label>
                                       <div class="custom-file">
                                          <input required type="file" name="pan_card_pos" accept=".pdf,image/"
                                             id="pan_card_pos" class="custom-file-input">
                                          <label id="lbl_pan_card_pos" class="custom-file-label" for="pan_card">Choose
                                             file</label>
                                       </div>
                                       <a id="a_pan_card_pos" href="#" onclick="downloadFile(`${this.innerText}`)" > </a>

                                    </div>
                                    <div class="col-md-3 mb-4">
                                       <label>Training Certificate <small>(Only<strong> PDF &amp; Image
                                             </strong>File)</small> </label>
                                       <div class="custom-file">
                                          <input required type="file" name="training_certificate_pos"
                                             accept=".pdf,image/" id="training_certificate_pos"
                                             class="custom-file-input">
                                          <label id="lbl_training_certificate_pos" class="custom-file-label"
                                             for="training_certificate">Choose
                                             file</label>
                                       </div>
                                       <a id="a_training_certificate_pos" href="#" onclick="downloadFile(`${this.innerText}`)" > </a>

                                    </div>
                                    <div class="col-md-3 mb-4">
                                       <label>Appointment Certificate <small>(Only<strong> PDF &amp; Image
                                             </strong>File)</small> </label>
                                       <div class="custom-file">
                                          <input type="file" name="appointment_certificate_pos" accept=".pdf,image/"
                                             id="appointment_certificate_pos" class="custom-file-input">
                                          <label id="lbl_appointment_certificate_pos" class="custom-file-label"
                                             for="appointment_certificate">Choose
                                             file</label>
                                       </div>
                                       <a id="a_appointment_certificate_pos" href="#" onclick="downloadFile(`${this.innerText}`)" > </a>

                                    </div>
                                    <div class="col-md-3 mb-4">
                                       <label>Agreement <small>(Only<strong> PDF &amp; Image
                                             </strong>File)</small> </label>
                                       <div class="custom-file">
                                          <input required type="file" name="agreement_certificate_pos"
                                             accept=".pdf,image/" id="agreement_certificate_pos"
                                             class="custom-file-input">
                                          <label id="lbl_agreement_certificate_pos" class="custom-file-label"
                                             for="agreement_certificate">Choose
                                             file</label>
                                       </div>
                                       <a id="a_agreement_certificate_pos" href="#" onclick="downloadFile(`${this.innerText}`)" > </a>

                                    </div>
                                    <div class="col-md-3 mb-4">
                                       <label>Bank Details <small>(Only<strong> PDF &amp; Image
                                             </strong>File)</small> </label>
                                       <div class="custom-file">
                                          <input required type="file" name="bank_details_pos" accept=".pdf,image/"
                                             id="bank_details_pos" class="custom-file-input">
                                          <label id="lbl_bank_details_pos" class="custom-file-label"
                                             for="bank_details">Choose file</label>
                                       </div>
                                       <a id="a_bank_details_pos" href="#" onclick="downloadFile(`${this.innerText}`)" > </a>

                                    </div>

                                    <div class="col-md-3 mb-4">
                                       <label>Password<abbr title=" " class="text-danger">*</abbr></label>
                                       <input type="password" id="password" name="password" class="form-control"
                                          required data-parsley-minlength="6" data-parsley-maxlength="15"
                                          data-parsley-pattern="/^(?=.*[0-9])(?=.*[!@#$%^&amp;*])[a-zA-Z0-9!@#$%^&amp;*]{6,20}$/"
                                          data-parsley-="true"
                                          parsley-pattern-message="The string must contain at least 1 lowercase alphabetical character<br>The Password must contain at least 1 uppercase alphabetical character<br>The Password must contain at least 1 numeric character <br>The string must contain at least one special character">
                                    </div>

                                    <div class="col-md-3 mb-4">
                                       <label>Retype Password<abbr title=" " class="text-danger">*</abbr></label>
                                       <input type="password" id="confirm_password" name="confirm_password" required
                                          data-parsley-error-message="Password &amp; confirm password should be same"
                                          data-parsley-equalto="#password" class="form-control" data-parsley-="true">
                                    </div>

                                    <!-- <div class="col-md-4 mb-4">
                               <legend class="mb-2">Documents</legend>
                               <label><small>(Accept Only<strong> PDF &amp; Image </strong>File) </small> <span
                                   class="docerror text-red"></span></label>
                               <div class="k-content">
                                 <div class="k-widget k-upload k-header k-upload-sync k-upload-empty">
                                   <div class="k-button k-upload-button" aria-label="Select files..."><input name="docs"  
                                       id="documents" accept=".pdf,image/*" type="file" aria-label="files" data-role="upload"
                                       multiple="multiple" autocomplete="off"   ><span>Select files...</span></div>
                                 </div>
                               </div>
                             </div> -->

                                 </div>

                           </div>


                           </fieldset>

                        </div>
                        <!-- /.card-body -->
                     </div>
                     <!-- /.card -->
                  </div>
               </div>
               <hr>


               <div class="form-row">
                  <div class="col-md-12 col-sm-12" style="background-color: #346CB0; ">
                     <div id="payoutSection" class="card card-inverse " style="background-color: #346CB0;">
                        <!-- .card -->
                        <div class="card-header p-2">
                           <h4 class="card-title mb-1">POSP</h4>
                        </div>
                        <div class="card-body" style="background-color: #346CB0; ">
                           <p><span class="icofont icofont-hand-right ml-1"></span> The POSP will be
                              active by-defaults</p>
                           <p><span class="icofont icofont-hand-right ml-1"></span> You can edit POSP
                              later except posp-code</p>
                           <div class="text-center">

                              <a href="#">
                                 <button id="btn_save_posp" name="btn_save_posp"
                                    style="background-color: #FFFFFF; color: #346CB0; font-weight: bold;" type="button"
                                    class="btn w-100p" onclick="sendPOspFormData()">GENERATE
                                 </button>
                              </a>

                           </div>
                        </div>
                     </div>
                  </div>
               </div>


               <!-- /form -->
            </div>
            <!-- /.section-block -->
         </div>
         <!-- /.page-section -->
      </div>

</main>


<script>
   document.addEventListener('DOMContentLoaded', async function () {

      Load_Dashboard_Details()
      await FetchDataAsync()
      Load_Dashboard_Details()
   });


</script>


<script>

   var fetchList = []
   var freezList = []

   // Dashboard 

   function ShowPage(page_name) {
      if (page_name == 'dashboard') {
         document.getElementById('dashboard').hidden = false
         document.getElementById('entrylist').hidden = true
         document.getElementById('motor_entry').hidden = true
         document.getElementById('non_motor_entry').hidden = true
         document.getElementById('new_posp').hidden = true

         Load_Dashboard_Details()
      }

      else if (page_name == 'entry_list') {
         document.getElementById('dashboard').hidden = true
         document.getElementById('entrylist').hidden = false
         document.getElementById('motor_entry').hidden = true
         document.getElementById('non_motor_entry').hidden = true
         document.getElementById('new_posp').hidden = true

         Load_Entry_List()
      }

      else if (page_name == 'posp') {
         document.getElementById('dashboard').hidden = true
         document.getElementById('entrylist').hidden = false
         document.getElementById('motor_entry').hidden = true
         document.getElementById('non_motor_entry').hidden = true
         document.getElementById('new_posp').hidden = true

         Load_POSP_List()
      }

      else if (page_name == 'insurer') {
         document.getElementById('dashboard').hidden = true
         document.getElementById('entrylist').hidden = false
         document.getElementById('motor_entry').hidden = true
         document.getElementById('non_motor_entry').hidden = true
         document.getElementById('new_posp').hidden = true

         Load_Insurer_List()
      }

      else if (page_name == 'sp') {
         document.getElementById('dashboard').hidden = true
         document.getElementById('entrylist').hidden = false
         document.getElementById('motor_entry').hidden = true
         document.getElementById('non_motor_entry').hidden = true
         document.getElementById('new_posp').hidden = true

         Load_SP_List()
      }

      else if (page_name == 'product') {
         document.getElementById('dashboard').hidden = true
         document.getElementById('entrylist').hidden = false
         document.getElementById('motor_entry').hidden = true
         document.getElementById('non_motor_entry').hidden = true
         document.getElementById('new_posp').hidden = true

         Load_Product_List()
      }

      else if (page_name == 'vcategory') {
         document.getElementById('dashboard').hidden = true
         document.getElementById('entrylist').hidden = false
         document.getElementById('motor_entry').hidden = true
         document.getElementById('non_motor_entry').hidden = true
         document.getElementById('new_posp').hidden = true

         Load_Vehicle_Category_List()
      }

      else if (page_name == 'vmake') {
         document.getElementById('dashboard').hidden = true
         document.getElementById('entrylist').hidden = false
         document.getElementById('motor_entry').hidden = true
         document.getElementById('non_motor_entry').hidden = true
         document.getElementById('new_posp').hidden = true

         Load_Vehicle_Make_List()
      }

      else if (page_name == 'vmodel') {
         document.getElementById('dashboard').hidden = true
         document.getElementById('entrylist').hidden = false
         document.getElementById('motor_entry').hidden = true
         document.getElementById('non_motor_entry').hidden = true
         document.getElementById('new_posp').hidden = true

         Load_Vehicle_Model_List()
      }

      else if (page_name == 'staff') {
         document.getElementById('dashboard').hidden = true
         document.getElementById('entrylist').hidden = false
         document.getElementById('motor_entry').hidden = true
         document.getElementById('non_motor_entry').hidden = true
         document.getElementById('new_posp').hidden = true

         Load_Staff_List()
      }

      else if (page_name == 'motor_entry') {
         document.getElementById('dashboard').hidden = true
         document.getElementById('entrylist').hidden = true
         document.getElementById('motor_entry').hidden = false
         document.getElementById('non_motor_entry').hidden = true
         document.getElementById('new_posp').hidden = true

         Load_Motor_Config()
      }

      else if (page_name == 'non_motor_entry') {
         document.getElementById('dashboard').hidden = true
         document.getElementById('entrylist').hidden = true
         document.getElementById('motor_entry').hidden = true
         document.getElementById('non_motor_entry').hidden = false
         document.getElementById('new_posp').hidden = true

         Load_NonMotor_Config()
      }

      else if (page_name == 'new_posp') {
         document.getElementById('dashboard').hidden = true
         document.getElementById('entrylist').hidden = true
         document.getElementById('motor_entry').hidden = true
         document.getElementById('non_motor_entry').hidden = true
         document.getElementById('new_posp').hidden = false

         Load_Posp_Config()
      }

   }

   function Load_Dashboard_Details() {
      dashboard_details = JSON.parse(localStorage.getItem('dashboard_details'));
      if (dashboard_details != null) {
         document.getElementById('staffcount').textContent = dashboard_details.staffcount
         document.getElementById('agentcount').textContent = dashboard_details.agentcount
         document.getElementById('spcount').textContent = dashboard_details.spcount
         document.getElementById('policycount').textContent = dashboard_details.policycount
      }
   }

   function Load_Entry_List() {
      data = JSON.parse(localStorage.getItem('entry_list'));
      if (data != null) {
         GeneratePolicyTable(data);
         fetchList = data
      }

   }

   function Load_POSP_List() {
      data = JSON.parse(localStorage.getItem('posp'));
      if (data != null) {
         GeneratePospTable(data);
         fetchList = data
      }
   }

   function Load_Insurer_List() {
      data = JSON.parse(localStorage.getItem('insurers'));
      if (data != null) {
         GenerateInsurerTable(data);
         fetchList = data
      }
   }

   function Load_SP_List() {
      data = JSON.parse(localStorage.getItem('sps'));
      if (data != null) {

         GenerateSPTable(data);
         fetchList = data
      }
   }

   function Load_Product_List() {
      data = JSON.parse(localStorage.getItem('products'));
      if (data != null) {
         GenerateProductTable(data);
         fetchList = data
      }
   }

   function Load_Vehicle_Category_List() {
      data = JSON.parse(localStorage.getItem('vehicles'));
      if (data != null) {
         GenerateVehicleCategoryTable(data.category);
         fetchList = data.category
      }
   }

   function Load_Vehicle_Make_List() {
      data = JSON.parse(localStorage.getItem('vehicles'));
      if (data != null) {
         GenerateVehicleMakeTable(data.makes);
         fetchList = data.makes
      }
   }

   function Load_Vehicle_Model_List() {
      data = JSON.parse(localStorage.getItem('vehicles'));
      if (data != null) {
         GenerateVehicleModelTable(data.models);
         fetchList = data.models
      }
   }

   function Load_Staff_List() {
      data = JSON.parse(localStorage.getItem('staffs'));
      if (data != null) {
         GenerateStaffTable(data);
         fetchList = data
      }
   }

   function Load_Motor_Config() {

      document.getElementById('policy_title').innerText = "Motor Policy"
      document.getElementById('btnGenerate_Policy').innerText = "GENERATE"

      document.getElementById('proposal_no').value = ""
      document.getElementById('policy_no').value = ""
      document.getElementById('customer_name').value = ""
      document.getElementById('registration_no').value = ""
      document.getElementById('rto_state').selectedIndex = 0
      document.getElementById('rto_city').value = ""
      document.getElementById('vehicle_fuel_type').selectedIndex = 0
      document.getElementById('mfg_year').selectedIndex = 0
      document.getElementById('addon').selectedIndex = 0
      document.getElementById('ncb').selectedIndex = 0
      document.getElementById('cubic_capacity').selectedIndex = 0
      document.getElementById('coverage_type').selectedIndex = 0
      document.getElementById('policy_type').selectedIndex = 0
      document.getElementById('cpa').selectedIndex = 0
      document.getElementById('risk_start_date').value = ""
      document.getElementById('risk_end_date').value = ""
      document.getElementById('issue_date').value = ""
      document.getElementById('insured_age').value = 0
      document.getElementById('policy_term').selectedIndex = 0
      document.getElementById('pos').value = ""
      document.getElementById('bqp').selectedIndex = 1
      document.getElementById('remark').value = ""

      document.getElementById('od').value = ""
      document.getElementById('tpt').value = ""
      document.getElementById('net').value = ""
      document.getElementById('gst').value = ""
      document.getElementById('gstt').value = 0
      document.getElementById('totalnet').value = ""
      document.getElementById('payment_mode').selectedIndex = 1

      document.getElementById('proposal').value = ""
      document.getElementById('a_proposal').innerText = ""
      document.getElementById('mandate').value = ""
      document.getElementById('a_mandate').innerText = ""
      document.getElementById('policy').value = ""
      document.getElementById('a_policy').innerText = ""
      document.getElementById('previous_policy').value = ""
      document.getElementById('a_previous_policy').innerText = ""
      document.getElementById('pan_card').value = ""
      document.getElementById('a_pan_card').innerText = ""
      document.getElementById('aadhar_card').value = ""
      document.getElementById('a_aadhar_card').innerText = ""
      document.getElementById('vehicle_rc').value = ""
      document.getElementById('a_vehicle_rc').innerText = ""
      document.getElementById('inspection_report').value = ""
      document.getElementById('a_inspection_report').innerText = ""


      vehicles = JSON.parse(localStorage.getItem('vehicles'));
      // vehicle category
      category = vehicles.category
      element = document.getElementById('vehicle_catagory')
      element.innerHTML = ''
      newoption = document.createElement("option");
      newoption.value = ''
      newoption.innerHTML = '-- select category --'
      element.options.add(newoption);
      category.forEach(item => {
         newoption = document.createElement("option");
         newoption.value = item.category
         newoption.innerHTML = item.category
         element.options.add(newoption);
      })

      // vehicle makeby      
      makes = vehicles.makes
      element = document.getElementById('vmake')
      element.innerHTML = ''
      newoption = document.createElement("option");
      newoption.value = ''
      newoption.innerHTML = '-- select make --'
      element.options.add(newoption);
      makes.forEach(item => {
         var newoption = document.createElement("option");
         newoption.value = item.make
         newoption.innerHTML = item.make
         element.options.add(newoption);
      })

      // vehicle model  
      models = vehicles.models
      element = document.getElementById('vmodel')
      element.innerHTML = ''
      newoption = document.createElement("option");
      newoption.value = ''
      newoption.innerHTML = '-- select model --'
      element.options.add(newoption);
      models.forEach(item => {
         var newoption = document.createElement("option");
         newoption.value = item.model
         newoption.innerHTML = item.model
         element.options.add(newoption);
      })

      // insurance_company
      insurers = JSON.parse(localStorage.getItem('insurers'));
      element = document.getElementById('insurance_company')
      element.innerHTML = ''

      newoption = document.createElement("option");
      newoption.value = ''
      newoption.innerHTML = '-- select insurer --'
      element.options.add(newoption);
      insurers.forEach(item => {
         var newoption = document.createElement("option");
         newoption.value = item.comp_name
         newoption.innerHTML = item.comp_name
         element.options.add(newoption);
      })

      // service providers
      sps = JSON.parse(localStorage.getItem('sps'));
      element = document.getElementById('sp_name')
      element.innerHTML = ''

      newoption = document.createElement("option");
      newoption.value = ''
      newoption.innerHTML = '-- select branch --'
      element.options.add(newoption);
      sps.forEach(item => {
         var newoption = document.createElement("option");
         newoption.value = item.full_name
         newoption.innerHTML = item.full_name
         element.options.add(newoption);
      })

      // broker code    
      bc = JSON.parse(localStorage.getItem('bc'));
      element = document.getElementById('sp_brokercode')
      element.innerHTML = ''
      newoption = document.createElement("option");
      newoption.value = ''
      newoption.innerHTML = '-- select code --'
      element.options.add(newoption);
      bc.forEach(item => {
         var newoption = document.createElement("option");
         newoption.value = item.code
         newoption.innerHTML = item.code
         element.options.add(newoption);
      })

      // employee
      employee = JSON.parse(localStorage.getItem('employee'));
      document.getElementById('employee').value = employee
   }

   function Load_NonMotor_Config() {

      document.getElementById('policy_title_non_motor').innerText = "Non Motor Policy"
      document.getElementById('btnGenerate_Policy_nonmotor').innerText = "GENERATE"

      document.getElementById('product_name').innerHTML = ''
      document.getElementById('policy_type2').selectedIndex = 0
      document.getElementById('proposal_no2').value = ""
      document.getElementById('policy_no2').value = ""
      document.getElementById('customer_name2').value = ""
      document.getElementById('insurer_name').selectedIndex = 0
      document.getElementById('sps_name').selectedIndex = 0
      document.getElementById('sp_code').selectedIndex = 0

      document.getElementById('risk_start_date2').value = ""
      document.getElementById('risk_end_date2').value = ""
      document.getElementById('issue_date2').value = ""

      document.getElementById('policy_term2').selectedIndex = 0
      document.getElementById('pos_product').value = ""
      document.getElementById('bqp2').selectedIndex = 1

      employee = JSON.parse(localStorage.getItem('employee'));
      document.getElementById('product_employee').value = employee

      document.getElementById('remark2').value = ""

      document.getElementById('od_product').value = ""
      document.getElementById('tpt_product').value = ""
      document.getElementById('net_product').value = ""
      document.getElementById('gst_product').value = ""
      document.getElementById('total_product').value = ""

      document.getElementById('payment_mode2').selectedIndex = 1

      document.getElementById('proposal2').value = ""
      document.getElementById('a_proposal2').innerText = ""
      document.getElementById('mandate2').value = ""
      document.getElementById('a_mandate2').innerText = ""
      document.getElementById('policy2').value = ""
      document.getElementById('a_policy2').innerText = ""
      document.getElementById('previous_policy2').value = ""
      document.getElementById('a_previous_policy2').innerText = ""
      document.getElementById('pan_card2').value = ""
      document.getElementById('a_pan_card2').innerText = ""
      document.getElementById('aadhar_card2').value = ""
      document.getElementById('a_aadhar_card2').innerText = ""
      document.getElementById('inspection_report').value = ""
      document.getElementById('a_inspection_report2').innerText = ""

      // product names
      products = JSON.parse(localStorage.getItem('products'));
      element = document.getElementById('product_name')
      element.innerHTML = ''
      newoption = document.createElement("option");
      newoption.value = ''
      newoption.innerHTML = '-- select product --'
      element.options.add(newoption);
      products.forEach(item => {
         var newoption = document.createElement("option");
         newoption.value = item.name
         newoption.innerHTML = item.name
         element.options.add(newoption);
      })

      // insurance_company
      insurers = JSON.parse(localStorage.getItem('insurers'));
      element = document.getElementById('insurer_name')
      element.innerHTML = ''
      newoption = document.createElement("option");
      newoption.value = ''
      newoption.innerHTML = '-- select insurer --'
      element.options.add(newoption);
      insurers.forEach(item => {
         var newoption = document.createElement("option");
         newoption.value = item.comp_name
         newoption.innerHTML = item.comp_name
         element.options.add(newoption);
      })

      // service providers
      sps = JSON.parse(localStorage.getItem('sps'));
      element = document.getElementById('sps_name')
      element.innerHTML = ''
      newoption = document.createElement("option");
      newoption.value = ''
      newoption.innerHTML = '-- select branch --'
      element.options.add(newoption);
      sps.forEach(item => {
         var newoption = document.createElement("option");
         newoption.value = item.full_name
         newoption.innerHTML = item.full_name
         element.options.add(newoption);
      })

      // broker code    
      bc = JSON.parse(localStorage.getItem('bc'));
      element = document.getElementById('sp_code')
      element.innerHTML = ''
      newoption = document.createElement("option");
      newoption.value = ''
      newoption.innerHTML = '-- select code --'
      element.options.add(newoption);
      bc.forEach(item => {
         var newoption = document.createElement("option");
         newoption.value = item.code
         newoption.innerHTML = item.code
         element.options.add(newoption);
      })

   }


   // Tables function
   function GeneratePolicyTable(records) {

      document.getElementById('page_heading').innerHTML = 'Policy List'

      tableRows = ''
      document.getElementById('tbdy').innerHTML = ''

      if (records.length === 0) {
         showNotification('❌ ' + 'NO POLICIES!');
         return
      }

      // table header
      table_header = `
      <td class="sorting thShow p-4 pr-5" style="font-weight: bold" >  sr. no. </td>
      <td class="sorting thShow p-4 pr-5" style="font-weight: bold" >  proposal No. </td>
      <td class="sorting thShow p-4 pr-5" style="font-weight: bold" >  Policy No. </td>
      <td class="sorting thShow p-4 pr-5" style="font-weight: bold" >  Customer Name </td>
      <td class="sorting thShow p-4 pr-5" style="font-weight: bold" >  Insurer Name </td>
      <td class="sorting thShow p-4 pr-5" style="font-weight: bold" >  Service Provider </td>
      <td class="sorting thShow p-4 pr-5" style="font-weight: bold" >  Broker Code </td>
      <td class="sorting thShow p-4 pr-5" style="font-weight: bold" >  Product Name </td>
      <td class="sorting thShow p-4 pr-5" style="font-weight: bold" >  Registration No. </td>
      <td class="sorting thShow p-4 pr-5" style="font-weight: bold" >  RTO State </td>
      <td class="sorting thShow p-4 pr-5" style="font-weight: bold" >  RTO City </td>
      <td class="sorting thShow p-4 pr-5" style="font-weight: bold" >  Vehicle Catagory  </td>
      <td class="sorting thShow p-4 pr-5" style="font-weight: bold" >  Vehicle Makeby  </td>
      <td class="sorting thShow p-4 pr-5" style="font-weight: bold" >  Vehicle Model  </td>
      <td class="sorting thShow p-4 pr-5" style="font-weight: bold" >  Vehicle Fuel Type </td>
      <td class="sorting thShow p-4 pr-5" style="font-weight: bold" >  mfg. year </td>
      <td class="sorting thShow p-4 pr-5" style="font-weight: bold" >  Addon </td>
      <td class="sorting thShow p-4 pr-5" style="font-weight: bold" >  NCB </td>
      <td class="sorting thShow p-4 pr-5" style="font-weight: bold" >  Cubic Capacity </td>
      <td class="sorting thShow p-4 pr-5" style="font-weight: bold" >  Coverage Type </td>
      <td class="sorting thShow p-4 pr-5" style="font-weight: bold" >  Seating Capacity </td>
      <td class="sorting thShow p-4 pr-5" style="font-weight: bold" >  GVW </td>
      <td class="sorting thShow p-4 pr-5" style="font-weight: bold" >  Policy Type </td>
      <td class="sorting thShow p-4 pr-5" style="font-weight: bold" >  CPA </td>
      <td class="sorting thShow p-4 pr-5" style="font-weight: bold" >  Risk Start Date </td>
      <td class="sorting thShow p-4 pr-5" style="font-weight: bold" >  Risk End Date </td>
      <td class="sorting thShow p-4 pr-5" style="font-weight: bold" >  Issue Date </td>
      <td class="sorting thShow p-4 pr-5" style="font-weight: bold" >  Insured Age </td>
      <td class="sorting thShow p-4 pr-5" style="font-weight: bold" >  Policy Term </td>
      <td class="sorting thShow p-4 pr-5" style="font-weight: bold" >  POS </td>
      <td class="sorting thShow p-4 pr-5" style="font-weight: bold" >  BQP </td>
      <td class="sorting thShow p-4 pr-5" style="font-weight: bold" >  Employee </td>
      <td class="sorting thShow p-4 pr-5" style="font-weight: bold" >  Remark </td>
      <td class="sorting thShow p-4 pr-5" style="font-weight: bold" >  OD </td>
      <td class="sorting thShow p-4 pr-5" style="font-weight: bold" >  TP </td>
      <td class="sorting thShow p-4 pr-5" style="font-weight: bold" >  NET </td>
      <td class="sorting thShow p-4 pr-5" style="font-weight: bold" >  GST 18% </td>
      <td class="sorting thShow p-4 pr-5" style="font-weight: bold" >  GST 12% </td>
      <td class="sorting thShow p-4 pr-5" style="font-weight: bold" >  Total </td>
      <td class="sorting thShow p-4 pr-5" style="font-weight: bold" >  Payment Mode </td>

      <td class="sorting thShow p-4 pr-5" style="font-weight: bold" >  proposal </td>
      <td class="sorting thShow p-4 pr-5" style="font-weight: bold" >  Mandate </td>
      <td class="sorting thShow p-4 pr-5" style="font-weight: bold" >  Policy </td>
      <td class="sorting thShow p-4 pr-5" style="font-weight: bold" >  Previous Policy </td>
      <td class="sorting thShow p-4 pr-5" style="font-weight: bold" >  Pan Card </td>
      <td class="sorting thShow p-4 pr-5" style="font-weight: bold" >  Aadhar Card </td>
      <td class="sorting thShow p-4 pr-5" style="font-weight: bold" >  Vehicle RC </td>
      <td class="sorting thShow p-4 pr-5" style="font-weight: bold" >  Inspection Report </td>
      <td class="text-center sorting thShow p-4 pr-5" style="font-weight: bold" >  Status </td>
      <td class="sorting thShow p-4 pr-5" style="font-weight: bold" >  Action </td>

   </tr>`;

      document.getElementById('tbdy_head').innerHTML = table_header;

      for (var i = 0; i < records.length; i++) {

         record = records[i]

         recordHtml = `<tr class="policy-row" onclick="SelectRow(this)" >
            <td class="text-center w-10pc nowrap p-2" >  ${i + 1} </td> 
            <td class="p-2" >  ${record.proposal_no} </td>
            <td class="p-2" >  <a href="#" class="tile tile-img" onclick="Edit_Motor_Policy('${record.policyid}')" ><i class="far fa-file-pdf text-danger mt-1"></i></a> <a onclick="Edit_Motor_Policy('${record.policyid}')" href="#" class=""> ${record.policy_no}</a> </td>
            <td class="p-2">  ${record.customer_name}  </td> 
            <td class="p-2" >  ${record.insurance_company} </td>
            <td  class="p-2" > ${record.sp_name} </td> 
            <td  class="p-2" > ${record.sp_brokercode} </td>
            <td  class="p-2" > ${record.product_name} </td>
            <td class="p-2" > ${record.registration_no} </td>
            <td class="p-2" > ${record.rto_state} </td>
            <td class="p-2" > ${record.rto_city} </td>
            <td class="p-2" > ${record.vehicle_catagory} </td>
            <td class="p-2" > ${record.vehicle_makeby} </td>
            <td class="p-2" > ${record.vehicle_model} </td>
            <td class="p-2" > ${record.vehicle_fuel_type} </td>
            <td class="p-2" > ${record.mfg_year} </td>

            <td class="p-2" >  ${record.addon} </td>
            <td class="p-2" > ${record.ncb} </td>
            <td class="p-2" >  ${record.cubic_capacity} </td>
            <td class="p-2" > ${record.coverage_type} </td>
            <td class="p-2" > ${record.seating_capacity} </td>
            <td class="p-2" > ${record.gvw} </td>
            <td class="p-2" > ${record.policy_type} </td>
            <td class="p-2" > ${record.cpa} </td>
            <td class="p-2" > ${record.risk_start_date} </td>
            <td class="p-2" > ${record.risk_end_date} </td>
            <td class="p-2" > ${record.issue_date} </td>

            <td class="p-2" > ${record.insured_age} </td>
            <td class="p-2" > ${record.policy_term} </td>
            <td class="p-2" > ${record.pos} </td>
            <td class="p-2" > ${record.bqp} </td>
            <td class="p-2" > ${record.employee} </td>
            <td class="p-2" > ${record.remark} </td>

            <td class="p-2" > ${record.OD_premium} </td>
            <td class="p-2" > ${record.TP_terrorism} </td>
            <td class="p-2" > ${record.net} </td>
            <td class="p-2" > ${record.gst_amount} </td>
            <td class="p-2" > ${record.gst_gcv_amount} </td>
            <td class="p-2" > ${record.total} </td>
            <td class="p-2" > ${record.payment_mode} </td>
         

            <td class="text-center p-2" > <a href="#" onclick="downloadFile('${record.proposal}')">${record.proposal}</a> </td>
            <td class="text-center p-2" > <a href="#" onclick="downloadFile('${record.mandate}')">${record.mandate}</a> </td>
            <td class="text-center p-2" > <a href="#" onclick="downloadFile('${record.policy}')">${record.policy}</a> </td>
            <td class="text-center p-2" > <a href="#" onclick="downloadFile('${record.previous_policy}')">${record.previous_policy}</a> </td>
            <td class="text-center p-2" > <a href="#" onclick="downloadFile('${record.pan_card}')">${record.pan_card}</a> </td>
            <td class="text-center p-2" > <a href="#" onclick="downloadFile('${record.aadhar_card}')">${record.aadhar_card}</a> </td>
            <td class="text-center p-2" > <a href="#" onclick="downloadFile('${record.vehicle_rc}')">${record.vehicle_rc}</a> </td>
            <td class="text-center p-2" > <a href="#" onclick="downloadFile('${record.inspection_report}')">${record.inspection_report}</a> </td>
            
            <td class="text-center w-10pc nowrap p-2" > <a href="#" class="badge badge-success" >${record.status}</a> </td>      
            
            <td class="p-2" >   
               <a onclick="Edit_Motor_Policy('${record.policyid}')" href="#" class="mr-1 mt-1 btn btn-sm btn-icon btn-secondary" name="Edit">
               <i class="fa fa-pencil-alt mt-2"></i>                                               
               </a>            
               <a onclick="Delete_Policy('${record.policyid}')" href="#" name="Remove" class="mr-1 mt-1 btn btn-sm btn-icon btn-secondary text-danger">
               <i class="far fa-trash-alt mt-2"></i>  </a>
            </td>
            </tr > `;

         tableRows += recordHtml;
      }

      showNotification('✅ TOTAL POLICIES: ' + records.length);
      document.getElementById('tbdy').innerHTML = tableRows;
      showNextRows(true)

   }

   function GeneratePospTable(records) {

      document.getElementById('page_heading').innerHTML = 'POS List'

      tableRows = ''
      document.getElementById('tbdy').innerHTML = ''

      if (records.length === 0) {
         showNotification('❌ ' + 'NO POSP!');
         return
      }

      // table header
      table_header = `
      <td  class="sorting thShow p-4 pr-5" style = "font-weight: bold" > sr.no. </td > 
      <td  class="sorting thShow p-4 pr-5" style="font-weight: bold" >  POSP CODE </td>            
      <td  class="sorting thShow p-4 pr-5" style="font-weight: bold" >  REG. CODE </td>
      <td  class="sorting thShow p-4 pr-5" style="font-weight: bold" >  POSP NAME </td>
      <td  class="sorting thShow p-4 pr-5" style="font-weight: bold" >  GENDER </td>
      <td  class="sorting thShow p-4 pr-5" style="font-weight: bold" >  EMAIL </td>
      <td  class="sorting thShow p-4 pr-5" style="font-weight: bold" >  MOBILE NO. </td>
      <td  class="sorting thShow p-4 pr-5" style="font-weight: bold" >  ADDREES </td>
      <td  class="sorting thShow p-4 pr-5" style="font-weight: bold" >  STATE </td>
      <td  class="sorting thShow p-4 pr-5" style="font-weight: bold" >  CITY </td>
      <td  class="sorting thShow p-4 pr-5" style="font-weight: bold" >  PINCODE </td>
      <td  class="sorting thShow p-4 pr-5" style="font-weight: bold" >  RURAL/URBAN	  </td>
      <td  class="sorting thShow p-4 pr-5" style="font-weight: bold" >  SLAB  </td>
      <td  class="sorting thShow p-4 pr-5" style="font-weight: bold" >  GSTIN  </td>
      <td  class="sorting thShow p-4 pr-5" style="font-weight: bold" >  BANK ACCOUNT NO	 </td>
      <td  class="sorting thShow p-4 pr-5" style="font-weight: bold" >  IFSC CODE </td>
      <td  class="sorting thShow p-4 pr-5" style="font-weight: bold" >  BANK NAME </td>
      <td  class="sorting thShow p-4 pr-5" style="font-weight: bold" >  BASIC QQUALIFICATION	 </td>
      <td  class="sorting thShow p-4 pr-5" style="font-weight: bold" >  AADHAR CARD	 </td>
      <td  class="sorting thShow p-4 pr-5" style="font-weight: bold" >  PAN CARD	</td>
      <td  class="sorting thShow p-4 pr-5" style="font-weight: bold" >  TRAINING CERTIFICATE	 </td>
      <td  class="sorting thShow p-4 pr-5" style="font-weight: bold" >  APPOINTMENT CERTIFICATE	 </td>
      <td  class="sorting thShow p-4 pr-5" style="font-weight: bold" >  AGREEMENT </td>
      <td  class="sorting thShow p-4 pr-5" style="font-weight: bold" >  BANK DETAILS </td>
      <td  class="sorting thShow p-4 pr-5" style="font-weight: bold" >  LOGIN ID </td>
      <td  class="sorting thShow p-4 pr-5" style="font-weight: bold" >  CREATED BY </td>
       
      <td  class="text-center sorting thShow p-4 pr-5" style="font-weight: bold" >  Status </td>           
      <td  class="text-center sorting thShow p-4 pr-5" style="font-weight: bold" >  Action </td>              
      
      </tr > `;

      document.getElementById('tbdy_head').innerHTML = table_header;

      for (var i = 0; i < records.length; i++) {

         record = records[i]

         recordHtml = `<tr class="policy-row" onclick="SelectRow(this)" >
         <td class="text-center w-10pc nowrap p-2" >  ${i + 1} </td> 
         <td class="p-2" >  ${record.posp_code} </td>
        <td class="p-2" >  <a href="#" class="tile tile-img" onclick="Edit_Posp('${record.login_id}')" ><i class="far fa-file-pdf text-danger mt-1"></i></a> <a onclick="Edit_Posp('${record.login_id}')" href="#" class="" > ${record.registration_code}</a> </td>
        <td class="p-2" >  ${record.full_name}  </td> 
        <td class="p-2" >  ${record.gender} </td>
        <td class="p-2" > ${record.email_id} </td> 
        <td class="p-2" > ${record.mob_no} </td>
        <td class="p-2" > ${record.address} </td>
        <td class="p-2" > ${record.state} </td>
        <td class="p-2" > ${record.city} </td>
        <td class="p-2" > ${record.pincode} </td>
        <td class="p-2" > ${record.rural_urban} </td>
        <td class="p-2" > ${record.slab} </td>
        <td class="p-2" > ${record.GSTIN} </td>
        <td class="p-2" > ${record.account_no} </td>
        <td class="p-2" > ${record.ifsc_code} </td>
        <td class="p-2" >  ${record.bank_name} </td>
          
         <td class="p-2 text-center" > <a href="#" onclick="downloadFile('${record.basic_qualification}')">${record.basic_qualification}</a> </td>
         <td class="p-2 text-center" > <a href="#" onclick="downloadFile('${record.aadhar_card}')">${record.aadhar_card}</a> </td>
         <td class="p-2 text-center" > <a href="#" onclick="downloadFile('${record.pan_card}')">${record.pan_card}</a> </td>
         <td class="p-2 text-center" > <a href="#" onclick="downloadFile('${record.training_certificate}')">${record.training_certificate}</a> </td>
         <td class="p-2 text-center" > <a href="#" onclick="downloadFile('${record.appointment_certificate}')">${record.appointment_certificate}</a> </td>
         <td class="p-2 text-center" > <a href="#" onclick="downloadFile('${record.agreement_certificate}')">${record.agreement_certificate}</a> </td>
         <td class="p-2 text-center" > <a href="#" onclick="downloadFile('${record.bank_details}')">${record.bank_details}</a> </td>
         
        <td class="p-2" >  ${record.login_id} </td>
        <td class="p-2" > ${record.created_by} </td>
         <td class="p-2 text-center w-10pc nowrap" > <a href="#" class="badge badge-success" >${record.status}</a> </td>      
         
        <td class="p-2" >    
            <a  href="#" class="mr-1 mt-1 btn btn-sm btn-icon btn-secondary" name="Edit">
            <i class="fa fa-pencil-alt mt-2"></i>                                               
            </a>            
            <a onclick="Delete_Posp('${record.login_id}')"  href="#" name="Remove" class="mr-1 mt-1 btn btn-sm btn-icon btn-secondary text-danger">
            <i class="far fa-trash-alt mt-2"></i>  </a>
         </td>
         </tr>`;

         tableRows += recordHtml;
      }

      showNotification('✅ TOTAL POSP: ' + records.length);
      document.getElementById('tbdy').innerHTML = tableRows;
      showNextRows(true)
   }

   function GenerateInsurerTable(records) {

      document.getElementById('page_heading').innerHTML = 'Insurer List'

      tableRows = ''
      document.getElementById('tbdy').innerHTML = ''

      if (records.length === 0) {
         showNotification('❌ ' + 'NO INSURER!');
         return
      }

      // table header
      table_header = `
      <td  class="text-center sorting thShow p-4 pr-5" style = "font-weight: bold" > sr.no. </td > 
      <td  class="sorting thShow p-4 pr-5" style="font-weight: bold" >  INSURER NAME </td>   
      <td  class="text-center sorting thShow p-4 pr-5" style="font-weight: bold" >  Status </td>
      <td  class="text-center sorting thShow p-4 pr-5" style=" font-weight: bold" >  Action </td>     
               
      </tr> `;

      document.getElementById('tbdy_head').innerHTML = table_header;

      for (var i = 0; i < records.length; i++) {

         record = records[i]

         recordHtml = `<tr class="policy-row" onclick="SelectRow(this)" >
         <td class="text-center w-10pc nowrap p-2" >  ${i + 1} </td> 
         <td class="p-2" >  ${record.comp_name} </td>
         <td class="text-center w-10pc nowrap p-2" > <a href="#" class="badge badge-success" >${record.status}</a> </td>

         <td class="text-center w-10pc nowrap p-2" >    
            <a href="#" class="mr-1 mt-1 btn btn-sm btn-icon btn-secondary" name="Edit">
            <i class="fa fa-pencil-alt mt-2"></i>                                               
            </a>            
            <a onclick="alert('Do you want to delete?')" href="#" name="Remove" class="mr-1 mt-1 btn btn-sm btn-icon btn-secondary text-danger">
            <i class="far fa-trash-alt mt-2"></i>  </a>
         </td>
         </tr > `;

         tableRows += recordHtml;
      }

      showNotification('✅ TOTAL INSURERS: ' + records.length);
      document.getElementById('tbdy').innerHTML = tableRows;
      showNextRows(true)
   }

   function GenerateSPTable(records) {

      document.getElementById('page_heading').innerHTML = 'Service Provider List'

      tableRows = ''
      document.getElementById('tbdy').innerHTML = ''

      if (records.length === 0) {
         showNotification('❌ ' + 'NO SERVICE PROVIDER!');
         return
      }

      // table header
      table_header = `
      <td  class="sorting thShow p-4 pr-5" style = "font-weight: bold" > sr.no. </td > 
      <td  class="sorting thShow p-4 pr-5" style="font-weight: bold" >  name </td>            
      <td  class="sorting thShow p-4 pr-5" style="font-weight: bold" >  mobile no </td>
      <td  class="sorting thShow p-4 pr-5" style="font-weight: bold" >  email  </td>

      <td  class="text-center sorting thShow p-4 pr-5" style="font-weight: bold" >  Status </td>           
      <td  class="text-center sorting thShow p-4 pr-5" style="font-weight: bold" >  Action </td>              

      </tr>`;

      document.getElementById('tbdy_head').innerHTML = table_header;

      for (var i = 0; i < records.length; i++) {

         record = records[i]

         recordHtml = `<tr class="policy-row" onclick="SelectRow(this)" >
         <td class="text-center w-10pc nowrap p-2" >  ${i + 1} </td> 
         <td class="p-2" >  ${record.full_name} </td>
         <td class="p-2" >  ${record.mob_no}  </td> 
         <td class="p-2" >  ${record.email_id} </td>     

         <td class="text-center w-10pc nowrap p-2" > <a href="#" class="badge badge-success" >${record.status}</a> </td>      
         
         <td class="text-center w-10pc nowrap p-2" >    
            <a  href="#" class="mr-1 mt-1 btn btn-sm btn-icon btn-secondary" name="Edit">
            <i class="fa fa-pencil-alt mt-2"></i>                                               
            </a>            
            <a onclick="alert('Do you want to delete?')" href="#" name="Remove" class="mr-1 mt-1 btn btn-sm btn-icon btn-secondary text-danger">
            <i class="far fa-trash-alt mt-2"></i>  </a>
         </td>
         </tr> `;

         tableRows += recordHtml;
      }

      showNotification('✅ TOTAL SERVICE PROVIDERS: ' + records.length);
      document.getElementById('tbdy').innerHTML = tableRows;
      showNextRows(true)
   }

   function GenerateProductTable(records) {

      document.getElementById('page_heading').innerHTML = 'Product List'

      tableRows = ''
      document.getElementById('tbdy').innerHTML = ''

      if (records.length === 0) {
         showNotification('❌ ' + 'NO PRODUCTS!');
         return
      }

      // table header
      table_header = `
      <td  class="text-center sorting thShow p-4 pr-5" style = "font-weight: bold" > sr.no. </td> 
      <td  class="sorting thShow p-4 pr-5" style="font-weight: bold" >  product name </td>       
      <td  class="text-center sorting thShow p-4 pr-5" style="font-weight: bold" >  Status </td>
      <td  class="text-center sorting thShow p-4 pr-5" style="font-weight: bold" >  Action </td>     
      </tr>`;

      document.getElementById('tbdy_head').innerHTML = table_header;

      for (var i = 0; i < records.length; i++) {

         record = records[i]

         recordHtml = `<tr class="policy-row" onclick="SelectRow(this)">
         <td class="text-center w-10pc nowrap" p-2 >  ${i + 1} </td> 
         <td class="p-2">  ${record.name} </td>   
         <td class="text-center w-10pc nowrap p-2" > <a href="#" class="badge badge-success" >${record.status}</a> </td>      

         <td class="text-center w-10pc nowrap p-2" >    
            <a  href="#" class="mr-1 mt-1 btn btn-sm btn-icon btn-secondary" name="Edit">
            <i class="fa fa-pencil-alt mt-2"></i>                                               
            </a>            
            <a onclick="alert('Do you want to delete?')" href="#" name="Remove" class="mr-1 mt-1 btn btn-sm btn-icon btn-secondary text-danger">
            <i class="far fa-trash-alt mt-2"></i>  </a>
         </td>
         </tr>`;

         tableRows += recordHtml;
      }

      showNotification('✅ TOTAL PRODUCTS: ' + records.length);
      document.getElementById('tbdy').innerHTML = tableRows;
      showNextRows(true)
   }

   function GenerateVehicleCategoryTable(records) {

      document.getElementById('page_heading').innerHTML = 'Vehicle Category List'

      tableRows = ''
      document.getElementById('tbdy').innerHTML = ''

      if (records.length === 0) {
         showNotification('❌ ' + 'NO VEHICLE CATEGORY!');
         return
      }

      // table header
      table_header = `
      <td  class="sorting thShow p-4 pr-5" style = "font-weight: bold" > sr.no. </td> 
      <td  class="sorting thShow p-4 pr-5" style="font-weight: bold" >  CATEGORY </td>            
      <td  class="sorting thShow p-4 pr-5" style="font-weight: bold" >  CREATED BY </td>     
      <td  class="text-center sorting thShow p-4 pr-5" style="font-weight: bold" >  Status </td>           
      <td  class="sorting thShow p-4 pr-5" style="font-weight: bold" >  Action </td>              
      
      </tr>`;

      document.getElementById('tbdy_head').innerHTML = table_header;

      for (var i = 0; i < records.length; i++) {

         record = records[i]

         recordHtml = `<tr class="policy-row" onclick="SelectRow(this)" >
      <td class="text-center w-10pc nowrap p-2" >  ${i + 1} </td> 
      <td class="p-2" >  ${record.category} </td>
      <td class="p-2">  ${record.created_by}  </td>      
      <td class="text-center w-10pc nowrap p-2" > <a href="#" class="badge badge-success" >${record.status}</a> </td>      
      
      <td class="p-2">   
         <a onclick=" href="#" class="mr-1 mt-1 btn btn-sm btn-icon btn-secondary" name="Edit">
         <i class="fa fa-pencil-alt mt-2"></i>                                               
         </a>            
         <a onclick="alert('Do you want to delete?')" href="#" name="Remove" class="mr-1 mt-1 btn btn-sm btn-icon btn-secondary text-danger">
         <i class="far fa-trash-alt mt-2"></i>  </a>
      </td>
      </tr>`;

         tableRows += recordHtml;
      }

      showNotification('✅ TOTAL CATEGORY: ' + records.length);
      document.getElementById('tbdy').innerHTML = tableRows;
      showNextRows(true)

   }

   function GenerateVehicleMakeTable(records) {

      document.getElementById('page_heading').innerHTML = 'Vehicle Make List'

      tableRows = ''
      document.getElementById('tbdy').innerHTML = ''

      if (records.length === 0) {
         showNotification('❌ ' + 'NO VEHICLE MAKES!');
         return
      }

      // table header
      table_header = `
      <td  class="sorting thShow p-4 pr-5" style = "font-weight: bold" > sr.no. </td> 
      <td  class="sorting thShow p-4 pr-5" style="font-weight: bold" >  MAKE </td>            
      <td  class="sorting thShow p-4 pr-5" style="font-weight: bold" >  CREATED BY </td>     
      <td  class="text-center sorting thShow p-4 pr-5" style="font-weight: bold">  Status </td>           
      <td  class="sorting thShow p-4 pr-5" style="font-weight: bold" >  Action </td>              

      </tr>`;

      document.getElementById('tbdy_head').innerHTML = table_header;

      for (var i = 0; i < records.length; i++) {

         record = records[i]

         recordHtml = `<tr class="policy-row" onclick="SelectRow(this)">
         <td class="text-center w-10pc nowrap p-2" >  ${i + 1} </td> 
         <td class="p-2" >  ${record.make} </td>
         <td class="p-2">  ${record.created_by}  </td>      
         <td class="text-center w-10pc nowrap p-2" > <a href="#" class="badge badge-success" >${record.status}</a> </td>      

         <td class="p-2" >   
            <a onclick=" href="#" class="mr-1 mt-1 btn btn-sm btn-icon btn-secondary" name="Edit">
            <i class="fa fa-pencil-alt mt-2"></i>                                               
            </a>            
            <a onclick="alert('Do you want to delete?')" href="#" name="Remove" class="mr-1 mt-1 btn btn-sm btn-icon btn-secondary text-danger">
            <i class="far fa-trash-alt mt-2"></i>  </a>
         </td>
         </tr>`;

         tableRows += recordHtml;
      }

      showNotification('✅ TOTAL VEHICLE MAKES: ' + records.length);
      document.getElementById('tbdy').innerHTML = tableRows;
      showNextRows(true)

   }

   function GenerateVehicleModelTable(records) {

      document.getElementById('page_heading').innerHTML = 'Vehicle Model List'

      tableRows = ''
      document.getElementById('tbdy').innerHTML = ''

      if (records.length === 0) {
         showNotification('❌ ' + 'NO VEHICLE MODELS!');
         return
      }

      // table header
      table_header = `
      <td  class="sorting thShow p-4 pr-5" style = "font-weight: bold" > sr.no. </td> 
      <td  class="sorting thShow p-4 pr-5" style="font-weight: bold" >  MAKE </td>            
      <td  class="sorting thShow p-4 pr-5" style="font-weight: bold" >  CREATED BY </td>     
      <td  class="text-center sorting thShow p-4 pr-5" style="font-weight: bold" >  Status </td>           
      <td  class="sorting thShow p-4 pr-5" style="font-weight: bold" >  Action </td>              

      </tr>`;

      document.getElementById('tbdy_head').innerHTML = table_header;

      for (var i = 0; i < records.length; i++) {

         record = records[i]

         recordHtml = `<tr class="policy-row" onclick = "SelectRow(this)" >
         <td class="text-center w-10pc nowrap p-2" >  ${i + 1} </td> 
         <td class="p-2" >  ${record.model} </td>
         <td class="p-2">  ${record.created_by}  </td>      
         <td class="text-center w-10pc nowrap p-2" > <a href="#" class="badge badge-success" >${record.status}</a> </td>      

         <td class="p-2" >   
            <a onclick=" href="#" class="mr-1 mt-1 btn btn-sm btn-icon btn-secondary" name="Edit">
            <i class="fa fa-pencil-alt mt-2"></i>                                               
            </a>            
            <a onclick="alert('Do you want to delete?')" href="#" name="Remove" class="mr-1 mt-1 btn btn-sm btn-icon btn-secondary text-danger">
            <i class="far fa-trash-alt mt-2"></i>  </a>
         </td>
         </tr>`;

         tableRows += recordHtml;
      }

      showNotification('✅ TOTAL VEHICLE MODELS: ' + records.length);
      document.getElementById('tbdy').innerHTML = tableRows;
      showNextRows(true)

   }

   function GenerateStaffTable(records) {

      document.getElementById('page_heading').innerHTML = 'Staff List'

      tableRows = ''
      document.getElementById('tbdy').innerHTML = ''

      if (records.length === 0) {
         showNotification('❌ ' + 'NO STAFF!');
         return
      }

      // table header
      table_header = `
      <td  class="text-center sorting thShow p-4 pr-5" style = "font-weight: bold" > sr.no. </td>      
      <td  class="sorting thShow p-4 pr-5" style="font-weight: bold" >  STAFF NAME </td>      
      <td  class="sorting thShow p-4 pr-5" style="font-weight: bold" >  LOGIN ID </td>      
      <td  class="text-center sorting thShow p-4 pr-5" style="font-weight: bold" >  Status </td>           
      <td  class="text-center sorting thShow p-4 pr-5" style="font-weight: bold" >  Action </td>   
      </tr>`;

      document.getElementById('tbdy_head').innerHTML = table_header;

      for (var i = 0; i < records.length; i++) {

         record = records[i]

         recordHtml = `<tr class="policy-row" onclick = "SelectRow(this)">
         <td class="text-center w-10pc nowrap p-2" >  ${i + 1} </td> 
         <td class="p-2" >  ${record.staffname} </td>
         <td class="p-2" >  ${record.login_id} </td>
               
         <td class="p-2 text-center w-10pc nowrap" > <a href="#" class="badge badge-success" >${record.status}</a> </td>      
         
         <td class="p-2 text-center w-10pc nowrap" >    
            <a href="#" class="mr-1 mt-1 btn btn-sm btn-icon btn-secondary" name="Edit">
            <i class="fa fa-pencil-alt mt-2"></i>                                               
            </a>            
            <a onclick="alert('Do you want to delete?')" href="#" name="Remove" class="mr-1 mt-1 btn btn-sm btn-icon btn-secondary text-danger">
            <i class="far fa-trash-alt mt-2"></i>  </a>
         </td>
         </tr>`;

         tableRows += recordHtml;
      }

      showNotification('✅ TOTAL STAFF: ' + records.length);
      document.getElementById('tbdy').innerHTML = tableRows;
      showNextRows(true)
   }

   function SelectRow(row) {

      SelectedRow = row.cells[0].textContent;
      UnSelectRow();
      row.style.background = "darkgray"
      row.style.color = 'black'
      row.classList.toggle("selectedRow");

      var anchorTag = row.getElementsByTagName('a'); // Replace 'a' with the appropriate tag name     

      if (anchorTag) {
         for (const iterator of anchorTag) {

            // iterator.style.color = "white"
         }
      }
   }

   function UnSelectRow() {
      let table = document.getElementById("tblInsurance");
      let rows = table.rows;
      for (let i = 0; i < rows.length; i++) {
         // to avoid checked 
         try {
            is_checked = document.getElementById(`chkblkrm${i} `).checked
            if (is_checked) {
               continue;
            }
         } catch { }

         // rows[i].style.background = "#FFFFFF";
         rows[i].style.background = "";
         // rows[i].style.color = "black";

         var anchorTag = rows[i].getElementsByTagName('a'); // Replace 'a' with the appropriate tag name     

         if (anchorTag) {
            for (const iterator of anchorTag) {
               // iterator.style.color = "black"
            }
         }
      }
   }

   function Edit_Posp(login_id) {

      ShowPage('new_posp')
      document.getElementById('posp_title').innerText = "Update POSP"
      document.getElementById('btn_save_posp').innerText = "UPDATE"

      // find pos from storage
      data = JSON.parse(localStorage.getItem('posp'));
      if (data != null) {

         data.find(item => {

            if (item.login_id == login_id) {
               // console.log(item.policyid);
               Load_Posp_Edit_Config(item);
               return
            }
         })
      }


   }

   // utilities function
   function Edit_Motor_Policy(params) {

      ShowPage('motor_entry')

      document.getElementById('policy_title').innerText = "Update Motor Policy"
      document.getElementById('btnGenerate_Policy').innerText = "UPDATE"

      // find policy from storage
      data = JSON.parse(localStorage.getItem('entry_list'));
      if (data != null) {

         data.find(item => {

            if (item.policyid == params) {
               // console.log(item.policyid);
               Load_Motor_Edit_Config(item);
               return
            }
         })
      }

      // or find policy from fetchList
      fetchList.find(item => {
         if (item.policyid == params) {
            // console.log(item.policyid);
            Load_Motor_Edit_Config(item);
            return
         }
      })
   }

   

   function Load_NonMotor_Edit_Config(data) {

      document.getElementById('policy_title_non_motor').innerText = "Update Non Motor Policy"
      document.getElementById('btnGenerate_Policy_nonmotor').innerText = "UPDATE"

      policyid = null
      policyid = data.policyid

      // product_name    
      element = document.getElementById('product_name')
      for (let index = 0; index < element.options.length; index++) {
         ele = element[index]
         if (ele.value == data.product_name) {
            element.options[index].selected = true;
            break
         }
      }

      // policy_type2    
      element = document.getElementById('policy_type2')
      for (let index = 0; index < element.options.length; index++) {
         ele = element[index]
         if (ele.value == data.policy_type) {
            element.options[index].selected = true;
            break
         }
      }

      document.getElementById('proposal_no2').value = data.proposal_no
      document.getElementById('policy_no2').value = data.policy_no
      document.getElementById('customer_name2').value = data.customer_name

      // insurance_company    
      element = document.getElementById('insurer_name')
      for (let index = 0; index < element.options.length; index++) {
         ele = element[index]
         if (ele.value == data.insurance_company) {
            element.options[index].selected = true;
            break
         }
      }

      // sp_name    
      element = document.getElementById('sps_name')
      for (let index = 0; index < element.options.length; index++) {
         ele = element[index]
         if (ele.value == data.sp_name) {
            element.options[index].selected = true;
            break
         }
      }

      // sp_brokercode    
      element = document.getElementById('sp_code')
      for (let index = 0; index < element.options.length; index++) {
         ele = element[index]
         if (ele.value == data.sp_brokercode) {
            element.options[index].selected = true;
            break
         }
      }

      document.getElementById('risk_start_date2').value = data.risk_start_date
      document.getElementById('risk_end_date2').value = data.risk_end_date
      document.getElementById('issue_date2').value = data.issue_date
      document.getElementById('pos_product').value = data.pos
      document.getElementById('product_employee').value = data.employee

      // premium value
      document.getElementById('od_product').value = data.OD_premium
      document.getElementById('tpt_product').value = data.TP_terrorism
      document.getElementById('net_product').value = data.net
      document.getElementById('gst_product').value = data.gst_amount
      document.getElementById('total_product').value = data.total

      //  attachments
      document.getElementById('a_proposal2').innerText = data.proposal;
      document.getElementById('a_mandate2').innerText = data.mandate;
      document.getElementById('a_policy2').innerText = data.policy;
      document.getElementById('a_previous_policy2').innerText = data.previous_policy;
      document.getElementById('a_pan_card2').innerText = data.pan_card;
      document.getElementById('a_aadhar_card2').innerText = data.aadhar_card;
      document.getElementById('a_inspection_report2').innerText = data.inspection_report;

      document.getElementById('remark2').value = data.remark

      // policy_term    
      element = document.getElementById('policy_term2')
      for (let index = 0; index < element.options.length; index++) {
         ele = element[index]
         if (ele.value == data.policy_term) {
            element.options[index].selected = true;
            break
         }
      }

      // bqp    
      element = document.getElementById('bqp2')
      for (let index = 0; index < element.options.length; index++) {
         ele = element[index]
         if (ele.value == data.bqp) {
            element.options[index].selected = true;
            break
         }
      }

      // payment_mode    
      element = document.getElementById('payment_mode2')
      for (let index = 0; index < element.options.length; index++) {
         ele = element[index]
         if (ele.value == data.payment_mode) {
            element.options[index].selected = true;
            break
         }
      }


   }


   var policyid = null  // used for updating policy, bcoz now dont need to filter in backend

   function Load_Motor_Edit_Config(data) {

      reg_no = data.registration_no

      console.log(reg_no);

      if (reg_no == "") {
         console.log('non motor');

         ShowPage('non_motor_entry')

         Load_NonMotor_Edit_Config(data)

      }
      else {
         console.log(data.vehicle_catagory);

         policyid = null
         policyid = data.policyid

         // vehicle category     
         element = document.getElementById('vehicle_catagory')
         for (let index = 0; index < element.options.length; index++) {
            ele = element[index]
            if (ele.value == data.vehicle_catagory) {
               element.options[index].selected = true;
               break
            }
         }

         setCategoryOnChange()

         // vehicle make     
         element = document.getElementById('vmake')
         for (let index = 0; index < element.options.length; index++) {
            ele = element[index]
            if (ele.value == data.vehicle_makeby) {
               element.options[index].selected = true;
               break
            }
         }

         // vehicle model     
         element = document.getElementById('vmodel')
         for (let index = 0; index < element.options.length; index++) {
            ele = element[index]
            if (ele.value == data.vehicle_model) {
               element.options[index].selected = true;
               break
            }
         }

         // general things, proposal_no policy no customer name
         document.getElementById('proposal_no').value = data.proposal_no
         document.getElementById('policy_no').value = data.policy_no
         document.getElementById('customer_name').value = data.customer_name
         document.getElementById('registration_no').value = data.registration_no
         document.getElementById('rto_city').value = data.rto_city
         document.getElementById('rto_city').value = data.rto_city
         document.getElementById('pos').value = data.pos
         document.getElementById('employee').value = data.employee
         document.getElementById('risk_start_date').value = data.risk_start_date
         document.getElementById('risk_end_date').value = data.risk_end_date
         document.getElementById('issue_date').value = data.issue_date
         document.getElementById('insured_age').value = data.insured_age

         // premium value
         document.getElementById('od').value = data.OD_premium
         document.getElementById('tpt').value = data.TP_terrorism
         document.getElementById('net').value = data.net
         document.getElementById('gst').value = data.gst_amount
         document.getElementById('gstt').value = data.gst_gcv_amount
         document.getElementById('totalnet').value = data.total

         //  attachments
         document.getElementById('a_proposal').innerText = data.proposal;
         document.getElementById('a_mandate').innerText = data.mandate;
         document.getElementById('a_policy').innerText = data.policy;
         document.getElementById('a_previous_policy').innerText = data.previous_policy;
         document.getElementById('a_pan_card').innerText = data.pan_card;
         document.getElementById('a_aadhar_card').innerText = data.aadhar_card;
         document.getElementById('a_vehicle_rc').innerText = data.vehicle_rc;
         document.getElementById('a_inspection_report').innerText = data.inspection_report;

         document.getElementById('remark').value = data.remark

         // insurance_company    
         element = document.getElementById('insurance_company')
         for (let index = 0; index < element.options.length; index++) {
            ele = element[index]
            if (ele.value == data.insurance_company) {
               element.options[index].selected = true;
               break
            }
         }

         // sp_name    
         element = document.getElementById('sp_name')
         for (let index = 0; index < element.options.length; index++) {
            ele = element[index]
            if (ele.value == data.sp_name) {
               element.options[index].selected = true;
               break
            }
         }

         // sp_brokercode    
         element = document.getElementById('sp_brokercode')
         for (let index = 0; index < element.options.length; index++) {
            ele = element[index]
            if (ele.value == data.sp_brokercode) {
               element.options[index].selected = true;
               break
            }
         }

         // rto_state    
         element = document.getElementById('rto_state')
         for (let index = 0; index < element.options.length; index++) {
            ele = element[index]
            if (ele.value == data.rto_state) {
               element.options[index].selected = true;
               break
            }
         }

         // vehicle_fuel_type    
         element = document.getElementById('vehicle_fuel_type')
         for (let index = 0; index < element.options.length; index++) {
            ele = element[index]
            if (ele.value == data.vehicle_fuel_type) {
               element.options[index].selected = true;
               break
            }
         }

         // mfg_year    
         element = document.getElementById('mfg_year')
         for (let index = 0; index < element.options.length; index++) {
            ele = element[index]
            if (ele.value == data.mfg_year) {
               element.options[index].selected = true;
               break
            }
         }

         // addon    
         element = document.getElementById('addon')
         for (let index = 0; index < element.options.length; index++) {
            ele = element[index]
            if (ele.value == data.addon) {
               element.options[index].selected = true;
               break
            }
         }

         // ncb    
         element = document.getElementById('ncb')
         for (let index = 0; index < element.options.length; index++) {
            ele = element[index]
            if (ele.value == data.ncb) {
               element.options[index].selected = true;
               break
            }
         }

         // cubic_capacity    
         element = document.getElementById('cubic_capacity')
         for (let index = 0; index < element.options.length; index++) {
            ele = element[index]
            if (ele.value == data.cubic_capacity) {
               element.options[index].selected = true;
               break
            }
         }

         // coverage_type    
         element = document.getElementById('coverage_type')
         for (let index = 0; index < element.options.length; index++) {
            ele = element[index]
            if (ele.value == data.coverage_type) {
               element.options[index].selected = true;
               break
            }
         }

         // seating_capacity    
         element = document.getElementById('seating_capacity')
         for (let index = 0; index < element.options.length; index++) {
            ele = element[index]
            if (ele.value == data.seating_capacity) {
               element.options[index].selected = true;
               break
            }
         }

         // gvw    
         element = document.getElementById('gvw')
         for (let index = 0; index < element.options.length; index++) {
            ele = element[index]
            if (ele.value == data.gvw) {
               element.options[index].selected = true;
               break
            }
         }

         // policy_type    
         element = document.getElementById('policy_type')
         for (let index = 0; index < element.options.length; index++) {
            ele = element[index]
            if (ele.value == data.policy_type) {
               element.options[index].selected = true;
               break
            }
         }

         // cpa    
         element = document.getElementById('cpa')
         for (let index = 0; index < element.options.length; index++) {
            ele = element[index]
            if (ele.value == data.cpa) {
               element.options[index].selected = true;
               break
            }
         }

         // policy_term    
         element = document.getElementById('policy_term')
         for (let index = 0; index < element.options.length; index++) {
            ele = element[index]
            if (ele.value == data.policy_term) {
               element.options[index].selected = true;
               break
            }
         }

         // bqp    
         element = document.getElementById('bqp')
         for (let index = 0; index < element.options.length; index++) {
            ele = element[index]
            if (ele.value == data.bqp) {
               element.options[index].selected = true;
               break
            }
         }

         // payment_mode    
         element = document.getElementById('payment_mode')
         for (let index = 0; index < element.options.length; index++) {
            ele = element[index]
            if (ele.value == data.payment_mode) {
               element.options[index].selected = true;
               break
            }
         }

      }

   }


   async function FetchMotorPolicyAsync() {
      try {
         // Create a Promise to wrap the $.ajax() call
         const response = await new Promise((resolve, reject) => {
            $.ajax({
               url: "{%url 'bima_policy:fetch_policyId'%}",
               dataType: 'json',
               success: function (response) {
                  resolve(response);
               },
               error: function (xhr, status, error) {
                  reject(error);
               }
            });
         });

         // Handle the successful response
         // console.log(response.data);
         localStorage.setItem('policy_edit_id', JSON.stringify(response.data));


      } catch (error) {
         // Handle errors
         console.error(error);
         alert(error.toString());
      }
   }


   function showNextRows(hideDefault) {

      event.preventDefault()

      var selectElement = document.getElementById("select_length");
      var selectedValue = selectElement.value;

      var rows = document.getElementsByClassName("policy-row");

      if (selectedValue == 0) {

         for (var i = 0; i < rows.length; i++) {
            rows[i].style.display = ""; // Show the row
         }
         return
      }

      rows = document.getElementsByClassName("policy-row");

      if (hideDefault) {
         for (var i = 0; i < rows.length; i++) {
            if (i < selectedValue) {
               rows[i].style.display = ""; // Show the row
               curIndex = i
            }
            else {
               rows[i].style.display = "none"; // Show the row
            }
         }
         if (rows.length === curIndex + 1)
            document.getElementById("nextButton").hidden = true;
         else
            document.getElementById("nextButton").hidden = false;
         return
      }

      from = curIndex;
      to = from + Number(selectedValue)

      for (var i = from; i <= to; i++) {
         if (rows[i]) {
            rows[i].style.display = ""; // Show the row
            curIndex = i
         }
         else {
            // console.log('no more rows to show');
            break
         }
      }

      $('html, body').animate({ scrollTop: $('#nextButton').offset().top }, 1);

      if (rows.length === curIndex + 1)
         document.getElementById("nextButton").hidden = true;
      else
         document.getElementById("nextButton").hidden = false;

   }

   function showMoreFilters() {

      if (document.getElementById('morefilters').hidden) {

         fetch_filter_data("filter_data")

         document.getElementById('morefilters').hidden = false
         document.getElementById('filter_type').selectedIndex = 0
         add_filter_type()

      }
      else {
         document.getElementById('morefilters').hidden = true
      }
   }

   function fetch_filter_data(data) {

      $.ajax({
         url: "{%url 'bima_policy:fetch_records'%}",
         data: { data: data },
         dataType: 'json',
         success: function (response) {
            // console.log(response.filter_data);
            localStorage.setItem('filter_data', JSON.stringify(response.filter_data));

            add_filter_type()
         },
         error: function (xhr, status, error) {
            console.error(error);
            alert(error.toString())
         }
      });
   }

   function filterFetchList() {

      filter_type = document.getElementById('filter_type').value
      filter_content = document.getElementById('filter_content')

      // console.log(filter_type);

      if (freezList.length > 0) {

         tempfilterList = []

         for (i = 1; i <= filter_content.options.length - 1; i++) {

            if (filter_content.options[i].selected == true) {
               tempfilterList.push(filter_content.options[i].value.trim())
            }
         }

         filterList = []

         if (filter_type == "pos") {

            for (const iterator of freezList) {

               pos = iterator.pos

               for (const tempItr of tempfilterList) {

                  poscode = tempItr.split('|')[0].trim()

                  if (poscode == pos) {
                     filterList.push(iterator)
                  }
               }
            }

            generateTableRowsAsync(filterList)
            return
         }

         if (filter_type == "insurance_company") {

            for (const iterator of freezList) {

               insurance_company = iterator.insurance_company

               for (const tempItr of tempfilterList) {

                  if (tempItr == insurance_company) {
                     filterList.push(iterator)
                     // console.log(tempItr);
                  }
               }

            }
            generateTableRowsAsync(filterList)
            return
         }

         if (filter_type == "vehicle_catagory") {

            for (const iterator of freezList) {

               vehicle_catagory = iterator.vehicle_catagory

               for (const tempItr of tempfilterList) {

                  if (tempItr == vehicle_catagory) {
                     filterList.push(iterator)
                     // console.log(tempItr);
                  }
               }

            }
            generateTableRowsAsync(filterList)
            return
         }

         if (filter_type == "vehicle_makeby") {
            for (const iterator of freezList) {
               vehicle_makeby = iterator.vehicle_makeby
               for (const tempItr of tempfilterList) {
                  if (tempItr == vehicle_makeby) {
                     filterList.push(iterator)
                  }
               }
            }
            generateTableRowsAsync(filterList)
            return
         }

         if (filter_type == "vehicle_model") {
            for (const iterator of freezList) {
               vehicle_model = iterator.vehicle_model
               for (const tempItr of tempfilterList) {
                  if (tempItr == vehicle_model) {
                     filterList.push(iterator)
                  }
               }
            }
            generateTableRowsAsync(filterList)
            return
         }

         if (filter_type == "vehicle_fuel_type") {
            for (const iterator of freezList) {
               vehicle_fuel_type = iterator.vehicle_fuel_type
               for (const tempItr of tempfilterList) {
                  if (tempItr == vehicle_fuel_type) {
                     filterList.push(iterator)
                  }
               }
            }
            generateTableRowsAsync(filterList)
            return
         }

         if (filter_type == "cubic_capacity") {
            for (const iterator of freezList) {
               cubic_capacity = iterator.cubic_capacity
               for (const tempItr of tempfilterList) {
                  if (tempItr == cubic_capacity) {
                     filterList.push(iterator)
                  }
               }
            }
            generateTableRowsAsync(filterList)
            return
         }

         if (filter_type == "seating_capacity") {
            for (const iterator of freezList) {
               seating_capacity = iterator.seating_capacity
               for (const tempItr of tempfilterList) {
                  if (tempItr == seating_capacity) {
                     filterList.push(iterator)
                  }
               }
            }
            generateTableRowsAsync(filterList)
            return
         }

         if (filter_type == "coverage_type") {
            for (const iterator of freezList) {
               coverage_type = iterator.coverage_type
               for (const tempItr of tempfilterList) {
                  if (tempItr == coverage_type) {
                     filterList.push(iterator)
                  }
               }
            }
            generateTableRowsAsync(filterList)
            return
         }

         if (filter_type == "gvw") {
            for (const iterator of freezList) {
               gvw = iterator.gvw
               for (const tempItr of tempfilterList) {
                  if (tempItr == gvw) {
                     filterList.push(iterator)
                  }
               }
            }
            generateTableRowsAsync(filterList)
            return
         }

         if (filter_type == "policy_type") {
            for (const iterator of freezList) {
               policy_type = iterator.policy_type
               for (const tempItr of tempfilterList) {
                  if (tempItr == policy_type) {
                     filterList.push(iterator)
                  }
               }
            }
            generateTableRowsAsync(filterList)
            return
         }

         if (filter_type == "addon") {
            for (const iterator of freezList) {
               addon = iterator.addon
               for (const tempItr of tempfilterList) {
                  if (tempItr == addon) {
                     filterList.push(iterator)
                  }
               }
            }
            generateTableRowsAsync(filterList)
            return
         }

         if (filter_type == "ncb") {
            for (const iterator of freezList) {
               ncb = iterator.ncb
               for (const tempItr of tempfilterList) {
                  if (tempItr == ncb) {
                     filterList.push(iterator)
                  }
               }
            }
            generateTableRowsAsync(filterList)
            return
         }

         if (filter_type == "cpa") {
            for (const iterator of freezList) {
               cpa = iterator.cpa
               for (const tempItr of tempfilterList) {
                  if (tempItr == cpa) {
                     filterList.push(iterator)
                  }
               }
            }
            generateTableRowsAsync(filterList)
            return
         }


      }

      else {

         tempfilterList = []

         for (i = 1; i <= filter_content.options.length - 1; i++) {

            if (filter_content.options[i].selected == true) {
               tempfilterList.push(filter_content.options[i].value.trim())
            }
         }

         // console.log(tempfilterList);

         filterList = []

         if (filter_type == "pos") {

            for (const iterator of fetchList) {

               pos = iterator.pos

               for (const tempItr of tempfilterList) {

                  poscode = tempItr.split('|')[0].trim()

                  if (poscode == pos) {

                     filterList.push(iterator)
                  }
               }
            }

            generateTableRowsAsync(filterList)
            return
         }

         if (filter_type == "insurance_company") {

            for (const iterator of fetchList) {

               insurance_company = iterator.insurance_company

               for (const tempItr of tempfilterList) {

                  if (tempItr == insurance_company) {
                     filterList.push(iterator)
                     // console.log(tempItr);
                  }
               }

            }
            generateTableRowsAsync(filterList)
            return
         }

         if (filter_type == "vehicle_catagory") {

            for (const iterator of fetchList) {

               vehicle_catagory = iterator.vehicle_catagory

               for (const tempItr of tempfilterList) {

                  if (tempItr == vehicle_catagory) {
                     filterList.push(iterator)
                     // console.log(tempItr);
                  }
               }

            }
            generateTableRowsAsync(filterList)
            return
         }

         if (filter_type == "vehicle_makeby") {
            for (const iterator of fetchList) {
               vehicle_makeby = iterator.vehicle_makeby
               for (const tempItr of tempfilterList) {
                  if (tempItr == vehicle_makeby) {
                     filterList.push(iterator)
                  }
               }
            }
            generateTableRowsAsync(filterList)
            return
         }

         if (filter_type == "vehicle_model") {
            for (const iterator of fetchList) {
               vehicle_model = iterator.vehicle_model
               for (const tempItr of tempfilterList) {
                  if (tempItr == vehicle_model) {
                     filterList.push(iterator)
                  }
               }
            }
            generateTableRowsAsync(filterList)
            return
         }

         if (filter_type == "vehicle_fuel_type") {
            for (const iterator of fetchList) {
               vehicle_fuel_type = iterator.vehicle_fuel_type
               for (const tempItr of tempfilterList) {
                  if (tempItr == vehicle_fuel_type) {
                     filterList.push(iterator)
                  }
               }
            }
            generateTableRowsAsync(filterList)
            return
         }

         if (filter_type == "cubic_capacity") {
            for (const iterator of fetchList) {
               cubic_capacity = iterator.cubic_capacity
               for (const tempItr of tempfilterList) {
                  if (tempItr == cubic_capacity) {
                     filterList.push(iterator)
                  }
               }
            }
            generateTableRowsAsync(filterList)
            return
         }

         if (filter_type == "seating_capacity") {
            for (const iterator of fetchList) {
               seating_capacity = iterator.seating_capacity
               for (const tempItr of tempfilterList) {
                  if (tempItr == seating_capacity) {
                     filterList.push(iterator)
                  }
               }
            }
            generateTableRowsAsync(filterList)
            return
         }

         if (filter_type == "coverage_type") {
            for (const iterator of fetchList) {
               coverage_type = iterator.coverage_type
               for (const tempItr of tempfilterList) {
                  if (tempItr == coverage_type) {
                     filterList.push(iterator)
                  }
               }
            }
            generateTableRowsAsync(filterList)
            return
         }

         if (filter_type == "gvw") {
            for (const iterator of fetchList) {
               gvw = iterator.gvw
               for (const tempItr of tempfilterList) {
                  if (tempItr == gvw) {
                     filterList.push(iterator)
                  }
               }
            }
            generateTableRowsAsync(filterList)
            return
         }

         if (filter_type == "policy_type") {
            for (const iterator of fetchList) {
               policy_type = iterator.policy_type
               for (const tempItr of tempfilterList) {
                  if (tempItr == policy_type) {
                     filterList.push(iterator)
                  }
               }
            }
            generateTableRowsAsync(filterList)
            return
         }

         if (filter_type == "addon") {
            for (const iterator of fetchList) {
               addon = iterator.addon
               for (const tempItr of tempfilterList) {
                  if (tempItr == addon) {
                     filterList.push(iterator)
                  }
               }
            }
            generateTableRowsAsync(filterList)
            return
         }

         if (filter_type == "ncb") {
            for (const iterator of fetchList) {
               ncb = iterator.ncb
               for (const tempItr of tempfilterList) {
                  if (tempItr == ncb) {
                     filterList.push(iterator)
                  }
               }
            }
            generateTableRowsAsync(filterList)
            return
         }

         if (filter_type == "cpa") {
            for (const iterator of fetchList) {
               cpa = iterator.cpa
               for (const tempItr of tempfilterList) {
                  if (tempItr == cpa) {
                     filterList.push(iterator)
                  }
               }
            }
            generateTableRowsAsync(filterList)
            return
         }

      }
   }

   function entry_filter() {

      searchText = document.getElementById('myInput').value.trim()

      if (searchText != "") {
         fetchRecord(searchText)
         return
      }

      val1 = document.getElementById('frmDate').value
      val2 = document.getElementById('toDate').value

      if (String(val1) == "") {
         val1 = val2
      }

      d1 = String(val1).replace('/', '-').replace('/', '-').replace('/', '-')
      d2 = String(val2).replace('/', '-').replace('/', '-').replace('/', '-')

      fetch_records(d1 + '|' + d2)
   }

   function fetch_records(data) {

      $.ajax({
         url: "{%url 'bima_policy:fetch_records'%}",
         data: { data: data },
         dataType: 'json',
         success: function (response) {
            // console.log(response.data);
            if (response.data === undefined) {
               showNotification('❌ nothing found!'.toUpperCase());
               return
            }
            fetchList = response.data
            GeneratePolicyTable(fetchList);
            localStorage.setItem('records', JSON.stringify(fetchList));
         },
         error: function (xhr, status, error) {
            console.error(error);
            alert(error.toString())
         }
      });
   }

   function fetchRecord(searchText) {

      $.ajax({
         url: "{%url 'bima_policy:fetch_record'%}",
         data: { data: searchText },
         dataType: 'json',
         success: function (response) {
            data = response.record
            // console.log(data);

            if (data === undefined) {
               showNotification('❌ nothing found!'.toUpperCase());
               return
            }
            fetchList = data
            GeneratePolicyTable(fetchList);

         },
         error: function (xhr, status, error) {
            console.error(error);
            alert(error.toString())
         }
      });

      showNotification('⌛️ Getting ready...')
   }

   function resertDocument() {
      // document.location.reload()

      FetchDataAsync()

      data = JSON.parse(localStorage.getItem('dashboard_details'))

      if (data) {
         localStorage.removeItem('dashboard_details')
      }
      data = JSON.parse(localStorage.getItem('entry_list'))
      if (data) {
         localStorage.removeItem('entry_list')
      }
      data = JSON.parse(localStorage.getItem('posp'))
      if (data) {
         localStorage.removeItem('posp')
      }
      data = JSON.parse(localStorage.getItem('insurers'))
      if (data) {
         localStorage.removeItem('insurers')
      }
      data = JSON.parse(localStorage.getItem('sps'))
      if (data) {
         localStorage.removeItem('sps')
      }
      data = JSON.parse(localStorage.getItem('bc'))
      if (data) {
         localStorage.removeItem('bc')
      }
      data = JSON.parse(localStorage.getItem('products'))
      if (data) {
         localStorage.removeItem('products')
      }
      data = JSON.parse(localStorage.getItem('vehicles'))
      if (data) {
         localStorage.removeItem('vehicles')
      }
      data = JSON.parse(localStorage.getItem('staffs'))
      if (data) {
         localStorage.removeItem('staffs')
      }
      data = JSON.parse(localStorage.getItem('employee'))
      if (data) {
         localStorage.removeItem('employee')
      }
      data = JSON.parse(localStorage.getItem('filter_data'))
      if (data) {
         localStorage.removeItem('filter_data')
      }

   }

   async function FetchDataAsync() {
      try {
         // Create a Promise to wrap the $.ajax() call
         const response = await new Promise((resolve, reject) => {
            $.ajax({
               url: "{%url 'bima_policy:fetch_all'%}",
               dataType: 'json',
               success: function (response) {
                  resolve(response);
               },
               error: function (xhr, status, error) {
                  reject(error);
               }
            });
         });

         // Handle the successful response
         localStorage.setItem('employee', JSON.stringify(response.data.employee));
         localStorage.setItem('dashboard_details', JSON.stringify(response.data.dashboard_details));
         localStorage.setItem('entry_list', JSON.stringify(response.data.entry_list));
         localStorage.setItem('posp', JSON.stringify(response.data.agents));
         localStorage.setItem('insurers', JSON.stringify(response.data.insurers));
         localStorage.setItem('sps', JSON.stringify(response.data.sps));
         localStorage.setItem('bc', JSON.stringify(response.data.bc));
         localStorage.setItem('products', JSON.stringify(response.data.products));
         localStorage.setItem('vehicles', JSON.stringify(response.data.vehicles));
         localStorage.setItem('staffs', JSON.stringify(response.data.staffs));

         fetch_key()

      } catch (error) {
         // Handle errors
         console.error(error);
         alert(error.toString());
      }
   }


   function addToFilterList() {

      filter_type = document.getElementById('filter_type')

      showNotification(`⌛️ You have Freezed ${filter_type.value} `.toUpperCase())

      for (i = 0; i < filter_type.options.length; i++) {

         if (filter_type.options[i].value == filter_type.value) {
            filter_type.options[i].remove()
         }
      }

      filter_type.selectedIndex = 0

      add_filter_type()

      freezList = filterList

   }

   function ExportToExcel(type, fn, dl) {

      var elt = document.getElementById('tblInsurance');
      var wb = XLSX.utils.table_to_book(elt, { sheet: "sheet1" });
      return dl ?
         XLSX.write(wb, { bookType: type, bookSST: true, type: 'base64' }) :
         XLSX.writeFile(wb, fn || ('MySheetName.' + (type || 'xlsx')));
   }

   function clearFilterList() {

      filterList = []
      filterListMultiple = []
      isMultiFilter = false
      rowList = []

      policyid_list = []
      payoutValues = []

      freezList = []

      generateTableRowsAsync(fetchList)

      addFilterTypes()

      showNotification('✅ FILTERS CLEARED! ');
   }

   function addFilterTypes() {

      filter_type = document.getElementById('filter_type')
      filter_type.innerHTML = ''

      var newoption = document.createElement("option");
      newoption.value = 'pos'
      newoption.innerHTML = 'POSPS'
      filter_type.options.add(newoption);

      newoption = document.createElement("option");
      newoption.value = 'insurance_company'
      newoption.innerHTML = 'Insurers'
      filter_type.options.add(newoption);

      newoption = document.createElement("option");
      newoption.value = 'vehicle_catagory'
      newoption.innerHTML = 'vehicle catagory'
      filter_type.options.add(newoption);

      newoption = document.createElement("option");
      newoption.value = 'vehicle_makeby'
      newoption.innerHTML = 'vehicle makeby'
      filter_type.options.add(newoption);

      newoption = document.createElement("option");
      newoption.value = 'vehicle_model'
      newoption.innerHTML = 'vehicle model'
      filter_type.options.add(newoption);

      newoption = document.createElement("option");
      newoption.value = 'vehicle_fuel_type'
      newoption.innerHTML = 'fuel type'
      filter_type.options.add(newoption);

      newoption = document.createElement("option");
      newoption.value = 'cubic_capacity'
      newoption.innerHTML = 'cubic capacity'
      filter_type.options.add(newoption);

      newoption = document.createElement("option");
      newoption.value = 'seating_capacity'
      newoption.innerHTML = 'seating capacity'
      filter_type.options.add(newoption);

      newoption = document.createElement("option");
      newoption.value = 'coverage_type'
      newoption.innerHTML = 'coverage type'
      filter_type.options.add(newoption);

      newoption = document.createElement("option");
      newoption.value = 'gvw'
      newoption.innerHTML = 'gvw'
      filter_type.options.add(newoption);

      newoption = document.createElement("option");
      newoption.value = 'policy_type'
      newoption.innerHTML = 'policy type'
      filter_type.options.add(newoption);

      newoption = document.createElement("option");
      newoption.value = 'addon'
      newoption.innerHTML = 'addon'
      filter_type.options.add(newoption);

      newoption = document.createElement("option");
      newoption.value = 'ncb'
      newoption.innerHTML = 'ncb'
      filter_type.options.add(newoption);

      newoption = document.createElement("option");
      newoption.value = 'cpa'
      newoption.innerHTML = 'cpa'
      filter_type.options.add(newoption);


   }

   function searchTableOnEnterKey(event) {
      if (event.key === "Enter") {
         entry_filter()
      }
   }

   function searchTablee() {

      var input, filter, table, tr, td, i, txtValue;
      input = document.getElementById("myInput");
      filter = input.value.toUpperCase();
      // table = document.getElementById("tblInsurance");
      table = document.getElementById("tbdy");
      tr = table.getElementsByTagName("tr");

      // Loop through all table rows, and hide those who don't match the search query
      for (i = 0; i < tr.length; i++) {
         td = tr[i].getElementsByTagName("td")[1];
         if (td) {
            txtValue = td.textContent || td.innerText;
            // console.log(txtValue);
            if (txtValue.toUpperCase().indexOf(filter) > -1) {
               tr[i].style.display = "";
            } else {
               // tr[i].style.display = "none";

               td4 = tr[i].getElementsByTagName("td")[2];

               if (td4) {
                  txtValue = td4.textContent || td4.innerText;
                  // console.log(txtValue);
                  if (txtValue.toUpperCase().indexOf(filter) > -1) {
                     tr[i].style.display = "";
                  } else {
                     // tr[i].style.display = "none";

                     td5 = tr[i].getElementsByTagName("td")[3];

                     if (td5) {
                        txtValue = td5.textContent || td5.innerText;
                        // console.log(txtValue);
                        if (txtValue.toUpperCase().indexOf(filter) > -1) {
                           tr[i].style.display = "";
                        } else {
                           tr[i].style.display = "none";

                        }
                     }

                  }
               }

            }
         }
      }
   }

   function searchTable() {
      var input = document.getElementById("myInput");
      var filter = input.value.toUpperCase();
      var table = document.getElementById("tbdy");
      var tr = table.getElementsByTagName("tr");

      // Helper function to hide the row
      function hideRow(rowIndex) {
         tr[rowIndex].style.display = "none";
      }

      // Helper function to show the row
      function showRow(rowIndex) {
         tr[rowIndex].style.display = "";
      }

      // Loop through all table rows
      for (var i = 0; i < tr.length; i++) {
         var displayRow = false;

         // Loop through all table cells in the current row
         for (var j = 1; j <= 3; j++) {
            var td = tr[i].getElementsByTagName("td")[j];
            if (td) {
               var txtValue = td.textContent || td.innerText;
               if (txtValue.toUpperCase().indexOf(filter) > -1) {
                  displayRow = true;
                  break; // Break the inner loop if a match is found in any cell
               }
            }
         }

         // Show/hide the row based on the search query match
         if (displayRow) {
            showRow(i);
         } else {
            hideRow(i);
         }
      }
   }

   function delayedSearch() {
      setTimeout(searchTable, 10);
   }


   // motor_entry functions
   posp_added = false
   function addPos() {

      // posp
      if (posp_added == false) {
         posp = JSON.parse(localStorage.getItem('posp'));

         if (posp != null) {
            element = document.getElementById('posps')
            element.innerHTML = ''
            posp.forEach(item => {
               var newoption = document.createElement("option");
               newoption.value = item.posp_code + ' | ' + item.full_name
               newoption.innerHTML = item.posp_code + ' | ' + item.full_name
               element.options.add(newoption);
               // console.log( item.posp_code + ' | ' + item.full_name);
            })
         }
         else {
            fetch_posp("posp")
            return
         }
         posp_added = true
      }

   }

   function get_POS_from_Modal() {
      value = document.getElementById("inp_agent").value = document.getElementById("posps").options[document.getElementById("posps").selectedIndex].text;
      if (value == '') {
         return
      }
      document.getElementById("inp_agent").value = value.split('|')[0].trim()
      document.getElementById("pos").value = value.split('|')[0].trim()
   }

   function setCategoryOnChange() {

      text = document.getElementById('policy_title').innerText

      let cc, cv, sc, gvw = ""
      if (text == "Update Motor Policy") {
         cc = document.getElementById('cubic_capacity').value
         cv = document.getElementById('coverage_type').value
         sc = document.getElementById('seating_capacity').value
         gvw = document.getElementById('gvw').value
      }

      value = document.getElementById('vehicle_catagory').value

      if (value == 'TWO WHEELER SCOOTER' || value == 'TWO WHEELER BIKE') {

         document.getElementById('cubic_div').hidden = false
         document.getElementById('coverage_div').hidden = false

         document.getElementById('seating_div').hidden = true
         document.getElementById('seating_capacity').selectedIndex = 0
         document.getElementById('gvw_div').hidden = true
         document.getElementById('gvw').selectedIndex = 0

         cubic_capacity.innerHTML = ''
         coverage_type.innerHTML = ''

         // Cubic_ capacity options
         var newoption = document.createElement("option");
         newoption.value = ''
         newoption.innerHTML = '-- SELECT CUBIC CAPACITY --'
         cubic_capacity.options.add(newoption);

         var newoption = document.createElement("option");
         newoption.value = '75CC-150CC'
         newoption.innerHTML = '75CC-150CC'
         cubic_capacity.options.add(newoption);

         var newoption = document.createElement("option");
         newoption.value = '150CC-350CC'
         newoption.innerHTML = '150CC-350CC'
         cubic_capacity.options.add(newoption);

         var newoption = document.createElement("option");
         newoption.value = 'ABOVE 350CC'
         newoption.innerHTML = 'ABOVE 350CC'
         cubic_capacity.options.add(newoption);

         // Coverage type
         var newoption = document.createElement("option");
         newoption.value = ''
         newoption.innerHTML = '-- SELECT COVERAGE TYPE --'
         coverage_type.options.add(newoption);

         var newoption = document.createElement("option");
         newoption.value = '1 YEAR PACKAGE'
         newoption.innerHTML = '1 YEAR PACKAGE'
         coverage_type.options.add(newoption);

         var newoption = document.createElement("option");
         newoption.value = '1+4 YEAR PACKAGE'
         newoption.innerHTML = '1+4 YEAR PACKAGE'
         coverage_type.options.add(newoption);

         var newoption = document.createElement("option");
         newoption.value = '5 YEAR TP'
         newoption.innerHTML = '5 YEAR TP'
         coverage_type.options.add(newoption);

         var newoption = document.createElement("option");
         newoption.value = 'TP ONLY'
         newoption.innerHTML = 'TP ONLY'
         coverage_type.options.add(newoption);

         var newoption = document.createElement("option");
         newoption.value = 'OD ONLY'
         newoption.innerHTML = 'OD ONLY'
         coverage_type.options.add(newoption);


      }

      else if (value == 'TWO WHEELER COMMERCIAL') {

         document.getElementById('cubic_div').hidden = false
         document.getElementById('coverage_div').hidden = false
         document.getElementById('seating_div').hidden = false
         document.getElementById('gvw_div').hidden = true
         document.getElementById('gvw').selectedIndex = 0

         cubic_capacity.innerHTML = ''
         coverage_type.innerHTML = ''

         // Cubic_ capacity options
         var newoption = document.createElement("option");
         newoption.value = ''
         newoption.innerHTML = '-- SELECT CUBIC CAPACITY --'
         cubic_capacity.options.add(newoption);

         var newoption = document.createElement("option");
         newoption.value = '75CC-150CC'
         newoption.innerHTML = '75CC-150CC'
         cubic_capacity.options.add(newoption);

         var newoption = document.createElement("option");
         newoption.value = '150CC-350CC'
         newoption.innerHTML = '150CC-350CC'
         cubic_capacity.options.add(newoption);

         var newoption = document.createElement("option");
         newoption.value = 'ABOVE 350CC'
         newoption.innerHTML = 'ABOVE 350CC'
         cubic_capacity.options.add(newoption);

         // Coverage type
         var newoption = document.createElement("option");
         newoption.value = ''
         newoption.innerHTML = '-- SELECT COVERAGE TYPE --'
         coverage_type.options.add(newoption);

         var newoption = document.createElement("option");
         newoption.value = '1 YEAR PACKAGE'
         newoption.innerHTML = '1 YEAR PACKAGE'
         coverage_type.options.add(newoption);

         var newoption = document.createElement("option");
         newoption.value = '1+4 YEAR PACKAGE'
         newoption.innerHTML = '1+4 YEAR PACKAGE'
         coverage_type.options.add(newoption);

         var newoption = document.createElement("option");
         newoption.value = '5 YEAR TP'
         newoption.innerHTML = '5 YEAR TP'
         coverage_type.options.add(newoption);

         var newoption = document.createElement("option");
         newoption.value = 'TP ONLY'
         newoption.innerHTML = 'TP ONLY'
         coverage_type.options.add(newoption);

         var newoption = document.createElement("option");
         newoption.value = 'OD ONLY'
         newoption.innerHTML = 'OD ONLY'
         coverage_type.options.add(newoption);

      }

      else if (value == 'PRIVATE CAR' | value == 'TRADE RISK') {

         document.getElementById('cubic_div').hidden = false
         document.getElementById('coverage_div').hidden = false

         document.getElementById('seating_div').hidden = true
         document.getElementById('seating_capacity').selectedIndex = 0
         document.getElementById('gvw_div').hidden = true
         document.getElementById('gvw').selectedIndex = 0

         cubic_capacity.innerHTML = ''
         coverage_type.innerHTML = ''

         // Cubic_ capacity options
         var newoption = document.createElement("option");
         newoption.value = ''
         newoption.innerHTML = '-- SELECT CUBIC CAPACITY --'
         cubic_capacity.options.add(newoption);

         var newoption = document.createElement("option");
         newoption.value = 'BELOW 1000CC'
         newoption.innerHTML = 'BELOW 1000CC'
         cubic_capacity.options.add(newoption);

         var newoption = document.createElement("option");
         newoption.value = '1000CC-1500CC'
         newoption.innerHTML = '1000CC-1500CC'
         cubic_capacity.options.add(newoption);

         var newoption = document.createElement("option");
         newoption.value = 'ABOVE 1500CC'
         newoption.innerHTML = 'ABOVE 1500CC'
         cubic_capacity.options.add(newoption);

         // Coverage Type
         coverage_type = document.getElementById('coverage_type')
         coverage_type.innerHTML = ''

         var newoption = document.createElement("option");
         newoption.value = ''
         newoption.innerHTML = '-- SELECT COVERAGE TYPE --'
         coverage_type.options.add(newoption);

         var newoption = document.createElement("option");
         newoption.value = '1 YEAR PACKAGE'
         newoption.innerHTML = '1 YEAR PACKAGE'
         coverage_type.options.add(newoption);

         var newoption = document.createElement("option");
         newoption.value = '1+2 YEAR PACKAGE'
         newoption.innerHTML = '1+2 YEAR PACKAGE'
         coverage_type.options.add(newoption);

         var newoption = document.createElement("option");
         newoption.value = '3 YEAR TP'
         newoption.innerHTML = '3 YEAR TP'
         coverage_type.options.add(newoption);

         var newoption = document.createElement("option");
         newoption.value = 'TP ONLY'
         newoption.innerHTML = 'TP ONLY'
         coverage_type.options.add(newoption);

         var newoption = document.createElement("option");
         newoption.value = 'OD ONLY'
         newoption.innerHTML = 'OD ONLY'
         coverage_type.options.add(newoption);
      }

      else if (value == 'GCV-PUBLIC CARRIER OTHER THAN 3 W') {

         document.getElementById('coverage_div').hidden = false
         document.getElementById('gvw_div').hidden = false

         document.getElementById('cubic_div').hidden = true
         document.getElementById('cubic_capacity').innerHTML = ''
         document.getElementById('seating_div').hidden = true
         document.getElementById('seating_capacity').selectedIndex = 0

         cubic_capacity.innerHTML = ''
         coverage_type.innerHTML = ''

         var newoption = document.createElement("option");
         newoption.value = ''
         newoption.innerHTML = '-- SELECT COVERAGE TYPE --'
         coverage_type.options.add(newoption);

         var newoption = document.createElement("option");
         newoption.value = '1 YEAR PACKAGE'
         newoption.innerHTML = '1 YEAR PACKAGE'
         coverage_type.options.add(newoption);

         var newoption = document.createElement("option");
         newoption.value = 'TP ONLY'
         newoption.innerHTML = 'TP ONLY'
         coverage_type.options.add(newoption);
      }

      else if (value == '3 WHEELER PCV') {
         document.getElementById('coverage_div').hidden = false
         document.getElementById('seating_div').hidden = false

         document.getElementById('gvw_div').hidden = true
         document.getElementById('gvw').selectedIndex = 0
         document.getElementById('cubic_div').hidden = true
         document.getElementById('cubic_capacity').innerHTML = ''

         coverage_type.innerHTML = ''

         // Coverage type        
         var newoption = document.createElement("option");
         newoption.value = ''
         newoption.innerHTML = '-- SELECT COVERAGE TYPE --'
         coverage_type.options.add(newoption);

         var newoption = document.createElement("option");
         newoption.value = '1 YEAR PACKAGE'
         newoption.innerHTML = '1 YEAR PACKAGE'
         coverage_type.options.add(newoption);

         var newoption = document.createElement("option");
         newoption.value = 'TP ONLY'
         newoption.innerHTML = 'TP ONLY'
         coverage_type.options.add(newoption);
      }

      else if (value == '3 WHEELER GCV-PUBLIC CARRIER') {
         document.getElementById('coverage_div').hidden = false
         document.getElementById('seating_div').hidden = false
         document.getElementById('gvw_div').hidden = false

         document.getElementById('cubic_div').hidden = true
         document.getElementById('cubic_capacity').innerHTML = ''

         cubic_capacity.innerHTML = ''
         coverage_type.innerHTML = ''

         var newoption = document.createElement("option");
         newoption.value = ''
         newoption.innerHTML = '-- SELECT COVERAGE TYPE --'
         coverage_type.options.add(newoption);

         var newoption = document.createElement("option");
         newoption.value = '1 YEAR PACKAGE'
         newoption.innerHTML = '1 YEAR PACKAGE'
         coverage_type.options.add(newoption);

         var newoption = document.createElement("option");
         newoption.value = 'TP Only'
         newoption.innerHTML = 'TP Only'
         coverage_type.options.add(newoption);
      }

      else if (value == 'TAXI 4 WHEELER') {
         document.getElementById('cubic_div').hidden = false
         document.getElementById('coverage_div').hidden = false
         document.getElementById('seating_div').hidden = false

         document.getElementById('gvw_div').hidden = true
         document.getElementById('gvw').selectedIndex = 0


         cubic_capacity.innerHTML = ''
         coverage_type.innerHTML = ''

         // Cubic_ capacity options
         var newoption = document.createElement("option");
         newoption.value = ''
         newoption.innerHTML = '-- SELECT CUBIC CAPACITY --'
         cubic_capacity.options.add(newoption);

         var newoption = document.createElement("option");
         newoption.value = 'BELOW 1000CC'
         newoption.innerHTML = 'BELOW 1000CC'
         cubic_capacity.options.add(newoption);

         var newoption = document.createElement("option");
         newoption.value = '1000CC-1500CC'
         newoption.innerHTML = '1000CC-1500CC'
         cubic_capacity.options.add(newoption);

         var newoption = document.createElement("option");
         newoption.value = 'ABOVE 1500CC'
         newoption.innerHTML = 'ABOVE 1500CC'
         cubic_capacity.options.add(newoption);

         // Coverage Type
         coverage_type = document.getElementById('coverage_type')
         coverage_type.innerHTML = ''

         var newoption = document.createElement("option");
         newoption.value = ''
         newoption.innerHTML = '-- SELECT COVERAGE TYPE --'
         coverage_type.options.add(newoption);

         var newoption = document.createElement("option");
         newoption.value = '1 YEAR PACKAGE'
         newoption.innerHTML = '1 YEAR PACKAGE'
         coverage_type.options.add(newoption);

         var newoption = document.createElement("option");
         newoption.value = '1+2 YEAR PACKAGE'
         newoption.innerHTML = '1+2 YEAR PACKAGE'
         coverage_type.options.add(newoption);

         var newoption = document.createElement("option");
         newoption.value = '3 YEAR TP'
         newoption.innerHTML = '3 YEAR TP'
         coverage_type.options.add(newoption);

         var newoption = document.createElement("option");
         newoption.value = 'TP ONLY'
         newoption.innerHTML = 'TP ONLY'
         coverage_type.options.add(newoption);

         var newoption = document.createElement("option");
         newoption.value = 'OD ONLY'
         newoption.innerHTML = 'OD ONLY'
         coverage_type.options.add(newoption);
      }

      else if (value == 'BUS AND OTHERS') {
         document.getElementById('coverage_div').hidden = false
         document.getElementById('seating_div').hidden = false

         document.getElementById('cubic_div').hidden = true
         document.getElementById('cubic_capacity').innerHTML = ''

         document.getElementById('gvw_div').hidden = true
         document.getElementById('gvw').selectedIndex = 0

         // document.getElementById('seating_capacityDiv1').hidden = false

         coverage_type = document.getElementById('coverage_type')
         coverage_type.innerHTML = ''

         var newoption = document.createElement("option");
         newoption.value = ''
         newoption.innerHTML = '-- SELECT COVERAGE TYPE --'
         coverage_type.options.add(newoption);

         var newoption = document.createElement("option");
         newoption.value = '1 YEAR PACKAGE'
         newoption.innerHTML = '1 YEAR PACKAGE'
         coverage_type.options.add(newoption);

         var newoption = document.createElement("option");
         newoption.value = 'TP ONLY'
         newoption.innerHTML = 'TP ONLY'
         coverage_type.options.add(newoption);

      }

      else if (value == 'MISC-D SPECIAL VEHICLE') {
         document.getElementById('coverage_div').hidden = false
         document.getElementById('seating_div').hidden = false

         document.getElementById('cubic_div').hidden = true
         document.getElementById('cubic_capacity').innerHTML = ''

         document.getElementById('gvw_div').hidden = true
         document.getElementById('gvw').selectedIndex = 0

         // Coverage Type
         coverage_type = document.getElementById('coverage_type')
         coverage_type.innerHTML = ''

         var newoption = document.createElement("option");
         newoption.value = ''
         newoption.innerHTML = '-- SELECT COVERAGE TYPE --'
         coverage_type.options.add(newoption);

         var newoption = document.createElement("option");
         newoption.value = '1 YEAR PACKAGE'
         newoption.innerHTML = '1 YEAR PACKAGE'
         coverage_type.options.add(newoption);

         var newoption = document.createElement("option");
         newoption.value = '1+2 YEAR PACKAGE'
         newoption.innerHTML = '1+2 YEAR PACKAGE'
         coverage_type.options.add(newoption);

         var newoption = document.createElement("option");
         newoption.value = '3 YEAR TP'
         newoption.innerHTML = '3 YEAR TP'
         coverage_type.options.add(newoption);

         var newoption = document.createElement("option");
         newoption.value = 'TP ONLY'
         newoption.innerHTML = 'TP ONLY'
         coverage_type.options.add(newoption);

         var newoption = document.createElement("option");
         newoption.value = 'OD ONLY'
         newoption.innerHTML = 'OD ONLY'
         coverage_type.options.add(newoption);

      }

      else if (value == 'SCHOOL BUS-SCHOOL NAME') {
         document.getElementById('coverage_div').hidden = false
         document.getElementById('seating_div').hidden = false

         document.getElementById('cubic_div').hidden = true
         document.getElementById('cubic_capacity').innerHTML = ''

         document.getElementById('gvw_div').hidden = true
         document.getElementById('gvw').selectedIndex = 0

         // Coverage Type
         coverage_type = document.getElementById('coverage_type')
         coverage_type.innerHTML = ''

         var newoption = document.createElement("option");
         newoption.value = ''
         newoption.innerHTML = '-- SELECT COVERAGE TYPE --'
         coverage_type.options.add(newoption);

         var newoption = document.createElement("option");
         newoption.value = '1 YEAR PACKAGE'
         newoption.innerHTML = '1 YEAR PACKAGE'
         coverage_type.options.add(newoption);

         var newoption = document.createElement("option");
         newoption.value = '1+2 YEAR PACKAGE'
         newoption.innerHTML = '1+2 YEAR PACKAGE'
         coverage_type.options.add(newoption);

         var newoption = document.createElement("option");
         newoption.value = '3 YEAR TP'
         newoption.innerHTML = '3 YEAR TP'
         coverage_type.options.add(newoption);

         var newoption = document.createElement("option");
         newoption.value = 'TP ONLY'
         newoption.innerHTML = 'TP ONLY'
         coverage_type.options.add(newoption);

         var newoption = document.createElement("option");
         newoption.value = 'OD ONLY'
         newoption.innerHTML = 'OD ONLY'
         coverage_type.options.add(newoption);
      }

      else if (value == 'SCHOOL BUS-INDIVIDUAL NAME') {

         document.getElementById('coverage_div').hidden = false
         document.getElementById('seating_div').hidden = false

         document.getElementById('cubic_div').hidden = true
         document.getElementById('cubic_capacity').innerHTML = ''

         document.getElementById('gvw_div').hidden = true
         document.getElementById('gvw').selectedIndex = 0

         // Coverage Type
         coverage_type = document.getElementById('coverage_type')
         coverage_type.innerHTML = ''

         var newoption = document.createElement("option");
         newoption.value = ''
         newoption.innerHTML = '-- SELECT COVERAGE TYPE --'
         coverage_type.options.add(newoption);

         var newoption = document.createElement("option");
         newoption.value = '1 YEAR PACKAGE'
         newoption.innerHTML = '1 YEAR PACKAGE'
         coverage_type.options.add(newoption);

         var newoption = document.createElement("option");
         newoption.value = '1+2 YEAR PACKAGE'
         newoption.innerHTML = '1+2 YEAR PACKAGE'
         coverage_type.options.add(newoption);

         var newoption = document.createElement("option");
         newoption.value = '3 YEAR TP'
         newoption.innerHTML = '3 YEAR TP'
         coverage_type.options.add(newoption);

         var newoption = document.createElement("option");
         newoption.value = 'TP ONLY'
         newoption.innerHTML = 'TP ONLY'
         coverage_type.options.add(newoption);

         var newoption = document.createElement("option");
         newoption.value = 'OD ONLY'
         newoption.innerHTML = 'OD ONLY'
         coverage_type.options.add(newoption);
      }

      if (text == "Update Motor Policy") {

         element = document.getElementById('cubic_capacity')
         for (let index = 0; index < element.options.length; index++) {
            ele = element[index]
            if (ele.value == cc) {
               element.options[index].selected = true;
               break
            }
         }
         element = document.getElementById('coverage_type')
         for (let index = 0; index < element.options.length; index++) {
            ele = element[index]
            if (ele.value == cv) {
               element.options[index].selected = true;
               break
            }
         }
         element = document.getElementById('seating_capacity')
         for (let index = 0; index < element.options.length; index++) {
            ele = element[index]
            if (ele.value == sc) {
               element.options[index].selected = true;
               break
            }
         }
         element = document.getElementById('gvw')
         for (let index = 0; index < element.options.length; index++) {
            ele = element[index]
            if (ele.value == gvw) {
               element.options[index].selected = true;
               break
            }
         }
      }

      try {
         calculateValue()
      } catch (error) {
      }

   }

   function getRandomFileName(file) {
      timestamp = new Date().getTime();
      randomString = Math.random().toString(36).substring(2, 8); // Generate a random string of 6 characters

      // Extract the file name from the original file name
      fileName = file.name.split('.')[0];

      // Extract the file extension from the original file name
      fileExtension = file.name.split('.').pop();

      // Combine the random string, timestamp, and file extension to form the new file name
      newFileName = `${fileName}_${randomString}_${timestamp}.${fileExtension} `;

      return newFileName;
   }

   var _bucketName = ''
   async function uploadPdf(fileName, file_element) {
      if (fileName.trim() === "") {
         return;
      }

      // console.log(fileName);
      // showNotification(`linking ${fileName}...`.toUpperCase());
      showNotification('✅ ' + 'succeed : '.toUpperCase() + `linking ${fileName}...`.toUpperCase());


      // policy pdf
      const fileInput = document.getElementById(file_element);
      const file = fileInput.files[0];

      if (!file) {
         alert('Please select a PDF file.');
         return;
      }


      bucketName = _bucketName
      s3 = new AWS.S3();

      params = {
         Bucket: bucketName,
         Key: fileName,
         Body: file,
      };

      console.log(params);
      // return
      try {
         const data = await new Promise((resolve, reject) => {
            s3.upload(params, function (err, data) {
               if (err) {
                  reject(err);
               } else {
                  resolve(data);
               }
            });
         });
         showNotification('✅ ' + 'succeed : '.toUpperCase() + `linked ${fileName}...`.toUpperCase());

         // showNotification(`✅ linked ${fileName} `.toUpperCase());
         // console.log('File uploaded successfully. Location:', data.Location);
      } catch (err) {
         alert('Error uploading the file:', err);
         console.error('Error uploading the file:', err);
         // Handle the error here (e.g., show an error message)
      }
   }

   async function sendPolicyData() {

      formData = new FormData();
      formData.append('ptype', 'motor');
      formData.append('proposal_no', document.getElementById('proposal_no').value);
      formData.append('policy_no', document.getElementById('policy_no').value);
      formData.append('customer_name', document.getElementById('customer_name').value);
      formData.append('insurance_company', document.getElementById('insurance_company').value);
      formData.append('sp_name', document.getElementById('sp_name').value);
      formData.append('sp_brokercode', document.getElementById('sp_brokercode').value);
      formData.append('registration_no', document.getElementById('registration_no').value);
      formData.append('rto_state', document.getElementById('rto_state').value);
      formData.append('rto_city', document.getElementById('rto_city').value);
      formData.append('vmake', document.getElementById('vmake').value);
      formData.append('vmodel', document.getElementById('vmodel').value);
      formData.append('vehicle_catagory', document.getElementById('vehicle_catagory').value);
      formData.append('vehicle_fuel_type', document.getElementById('vehicle_fuel_type').value);
      formData.append('mfg_year', document.getElementById('mfg_year').value);
      formData.append('addon', document.getElementById('addon').value);
      formData.append('ncb', document.getElementById('ncb').value);

      formData.append('policy_type', document.getElementById('policy_type').value);
      formData.append('cpa', document.getElementById('cpa').value);
      formData.append('risk_start_date', document.getElementById('risk_start_date').value);
      formData.append('risk_end_date', document.getElementById('risk_end_date').value);
      formData.append('issue_date', document.getElementById('issue_date').value);
      formData.append('insured_age', document.getElementById('insured_age').value);
      formData.append('policy_term', document.getElementById('policy_term').value);
      formData.append('pos', document.getElementById('pos').value);
      formData.append('bqp', document.getElementById('bqp').value);
      formData.append('employee', document.getElementById('employee').value);
      formData.append('od', document.getElementById('od').value);
      formData.append('tpt', document.getElementById('tpt').value);
      formData.append('net', document.getElementById('net').value);
      formData.append('gst', document.getElementById('gst').value);
      formData.append('total', document.getElementById('totalnet').value);
      formData.append('payment_mode', document.getElementById('payment_mode').value);

      for (const iterator of formData) {

         if (iterator[1] == "") {
            showNotification((`⚠️ ${iterator[0]} is missing`.toUpperCase()));
            return
         }
         else {
            showNotification('');
         }
      }

      formData.append('remark', document.getElementById('remark').value);
      formData.append('gstt', document.getElementById('gstt').value);

      text = document.getElementById('policy_title').innerText

      if (text == "Update Motor Policy") {
         formData.append('policyid', policyid);
      }
      else {
         formData.append('policyid', '');
      }

      formData.append('remark', document.getElementById('remark').value);
      formData.append('gstt', '0');

      // global check
      vc = document.getElementById('vehicle_catagory').value

      if (vc == "TWO WHEELER SCOOTER" || vc == "TWO WHEELER BIKE" || vc == "PRIVATE CAR" || vc == "TRADE RISK") {

         formData.append('cubic_capacity', document.getElementById('cubic_capacity').value);
         formData.append('coverage_type', document.getElementById('coverage_type').value);
         formData.append('seating_capacity', '');
         formData.append('gvw', '');

         if (formData.get('cubic_capacity') == "") {
            showNotification((`⚠️ cubic_capacity is missing`.toUpperCase()));
            return
         }
         if (formData.get('coverage_type') == "") {
            showNotification((`⚠️ coverage_type is missing`.toUpperCase()));
            return
         }
      }

      if (vc == "TWO WHEELER COMMERCIAL" || vc == "TAXI 4 WHEELER") {

         formData.append('cubic_capacity', document.getElementById('cubic_capacity').value);
         formData.append('coverage_type', document.getElementById('coverage_type').value);
         formData.append('seating_capacity', document.getElementById('seating_capacity').value);
         formData.append('gvw', '');

         if (formData.get('cubic_capacity') == "") {
            showNotification((`⚠️ cubic_capacity is missing`.toUpperCase()));
            return
         }
         if (formData.get('coverage_type') == "") {
            showNotification((`⚠️ coverage_type is missing`.toUpperCase()));
            return
         }
         if (formData.get('seating_capacity') == "") {
            showNotification((`⚠️ seating_capacity is missing`.toUpperCase()));
            return
         }
      }

      if (vc == "GCV-PUBLIC CARRIER OTHER THAN 3 W") {

         formData.append('cubic_capacity', '');
         formData.append('coverage_type', document.getElementById('coverage_type').value);
         formData.append('seating_capacity', '');
         formData.append('gvw', document.getElementById('gvw').value);

         if (formData.get('coverage_type') == "") {
            showNotification((`⚠️ coverage_type is missing`.toUpperCase()));
            return
         }
         if (formData.get('gvw') == "") {
            showNotification((`⚠️ gvw is missing`.toUpperCase()));
            return
         }
      }

      if (vc == "3 WHEELER PCV" || vc == "BUS AND OTHERS" || vc == "MISC-D SPECIAL VEHICLE" || vc == "SCHOOL BUS-SCHOOL NAME" || vc == "SCHOOL BUS-INDIVIDUAL NAME") {

         formData.append('cubic_capacity', '');
         formData.append('coverage_type', document.getElementById('coverage_type').value);
         formData.append('seating_capacity', document.getElementById('seating_capacity').value);
         formData.append('gvw', '');

         if (formData.get('coverage_type') == "") {
            showNotification((`⚠️ coverage_type is missing`.toUpperCase()));
            return
         }
         if (formData.get('seating_capacity') == "") {
            showNotification((`⚠️ seating_capacity is missing`.toUpperCase()));
            return
         }
      }

      if (vc == "3 WHEELER GCV-PUBLIC CARRIER") {

         formData.append('cubic_capacity', '');
         formData.append('coverage_type', document.getElementById('coverage_type').value);
         formData.append('seating_capacity', document.getElementById('seating_capacity').value);
         formData.append('gvw', document.getElementById('seating_capacity').value);

         if (formData.get('coverage_type') == "") {
            showNotification((`⚠️ coverage_type is missing`.toUpperCase()));
            return
         }
         if (formData.get('seating_capacity') == "") {
            showNotification((`⚠️ seating_capacity is missing`.toUpperCase()));
            return
         }
         if (formData.get('gvw') == "") {
            showNotification((`⚠️ gvw is missing`.toUpperCase()));
            return
         }
      }

      formData.append('proposal', '');
      formData.append('mandate', '');
      formData.append('policy', '');
      formData.append('previous_policy', '');
      formData.append('pan_card', '');
      formData.append('aadhar_card', '');
      formData.append('vehicle_rc', '');
      formData.append('inspection_report', '');

      // attachments
      proposal = document.getElementById('proposal').files[0]
      if (proposal != null) {
         file_name = `media/documents/` + getRandomFileName(proposal)
         formData.set('proposal', file_name.trim());
      }
      mandate = document.getElementById('mandate').files[0]
      if (mandate != null) {
         file_name = `media/documents/` + getRandomFileName(mandate)
         formData.set('mandate', file_name.trim());
      }
      policy = document.getElementById('policy').files[0]
      if (policy != null) {
         file_name = `media/documents/` + getRandomFileName(policy)
         formData.set('policy', file_name.trim());
      }
      previous_policy = document.getElementById('previous_policy').files[0]
      if (previous_policy != null) {
         file_name = `media/documents/` + getRandomFileName(previous_policy)
         formData.set('previous_policy', file_name.trim());
      }
      pan_card = document.getElementById('pan_card').files[0]

      if (pan_card != null) {
         file_name = `media/documents/` + getRandomFileName(pan_card)
         formData.set('pan_card', file_name.trim());
      }

      aadhar_card = document.getElementById('aadhar_card').files[0]
      if (aadhar_card != null) {
         file_name = `media/documents/` + getRandomFileName(aadhar_card)
         formData.set('aadhar_card', file_name.trim());
      }

      vehicle_rc = document.getElementById('vehicle_rc').files[0]
      if (vehicle_rc != null) {
         file_name = `media/documents/` + getRandomFileName(vehicle_rc)
         formData.set('vehicle_rc', file_name.trim());
      }

      inspection_report = document.getElementById('inspection_report').files[0]
      if (inspection_report != null) {
         file_name = `media/documents/` + getRandomFileName(inspection_report)
         formData.set('inspection_report', file_name.trim());
      }

      result = await sendFormData(formData.get('policy_no'), formData);
      if (result != null) {

         if (document.getElementById('policy_title').innerText == "Motor Policy") {

            await uploadPdf(formData.get('proposal'), 'proposal')
            await uploadPdf(formData.get('mandate'), 'mandate')
            await uploadPdf(formData.get('policy'), 'policy')
            await uploadPdf(formData.get('previous_policy'), 'previous_policy')
            await uploadPdf(formData.get('pan_card'), 'pan_card')
            await uploadPdf(formData.get('aadhar_card'), 'aadhar_card')
            await uploadPdf(formData.get('vehicle_rc'), 'vehicle_rc')
            await uploadPdf(formData.get('inspection_report'), 'inspection_report')

            showNotification('✅ ' + 'succeed : '.toUpperCase() + formData.get('policy_no').toUpperCase());
         }

         FetchDataAsync()

         clearAllField()
      }
   }

   async function sendFormData(formDataKey, formData) {
      try {
         showNotification('⌛️ Generating policy...'.toUpperCase());

         const href = window.location.origin + '/bima_policy/policy/new_entry/';
         const csrfToken = '{{ csrf_token }}';

         const response = await fetch(href, {
            method: 'POST',
            headers: {
               'X-CSRFToken': csrfToken,
            },
            body: formData,
         });

         const result = await response.text();
         // console.log(result);

         if (result.includes('done:')) {
            showNotification('✅ ' + 'succeed : '.toUpperCase() + formDataKey.toUpperCase());
            return result
         } else {
            showNotification('❌ ' + 'failed : '.toUpperCase() + formDataKey.toUpperCase());
            return null
         }
      } catch (error) {
         showNotification('❌ ' + 'error : '.toUpperCase() + error.message.toUpperCase());
         alert(error.toString())
         return null
      }
   }

   function clearAllField() {

      document.getElementById('proposal_no').value = ''
      document.getElementById('policy_no').value = ''
      document.getElementById('customer_name').value = ''
      document.getElementById('insurance_company').value = ''

      document.getElementById('sp_name').value = ''
      document.getElementById('sp_brokercode').value = ''
      document.getElementById('registration_no').value = ''
      document.getElementById('rto_state').selectedIndex = 0
      document.getElementById('rto_city').value = ''
      document.getElementById('vmake').selectedIndex = 0
      document.getElementById('vmodel').selectedIndex = 0
      document.getElementById('vehicle_catagory').selectedIndex = 0
      document.getElementById('vehicle_fuel_type').selectedIndex = 0
      document.getElementById('mfg_year').selectedIndex = 0
      document.getElementById('addon').selectedIndex = 0
      document.getElementById('ncb').selectedIndex = 0
      document.getElementById('cubic_capacity').value = ''
      document.getElementById('coverage_type').value = ''
      document.getElementById('seating_capacity').selectedIndex = 0
      document.getElementById('gvw').selectedIndex = 0
      document.getElementById('policy_type').selectedIndex = 0
      document.getElementById('cpa').selectedIndex = 0
      document.getElementById('risk_start_date').value = ''
      document.getElementById('risk_end_date').value = ''
      document.getElementById('issue_date').value = ''
      document.getElementById('insured_age').value = 0
      document.getElementById('policy_term').selectedIndex = 0
      document.getElementById('bqp').selectedIndex = 1
      // document.getElementById('employee').value = ''
      document.getElementById('employee').value = JSON.parse(localStorage.getItem('employee'));
      document.getElementById('pos').value = ''
      document.getElementById('remark').value = ''

      document.getElementById('od').value = ''
      document.getElementById('tpt').value = ''
      document.getElementById('net').value = ''
      document.getElementById('gst').value = ''
      document.getElementById('gstt').value = ''
      document.getElementById('totalnet').value = ''
      document.getElementById('payment_mode').selectedIndex = 0

      document.getElementById('proposal').value = ''
      document.getElementById('lbl_proposal').innerHTML = 'Choose file'
      document.getElementById('mandate').value = ''
      document.getElementById('lbl_mandate').innerHTML = 'Choose file'
      document.getElementById('policy').value = ''
      document.getElementById('lbl_policy').innerHTML = 'Choose file'
      document.getElementById('previous_policy').value = ''
      document.getElementById('lbl_previous_policy').innerHTML = 'Choose file'
      document.getElementById('pan_card').value = ''
      document.getElementById('lbl_pan_card').innerHTML = 'Choose file'
      document.getElementById('aadhar_card').value = ''
      document.getElementById('lbl_aadhar_card').innerHTML = 'Choose file'
      document.getElementById('vehicle_rc').value = ''
      document.getElementById('lbl_vehicle_rc').innerHTML = 'Choose file'
      document.getElementById('inspection_report').value = ''
      document.getElementById('lbl_inspection_report').innerHTML = 'Choose file'

    
      
      document.getElementById("vehicle_catagory").focus()
   }

   function calculateValue() {

      try {
         calc()
         addGST()
         addSubTotal()


      } catch (error) { }

   }

   function calc() {
      // Removes space      

      document.getElementById("od").value = document.getElementById("od").value.toString().trim()
      document.getElementById("tpt").value = document.getElementById("tpt").value.toString().trim()

      od = parseFloat(document.getElementById("od").value);
      tpt = parseFloat(document.getElementById("tpt").value);

      document.getElementById("net").value = Number(od + tpt).toFixed((2))

   }

   function addGST() {
      net = parseFloat(document.getElementById("net").value);
      gst = parseFloat(document.getElementById("gst").value);
      gstt = parseFloat(document.getElementById("gstt").value);

      try {
         vc = document.getElementById('vehicle_catagory').value
         if (vc == 'GCV-PUBLIC CARRIER OTHER THAN 3 W' || vc == '3 WHEELER GCV-PUBLIC CARRIER') {
            document.getElementById("gst").value = Number(od * 18 / 100).toFixed((2))
            document.getElementById("gstt").value = Number(tpt * 12 / 100).toFixed((2))
         }
         else {
            document.getElementById("gst").value = Number(net * 18 / 100).toFixed((2))
         };
      }
      catch { }
   }

   function addSubTotal() {
      net = parseFloat(document.getElementById("net").value);
      gst = parseFloat(document.getElementById("gst").value);
      gstt = parseFloat(document.getElementById("gstt").value);

      document.getElementById("totalnet").value = Number(net + gst + gstt).toFixed((2))
   }


   // non motor entry functions


   async function sendPolicyDataNonMotor() {

      console.log('sendPolicyDataNonMotor calling: ');

      formData = new FormData();
      formData.append('ptype', 'nonmotor');
      formData.append('product_name', document.getElementById('product_name').value);
      formData.append('policy_type', document.getElementById('policy_type2').value);
      formData.append('proposal_no', document.getElementById('proposal_no2').value);
      formData.append('policy_no', document.getElementById('policy_no2').value);
      formData.append('customer_name', document.getElementById('customer_name2').value);
      formData.append('insurance_company', document.getElementById('insurer_name').value);
      formData.append('sp_name', document.getElementById('sps_name').value);
      formData.append('sp_brokercode', document.getElementById('sp_code').value);

      formData.append('risk_start_date', document.getElementById('risk_start_date2').value);
      formData.append('risk_end_date', document.getElementById('risk_end_date2').value);
      formData.append('issue_date', document.getElementById('issue_date2').value);

      formData.append('policy_term', document.getElementById('policy_term2').value);
      formData.append('pos', document.getElementById('pos_product').value);
      formData.append('bqp', document.getElementById('bqp2').value);
      formData.append('employee', document.getElementById('product_employee').value);

      formData.append('od', document.getElementById('od_product').value);
      formData.append('tpt', document.getElementById('tpt_product').value);
      formData.append('net', document.getElementById('net_product').value);
      formData.append('gst', document.getElementById('gst_product').value);
      formData.append('total', document.getElementById('total_product').value);
      formData.append('payment_mode', document.getElementById('payment_mode2').value);

      for (const iterator of formData) {

         if (iterator[1] == "") {
            showNotification((`⚠️ ${iterator[0]} is missing`.toUpperCase()));
            return
         }
         else {
            showNotification('');
         }
      }

      formData.append('remark', document.getElementById('remark2').value);

      text = document.getElementById('policy_title_non_motor').innerText

      if (text == "Update Non Motor Policy") {
         formData.append('policyid', policyid);
      }
      else {
         formData.append('policyid', '');
      }

      formData.append('proposal', '');
      formData.append('mandate', '');
      formData.append('policy', '');
      formData.append('previous_policy', '');
      formData.append('pan_card', '');
      formData.append('aadhar_card', '');
      formData.append('inspection_report', '');

      // attachments
      proposal = document.getElementById('proposal2').files[0]
      if (proposal != null) {
         file_name = `media/documents/` + getRandomFileName(proposal)
         formData.set('proposal', file_name.trim());
      }
      mandate = document.getElementById('mandate2').files[0]
      if (mandate != null) {
         file_name = `media/documents/` + getRandomFileName(mandate)
         formData.set('mandate', file_name.trim());
      }
      policy = document.getElementById('policy2').files[0]
      if (policy != null) {
         file_name = `media/documents/` + getRandomFileName(policy)
         formData.set('policy', file_name.trim());
      }
      previous_policy = document.getElementById('previous_policy2').files[0]
      if (previous_policy != null) {
         file_name = `media/documents/` + getRandomFileName(previous_policy)
         formData.set('previous_policy', file_name.trim());
      }
      pan_card = document.getElementById('pan_card2').files[0]

      if (pan_card != null) {
         file_name = `media/documents/` + getRandomFileName(pan_card)
         formData.set('pan_card', file_name.trim());
      }

      aadhar_card = document.getElementById('aadhar_card2').files[0]
      if (aadhar_card != null) {
         file_name = `media/documents/` + getRandomFileName(aadhar_card)
         formData.set('aadhar_card', file_name.trim());
      }

      inspection_report = document.getElementById('inspection_report2').files[0]
      if (inspection_report != null) {
         file_name = `media/documents/` + getRandomFileName(inspection_report)
         formData.set('inspection_report', file_name.trim());
      }

      for (const iterator of formData) {

         console.log(iterator);
      }

      // return
      result = await sendFormData(formData.get('policy_no'), formData);

      if (result != null) {

         if (document.getElementById('policy_title_non_motor').innerText == "Non Motor Policy") {

            await uploadPdf(formData.get('proposal'), 'proposal2')
            await uploadPdf(formData.get('mandate'), 'mandate2')
            await uploadPdf(formData.get('policy'), 'policy2')
            await uploadPdf(formData.get('previous_policy'), 'previous_policy2')
            await uploadPdf(formData.get('pan_card'), 'pan_card2')
            await uploadPdf(formData.get('aadhar_card'), 'aadhar_card2')
            await uploadPdf(formData.get('inspection_report'), 'inspection_report2')

            showNotification('✅ ' + 'succeed : '.toUpperCase() + formData.get('policy_no').toUpperCase());
         }

         FetchDataAsync()

         clearNonMotorForm()
      }

   }

   function clearNonMotorForm() {

      document.getElementById('product_name').value = ''
      document.getElementById('policy_type2').value = ''
      document.getElementById('proposal_no2').value = ''
      document.getElementById('policy_no2').value = ''

      document.getElementById('customer_name2').value = ''

      document.getElementById('insurer_name').value = ''
      document.getElementById('sps_name').value = ''
      document.getElementById('sp_code').value = ''

      document.getElementById('risk_start_date2').value = ''
      document.getElementById('risk_end_date2').value = ''
      document.getElementById('issue_date2').value = ''

      document.getElementById('policy_term2').selectedIndex = 0
      document.getElementById('pos_product').value = ''
      document.getElementById('bqp2').selectedIndex = 1
      document.getElementById('product_employee').value = JSON.parse(localStorage.getItem('employee'));
   
      document.getElementById('remark2').value = ''

      document.getElementById('od_product').value = ''
      document.getElementById('tpt_product').value = ''
      document.getElementById('net_product').value = ''
      document.getElementById('gst_product').value = ''
      document.getElementById('total_product').value = ''
      document.getElementById('payment_mode2').selectedIndex = 0

      document.getElementById('proposal2').value = ''
      document.getElementById('lbl_proposal2').innerHTML = 'Choose file'
      document.getElementById('mandate2').value = ''
      document.getElementById('lbl_mandate2').innerHTML = 'Choose file'
      document.getElementById('policy2').value = ''
      document.getElementById('lbl_policy2').innerHTML = 'Choose file'
      document.getElementById('previous_policy2').value = ''
      document.getElementById('lbl_previous_policy2').innerHTML = 'Choose file'
      document.getElementById('pan_card2').value = ''
      document.getElementById('lbl_pan_card2').innerHTML = 'Choose file'
      document.getElementById('aadhar_card2').value = ''
      document.getElementById('lbl_aadhar_card2').innerHTML = 'Choose file'
      document.getElementById('inspection_report2').value = ''
      document.getElementById('lbl_inspection_report2').innerHTML = 'Choose file'

      document.getElementById("product_name").focus()
   }


   posp_product_added = false
   function addPosToProduct() {

      // posp
      if (posp_product_added == false) {
         posp = JSON.parse(localStorage.getItem('posp'));
         // console.log(posp);
         if (posp != null) {
            element = document.getElementById('posps_product')
            element.innerHTML = ''
            posp.forEach(item => {
               var newoption = document.createElement("option");
               newoption.value = item.posp_code + ' | ' + item.full_name
               newoption.innerHTML = item.posp_code + ' | ' + item.full_name
               element.options.add(newoption);
               // console.log( item.posp_code + ' | ' + item.full_name);
            })
         }
         posp_product_added = true
      }

   }

   function get_POS_from_Modal_product() {
      value = document.getElementById("inp_agent_product").value = document.getElementById("posps_product").options[document.getElementById("posps_product").selectedIndex].text;
      if (value == '') {
         return
      }
      document.getElementById("inp_agent_product").value = value.split('|')[0].trim()
      document.getElementById("pos_product").value = value.split('|')[0].trim()
   }

   function calculateValue2() {

      try {
         calc2()
         addGST2()
         addSubTotal2()

      } catch (error) { }

   }

   function calc2() {
      // Removes space      

      document.getElementById("od_product").value = document.getElementById("od_product").value.toString().trim()
      document.getElementById("tpt_product").value = document.getElementById("tpt_product").value.toString().trim()

      od = parseFloat(document.getElementById("od_product").value);
      tpt = parseFloat(document.getElementById("tpt_product").value);

      document.getElementById("net_product").value = Number(od + tpt).toFixed((2))

   }

   function addGST2() {
      try {
         od = parseFloat(document.getElementById("od_product").value);
         net = parseFloat(document.getElementById("net_product").value);
         document.getElementById("gst_product").value = Number(od * 18 / 100).toFixed((2))
      }
      catch { }
   }

   function addSubTotal2() {
      net = parseFloat(document.getElementById("net_product").value);
      gst = parseFloat(document.getElementById("gst_product").value);

      document.getElementById("total_product").value = Number(net + gst).toFixed((2))
   }


   function clearAllFieldNonMotor() {

      document.getElementsByName('product_name')[0].value = ''
      document.getElementsByName('policy_type2')[0].value = ''
      document.getElementsByName('proposal_no2')[0].value = ''
      document.getElementsByName('policy_no2')[0].value = ''
      document.getElementsByName('customer_name2')[0].value = ''
      document.getElementsByName('insurer_name')[0].value = ''

      document.getElementsByName('sps_name')[0].value = ''
      document.getElementsByName('sp_code')[0].value = ''

      document.getElementsByName('risk_start_date2')[0].value = ''
      document.getElementsByName('risk_end_date2')[0].value = ''
      document.getElementsByName('issue_date2')[0].value = ''

      document.getElementsByName('policy_term2')[0].value = ''

      document.getElementsByName('pos_product')[0].value = ''
      document.getElementsByName('remark2')[0].value = ''

      document.getElementsByName('od_product')[0].value = ''
      document.getElementsByName('tpt_product')[0].value = ''
      document.getElementsByName('net_product')[0].value = ''
      document.getElementsByName('gst_product')[0].value = ''
      // document.getElementsByName('gstt')[0].value = ''
      document.getElementsByName('total_product')[0].value = ''
      document.getElementsByName('payment_mode2')[0].value = 'ONLINE'

      document.getElementsByName('proposal2')[0].value = ''
      document.getElementsByName('lbl_proposal2')[0].innerHTML = 'Choose file'
      document.getElementsByName('mandate2')[0].value = ''
      document.getElementsByName('lbl_mandate2')[0].innerHTML = 'Choose file'
      document.getElementsByName('policy2')[0].value = ''
      document.getElementsByName('lbl_policy2')[0].innerHTML = 'Choose file'
      document.getElementsByName('previous_policy2')[0].value = ''
      document.getElementsByName('lbl_previous_policy2')[0].innerHTML = 'Choose file'
      document.getElementsByName('pan_card2')[0].value = ''
      document.getElementsByName('lbl_pan_card2')[0].innerHTML = 'Choose file'
      document.getElementsByName('aadhar_card2')[0].value = ''
      document.getElementsByName('lbl_aadhar_card2')[0].innerHTML = 'Choose file'

      document.getElementsByName('inspection_report2')[0].value = ''
      document.getElementsByName('lbl_inspection_report2')[0].innerHTML = 'Choose file'

      document.getElementsByName("product_name")[0].focus()
   }

   function downloadFile(params) {
      // alert(params)
      if (params.includes("/")) {
         index = params.lastIndexOf("/") + 1
         params = params.substring(index, params.length);
      }
      pathname = '/bima_policy/docs/download/' + params
      href = window.location.origin + pathname
      window.open(href)
   }

   function myFunction() {
      document.getElementById("registration_no").value = document.getElementById("registration_no").value.toUpperCase();
      var x = document.getElementById("registration_no").value;
      document.getElementById("demo").innerHTML = x.slice(0, 4);

      if (x.startsWith('AN')) {
         var rto_state = document.getElementById("rto_state");
         for (let index = 0; index < rto_state.options.length; index++) {

            if (rto_state[index].value == 'Andama And Nicobar Island') {
               rto_state[index].selected = true;
            }
         }
      }
      else if (x.startsWith('AP')) {
         var rto_state = document.getElementById("rto_state");
         for (let index = 0; index < rto_state.options.length; index++) {

            if (rto_state[index].value == 'Andhra Pradesh') {
               rto_state[index].selected = true;
            }
         }
      }
      else if (x.startsWith('AR')) {
         var rto_state = document.getElementById("rto_state");
         for (let index = 0; index < rto_state.options.length; index++) {

            if (rto_state[index].value == 'Arunachal Pradesh') {
               rto_state[index].selected = true;
            }
         }
      }
      else if (x.startsWith('AS')) {
         var rto_state = document.getElementById("rto_state");
         for (let index = 0; index < rto_state.options.length; index++) {

            if (rto_state[index].value == 'Assam') {
               rto_state[index].selected = true;
            }
         }
      }
      else if (x.startsWith('BR')) {
         var rto_state = document.getElementById("rto_state");
         for (let index = 0; index < rto_state.options.length; index++) {

            if (rto_state[index].value == 'Bihar') {
               rto_state[index].selected = true;
            }
         }
      }
      else if (x.startsWith('CH')) {
         var rto_state = document.getElementById("rto_state");
         for (let index = 0; index < rto_state.options.length; index++) {

            if (rto_state[index].value == 'Chandigarh') {
               rto_state[index].selected = true;
            }
         }
      }
      else if (x.startsWith('CG')) {
         var rto_state = document.getElementById("rto_state");
         for (let index = 0; index < rto_state.options.length; index++) {

            if (rto_state[index].value == 'Chattisgarh') {
               rto_state[index].selected = true;
            }
         }
      }
      else if (x.startsWith('DD')) {
         var rto_state = document.getElementById("rto_state");
         for (let index = 0; index < rto_state.options.length; index++) {

            if (rto_state[index].value == 'Daman And Diu') {
               rto_state[index].selected = true;
            }
         }
      }
      else if (x.startsWith('DL')) {
         var rto_state = document.getElementById("rto_state");
         for (let index = 0; index < rto_state.options.length; index++) {

            if (rto_state[index].value == 'Delhi') {
               rto_state[index].selected = true;
            }
         }
      }
      else if (x.startsWith('GA')) {
         var rto_state = document.getElementById("rto_state");
         for (let index = 0; index < rto_state.options.length; index++) {

            if (rto_state[index].value == 'GOA') {
               rto_state[index].selected = true;
            }
         }
      }
      else if (x.startsWith('GJ')) {
         var rto_state = document.getElementById("rto_state");
         for (let index = 0; index < rto_state.options.length; index++) {

            if (rto_state[index].value == 'Gujrat') {
               rto_state[index].selected = true;
            }
         }
      }
      else if (x.startsWith('HR')) {
         var rto_state = document.getElementById("rto_state");
         for (let index = 0; index < rto_state.options.length; index++) {

            if (rto_state[index].value == 'Haryana') {
               rto_state[index].selected = true;
            }
         }
      }
      else if (x.startsWith('HP')) {
         var rto_state = document.getElementById("rto_state");
         for (let index = 0; index < rto_state.options.length; index++) {

            if (rto_state[index].value == 'Himachal Pradesh') {
               rto_state[index].selected = true;
            }
         }
      }
      else if (x.startsWith('JK')) {
         var rto_state = document.getElementById("rto_state");
         for (let index = 0; index < rto_state.options.length; index++) {

            if (rto_state[index].value == 'Jammu And Kashmir') {
               rto_state[index].selected = true;
            }
         }
      }
      else if (x.startsWith('JH')) {
         var rto_state = document.getElementById("rto_state");
         for (let index = 0; index < rto_state.options.length; index++) {

            if (rto_state[index].value == 'Jharkhand') {
               rto_state[index].selected = true;
            }
         }
      }
      else if (x.startsWith('KA')) {
         var rto_state = document.getElementById("rto_state");
         for (let index = 0; index < rto_state.options.length; index++) {

            if (rto_state[index].value == 'Karnataka') {
               rto_state[index].selected = true;
            }
         }
      }
      else if (x.startsWith('KL')) {
         var rto_state = document.getElementById("rto_state");
         for (let index = 0; index < rto_state.options.length; index++) {

            if (rto_state[index].value == 'Kerala') {
               rto_state[index].selected = true;
            }
         }
      }
      else if (x.startsWith('LD')) {
         var rto_state = document.getElementById("rto_state");
         for (let index = 0; index < rto_state.options.length; index++) {

            if (rto_state[index].value == 'Lakshadweep') {
               rto_state[index].selected = true;
            }
         }
      }
      else if (x.startsWith('LA')) {
         var rto_state = document.getElementById("rto_state");
         for (let index = 0; index < rto_state.options.length; index++) {

            if (rto_state[index].value == 'Leh') {
               rto_state[index].selected = true;
            }
         }
      }
      else if (x.startsWith('MP')) {
         var rto_state = document.getElementById("rto_state");
         for (let index = 0; index < rto_state.options.length; index++) {

            if (rto_state[index].value == 'Madhya Pradesh') {
               rto_state[index].selected = true;
            }
         }
      }
      else if (x.startsWith('MH')) {
         var rto_state = document.getElementById("rto_state");
         for (let index = 0; index < rto_state.options.length; index++) {

            if (rto_state[index].value == 'Maharashtra') {
               rto_state[index].selected = true;
            }
         }
      }
      else if (x.startsWith('MN')) {
         var rto_state = document.getElementById("rto_state");
         for (let index = 0; index < rto_state.options.length; index++) {

            if (rto_state[index].value == 'Manipur') {
               rto_state[index].selected = true;
            }
         }
      }
      else if (x.startsWith('ML')) {
         var rto_state = document.getElementById("rto_state");
         for (let index = 0; index < rto_state.options.length; index++) {

            if (rto_state[index].value == 'Meghalaya') {
               rto_state[index].selected = true;
            }
         }
      }
      else if (x.startsWith('MZ')) {
         var rto_state = document.getElementById("rto_state");
         for (let index = 0; index < rto_state.options.length; index++) {

            if (rto_state[index].value == 'Mizoram') {
               rto_state[index].selected = true;
            }
         }
      }
      else if (x.startsWith('NL')) {
         var rto_state = document.getElementById("rto_state");
         for (let index = 0; index < rto_state.options.length; index++) {

            if (rto_state[index].value == 'Nagaland') {
               rto_state[index].selected = true;
            }
         }
      }
      else if (x.startsWith('OD')) {
         var rto_state = document.getElementById("rto_state");
         for (let index = 0; index < rto_state.options.length; index++) {

            if (rto_state[index].value == 'Odisha') {
               rto_state[index].selected = true;
            }
         }
      }
      else if (x.startsWith('PY')) {
         var rto_state = document.getElementById("rto_state");
         for (let index = 0; index < rto_state.options.length; index++) {

            if (rto_state[index].value == 'Puducherry') {
               rto_state[index].selected = true;
            }
         }
      }
      else if (x.startsWith('PB')) {
         var rto_state = document.getElementById("rto_state");
         for (let index = 0; index < rto_state.options.length; index++) {

            if (rto_state[index].value == 'Punjab') {
               rto_state[index].selected = true;
            }
         }
      }
      else if (x.startsWith('RJ')) {
         var rto_state = document.getElementById("rto_state");
         for (let index = 0; index < rto_state.options.length; index++) {

            if (rto_state[index].value == 'Rajasthan') {
               rto_state[index].selected = true;
            }
         }
      }
      else if (x.startsWith('SK')) {
         var rto_state = document.getElementById("rto_state");
         for (let index = 0; index < rto_state.options.length; index++) {

            if (rto_state[index].value == 'Sikkim') {
               rto_state[index].selected = true;
            }
         }
      }
      else if (x.startsWith('TN')) {
         var rto_state = document.getElementById("rto_state");
         for (let index = 0; index < rto_state.options.length; index++) {

            if (rto_state[index].value == 'Tamil Nadu') {
               rto_state[index].selected = true;
            }
         }
      }
      else if (x.startsWith('TR')) {
         var rto_state = document.getElementById("rto_state");
         for (let index = 0; index < rto_state.options.length; index++) {

            if (rto_state[index].value == 'Telangana') {
               rto_state[index].selected = true;
            }
         }
      }
      else if (x.startsWith('TS')) {
         var rto_state = document.getElementById("rto_state");
         for (let index = 0; index < rto_state.options.length; index++) {

            if (rto_state[index].value == 'Telangana') {
               rto_state[index].selected = true;
            }
         }
      }
      else if (x.startsWith('UK')) {
         var rto_state = document.getElementById("rto_state");
         for (let index = 0; index < rto_state.options.length; index++) {

            if (rto_state[index].value == 'Uttrakhand') {
               rto_state[index].selected = true;
            }
         }
      }
      else if (x.startsWith('UP')) {
         var rto_state = document.getElementById("rto_state");
         for (let index = 0; index < rto_state.options.length; index++) {

            if (rto_state[index].value == 'Uttar Pradesh') {
               rto_state[index].selected = true;
            }
         }
      }
      else if (x.startsWith('WB')) {
         var rto_state = document.getElementById("rto_state");
         for (let index = 0; index < rto_state.options.length; index++) {

            if (rto_state[index].value == 'West Bengal') {
               rto_state[index].selected = true;
            }
         }
      }

   }

   function fetch_key() {

      href = window.location.origin + '/bima_policy/policy/fetch_key/'

      $.ajax({
         url: href,
         type: "POST",
         beforeSend: function (xhr) {
            xhr.setRequestHeader('X-CSRFToken', '{{ csrf_token }}');
         },
         // data: formData,
         processData: false,
         contentType: false,
         success: function (response) {

            // console.log(response.data);        
            // console.log(response.data.accessKeyId);        

            AWS.config.update({
               accessKeyId: response.data.accessKeyId,
               secretAccessKey: response.data.secretAccessKey,
               region: response.data.region, // e.g., 'us-east-1'
            });

            _bucketName = response.data.BUCKET_NAME

         },
         error: function (xhr, status, error) {
            // console.log(error);
            alert(error.message)
            showNotification('❌ ' + 'error : '.toUpperCase() + error.message.toUpperCase());
         }
      });
   }

   function addNewSomething() {

      heading = document.getElementById('page_heading').innerText

      if (heading == "Policy List") {
         ShowPage('motor_entry')
      }
      else if (heading == "POS List") {
         ShowPage('new_posp')
      }
   }

   function Load_Posp_Config() {

      document.getElementById('posp_title').innerText = "POSP Form"
      document.getElementById('btn_save_posp').innerText = "GENERATE"
      clearPospForm()
      return
      document.getElementById('posp_code').value = ''
      document.getElementById('registration_code').value = ''
      document.getElementById('full_name').value = ''
      document.getElementById('gender').selectedIndex = 0
      document.getElementById('mob_no').value = ""
      document.getElementById('email_id').value = ""
      document.getElementById('address').value = ""
      document.getElementById('state').selectedIndex = 0
      document.getElementById('city').value = ''

      document.getElementById('pincode').value = ''
      document.getElementById('rural_urban').selectedIndex = 0
      document.getElementById('slab').selectedIndex = 1

      document.getElementById('GSTIN').value = ''
      document.getElementById('account_no').value = ''
      document.getElementById('ifsc_code').value = ''
      document.getElementById('bank_name').value = ''

      document.getElementById('basic_qualification').value = ""
      document.getElementById('a_basic_qualification').innerText = ""
      document.getElementById('lbl_basic_qualification').innerText = "Choose file"

      document.getElementById('aadhar_card_pos').value = ""
      document.getElementById('a_aadhar_card_pos').innerText = ""
      document.getElementById('lbl_aadhar_card_pos').innerText = "Choose file"

      document.getElementById('pan_card_pos').value = ""
      document.getElementById('a_pan_card_pos').innerText = ""
      document.getElementById('lbl_pan_card_pos').innerText = "Choose file"

      document.getElementById('training_certificate_pos').value = ""
      document.getElementById('a_training_certificate_pos').innerText = ""
      document.getElementById('lbl_training_certificate_pos').innerText = "Choose file"

      document.getElementById('appointment_certificate_pos').value = ""
      document.getElementById('a_appointment_certificate_pos').innerText = ""
      document.getElementById('lbl_appointment_certificate_pos').innerText = "Choose file"

      document.getElementById('agreement_certificate_pos').value = ""
      document.getElementById('a_agreement_certificate_pos').innerText = ""
      document.getElementById('lbl_agreement_certificate_pos').innerText = "Choose file"

      document.getElementById('bank_details_pos').value = ""
      document.getElementById('a_bank_details_pos').innerText = ""
      document.getElementById('lbl_bank_details_pos').innerText = "Choose file"

   }

   function Load_Posp_Edit_Config(data) {
      policyid = null
      policyid = data.login_id

      document.getElementById('posp_code').value = data.posp_code
      document.getElementById('registration_code').value = data.registration_code
      document.getElementById('full_name').value = data.full_name

      document.getElementById('mob_no').value = data.mob_no
      document.getElementById('email_id').value = data.email_id
      document.getElementById('address').value = data.address

      document.getElementById('city').value = data.city
      document.getElementById('pincode').value = data.pincode

      document.getElementById('GSTIN').value = data.GSTIN
      document.getElementById('account_no').value = data.account_no
      document.getElementById('ifsc_code').value = data.ifsc_code
      document.getElementById('bank_name').value = data.bank_name
      document.getElementById('password').value = data.password
      document.getElementById('confirm_password').value = data.password

      // gender    
      element = document.getElementById('gender')
      for (let index = 0; index < element.options.length; index++) {
         ele = element[index]
         if (ele.value == data.gender) {
            element.options[index].selected = true;
            break
         }
      }

      // state    
      element = document.getElementById('state')
      for (let index = 0; index < element.options.length; index++) {
         ele = element[index]
         if (ele.value == data.state) {
            element.options[index].selected = true;
            break
         }
      }

      // rural_urban    
      element = document.getElementById('rural_urban')
      for (let index = 0; index < element.options.length; index++) {
         ele = element[index]
         if (ele.value == data.rural_urban) {
            element.options[index].selected = true;
            break
         }
      }

      // slab    
      element = document.getElementById('slab')
      for (let index = 0; index < element.options.length; index++) {
         ele = element[index]
         if (ele.value == data.slab) {
            element.options[index].selected = true;
            break
         }
      }

      //  attachments
      document.getElementById('a_basic_qualification').innerText = data.basic_qualification;
      document.getElementById('a_aadhar_card_pos').innerText = data.aadhar_card;     
      document.getElementById('a_pan_card_pos').innerText = data.pan_card;
      document.getElementById('a_training_certificate_pos').innerText = data.training_certificate;
      document.getElementById('a_appointment_certificate_pos').innerText = data.appointment_certificate;
      document.getElementById('a_agreement_certificate_pos').innerText = data.agreement_certificate;
      document.getElementById('a_bank_details_pos').innerText = data.bank_details;

   }

   async function sendPOspFormData() {

      formData = new FormData();
      formData.append('posp_code', document.getElementById('posp_code').value);
      formData.append('registration_code', document.getElementById('registration_code').value);
      formData.append('full_name', document.getElementById('full_name').value);
      formData.append('gender', document.getElementById('gender').value);
      formData.append('mob_no', document.getElementById('mob_no').value);
      formData.append('email_id', document.getElementById('email_id').value);
      formData.append('address', document.getElementById('address').value);
      formData.append('state', document.getElementById('state').value);
      formData.append('city', document.getElementById('city').value);

      formData.append('pincode', document.getElementById('pincode').value);
      formData.append('rural_urban', document.getElementById('rural_urban').value);
      formData.append('slab', document.getElementById('slab').value);
      formData.append('GSTIN', document.getElementById('GSTIN').value);
      formData.append('account_no', document.getElementById('account_no').value);
      formData.append('ifsc_code', document.getElementById('ifsc_code').value);
      formData.append('bank_name', document.getElementById('bank_name').value);

      formData.append('password', document.getElementById('password').value);

      for (const iterator of formData) {

         if (iterator[1] == "") {
            showNotification((`⚠️ ${iterator[0]} is missing`.toUpperCase()));
            return
         }
         else {
            showNotification('');
         }
      }

      if (document.getElementById('posp_title').innerText.startsWith("POSP Form")) {
         formData.append('login_id', '');
      }
      else {
         formData.append('login_id', policyid); // will be populated during editonclick()
      }

      formData.append('basic_qualification', '');
      formData.append('aadhar_card', '');
      formData.append('pan_card', '');
      formData.append('training_certificate', '');
      formData.append('appointment_certificate', '');
      formData.append('agreement_certificate', '');
      formData.append('bank_details', '');

      // attachments
      basic_qualification = document.getElementById('basic_qualification').files[0]
      if (basic_qualification != null) {
         file_name = `media/documents/` + getRandomFileName(basic_qualification)
         formData.set('basic_qualification', file_name.trim());
      }
      aadhar_card_pos = document.getElementById('aadhar_card_pos').files[0]
      if (aadhar_card_pos != null) {
         file_name = `media/documents/` + getRandomFileName(aadhar_card_pos)
         formData.set('aadhar_card', file_name.trim());
      }
      pan_card_pos = document.getElementById('pan_card_pos').files[0]
      if (pan_card_pos != null) {
         file_name = `media/documents/` + getRandomFileName(pan_card_pos)
         formData.set('pan_card', file_name.trim());
      }
      training_certificate_pos = document.getElementById('training_certificate_pos').files[0]
      if (training_certificate_pos != null) {
         file_name = `media/documents/` + getRandomFileName(training_certificate_pos)
         formData.set('training_certificate', file_name.trim());
      }
      appointment_certificate_pos = document.getElementById('appointment_certificate_pos').files[0]

      if (appointment_certificate_pos != null) {
         file_name = `media/documents/` + getRandomFileName(appointment_certificate_pos)
         formData.set('appointment_certificate', file_name.trim());
      }

      agreement_certificate_pos = document.getElementById('agreement_certificate_pos').files[0]
      if (agreement_certificate_pos != null) {
         file_name = `media/documents/` + getRandomFileName(agreement_certificate_pos)
         formData.set('agreement_certificate', file_name.trim());
      }

      bank_details_pos = document.getElementById('bank_details_pos').files[0]
      if (bank_details_pos != null) {
         file_name = `media/documents/` + getRandomFileName(bank_details_pos)
         formData.set('bank_details', file_name.trim());
      }

      for (const iterator of formData) {

         console.log(iterator);
      }


      // return

      result = await sendPospData(formData.get('posp_code'), formData);

      if (result != null) {

         
         if (document.getElementById('posp_title').innerText.startsWith("POSP Form")) {

            await uploadPdf(formData.get('basic_qualification'), 'basic_qualification')
            await uploadPdf(formData.get('aadhar_card'), 'aadhar_card_pos')
            await uploadPdf(formData.get('pan_card'), 'pan_card_pos')
            await uploadPdf(formData.get('training_certificate'), 'training_certificate_pos')
            await uploadPdf(formData.get('appointment_certificate'), 'appointment_certificate_pos')
            await uploadPdf(formData.get('agreement_certificate'), 'agreement_certificate_pos')
            await uploadPdf(formData.get('bank_details'), 'bank_details_pos')

            showNotification('✅ ' + 'succeed : '.toUpperCase() + formData.get('posp_code').toUpperCase());
         }

         await FetchDataAsync()

         ShowPage('posp')
      }
   }

   async function sendPospData(formDataKey, formData) {
      try {
         showNotification('⌛️ saving posp ...'.toUpperCase());

         const href = window.location.origin + '/bima_policy/policy/new_posp/';
         const csrfToken = '{{ csrf_token }}';

         const response = await fetch(href, {
            method: 'POST',
            headers: {
               'X-CSRFToken': csrfToken,
            },
            body: formData,
         });

         const result = await response.text();
         // console.log(result);

         if (result.includes('done:')) {
            showNotification('✅ ' + 'succeed : '.toUpperCase() + formDataKey.toUpperCase());
            return result
         } else {
            showNotification('❌ ' + 'failed : '.toUpperCase() + formDataKey.toUpperCase());
            return null
         }
      } catch (error) {
         showNotification('❌ ' + 'error : '.toUpperCase() + error.message.toUpperCase());
         alert(error.toString())
         return null
      }
   }

   function clearPospForm() {

      document.getElementById('posp_code').value = ''
      document.getElementById('registration_code').value = ''
      document.getElementById('full_name').value = ''

      document.getElementById('mob_no').value = ''
      document.getElementById('email_id').value = ''
      document.getElementById('address').value = ''

      document.getElementById('city').value = ''
      document.getElementById('pincode').value = ''

      document.getElementById('GSTIN').value = ''
      document.getElementById('account_no').value = ''
      document.getElementById('ifsc_code').value = ''
      document.getElementById('bank_name').value = ''
      document.getElementById('password').value = ''
      document.getElementById('confirm_password').value = ''

      document.getElementById('gender').selectedIndex = 0
      document.getElementById('state').selectedIndex = 0
      document.getElementById('rural_urban').selectedIndex = 0
      document.getElementById('slab').selectedIndex = 0

      document.getElementById('basic_qualification').value = ''
      document.getElementById('lbl_basic_qualification').innerHTML = 'Choose file'
      document.getElementById('a_basic_qualification').innerHTML = ''

      document.getElementById('aadhar_card_pos').value = ''
      document.getElementById('lbl_aadhar_card_pos').innerHTML = 'Choose file'
      document.getElementById('a_aadhar_card_pos').innerHTML = ''

      document.getElementById('pan_card_pos').value = ''
      document.getElementById('lbl_pan_card_pos').innerHTML = 'Choose file'
      document.getElementById('a_pan_card_pos').innerHTML = ''

      document.getElementById('training_certificate_pos').value = ''
      document.getElementById('lbl_training_certificate_pos').innerHTML = 'Choose file'
      document.getElementById('a_training_certificate_pos').innerHTML = ''

      document.getElementById('appointment_certificate_pos').value = ''
      document.getElementById('lbl_appointment_certificate_pos').innerHTML = 'Choose file'
      document.getElementById('a_appointment_certificate_pos').innerHTML = ''

      document.getElementById('agreement_certificate_pos').value = ''
      document.getElementById('lbl_agreement_certificate_pos').innerHTML = 'Choose file'
      document.getElementById('a_agreement_certificate_pos').innerHTML = ''

      document.getElementById('bank_details_pos').value = ''
      document.getElementById('lbl_bank_details_pos').innerHTML = 'Choose file'
      document.getElementById('a_bank_details_pos').innerHTML = ''

      document.getElementById("posp_code").focus()

   }


   async function Delete_Policy(policyid) {
      try {
         
         showNotification(`⌛️ deleting policy: ${policyid}`.toUpperCase());  

         // Create a Promise to wrap the $.ajax() call
         const response = await new Promise((resolve, reject) => {
            $.ajax({
               url: "{%url 'bima_policy:delete_policy'%}",
               data: { data: policyid },
               dataType: 'json',
               success: function (response) {
                  resolve(response);
               },
               error: function (xhr, status, error) {
                  reject(error);
               }
            });
         });

         msg = response.message;

         // console.log(msg);

         if (msg == "deleted") {
            showNotification('✅ ' + 'successfully deleted : '.toUpperCase() + policyid.toUpperCase());      
            await FetchDataAsync()      
            ShowPage('entry_list')
         }
         else{
            showNotification('❌ ' + 'failed : '.toUpperCase() + policyid.toUpperCase());
         }       


      } catch (error) {
         // Handle errors
         console.error(error);
         alert(error.toString());
      }
   }

   async function Delete_Posp(login_id) {
      try {
         
         showNotification(`⌛️ deleting posp: ${login_id}`.toUpperCase());  

         // Create a Promise to wrap the $.ajax() call
         const response = await new Promise((resolve, reject) => {
            $.ajax({
               url: "{%url 'bima_policy:delete_posp'%}",
               data: { data: login_id },
               dataType: 'json',
               success: function (response) {
                  resolve(response);
               },
               error: function (xhr, status, error) {
                  reject(error);
               }
            });
         });

         msg = response.message;

         console.log(msg);

         if (msg == "deleted") {
            showNotification('✅ ' + 'successfully deleted : '.toUpperCase() + login_id.toUpperCase());      
            await FetchDataAsync()      
            ShowPage('posp')
         }
         else{
            showNotification('❌ ' + 'failed : '.toUpperCase() + policyid.toUpperCase());
         }       


      } catch (error) {
         // Handle errors
         console.error(error);
         alert(error.toString());
      }
   }


</script>



{%endblock%}